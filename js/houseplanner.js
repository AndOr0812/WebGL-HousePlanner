var engine2D=window.engine2D||{};
engine2D.makeDoor=function(b,e,c,f,g,k,m){f="hinge.single";c=new paper.Group;m=new paper.Path;var p=new paper.Path,n=new paper.Group,q=new paper.Group,h=new paper.Path,v=new paper.Path;m.moveTo(new paper.Point(0,0));m.lineTo(new paper.Point(b,0));p.moveTo(new paper.Point(0,0));p.lineTo(new paper.Point(b,0));p.strokeColor="#ffff";p.strokeWidth=22;m.strokeColor="#000000";m.strokeWidth=10;h.moveTo(new paper.Point(10,-12));h.lineTo(new paper.Point(10,12));v.moveTo(new paper.Point(m.length-10,-12));v.lineTo(new paper.Point(m.length-
10,12));h.strokeColor=v.strokeColor="#00CC33";h.strokeWidth=v.strokeWidth=3;n.opacity=q.opacity=0;b=new paper.Path.RegularPolygon(new paper.Point(0,0),3,12);var y=new paper.Path.RegularPolygon(new paper.Point(m.length,0),3,12);b.rotate(30);y.rotate(-30);b.fillColor=y.fillColor="#00CC33";n.addChild(h);n.addChild(b);q.addChild(v);q.addChild(y);c.addChild(p);c.addChild(m);c.addChild(n);c.addChild(q);m.group=c;"fold.single"===f?engine2D.makeFoldSingleDoor(c,m,n,q,g,k):"fold.double"===f?engine2D.makeFoldDoubleDoor(c,
m,n,q,g,k):"hinge.single"===f?engine2D.makeHingeSingleDoor(c,m,n,q,g,k):"hinge.double"===f&&engine2D.makeHingeDoubleDoor(c,m,n,q,g,k);c.position=new paper.Point(e.x,e.y);paper.project.layers.push(c);return c};
engine2D.makeFoldSingleDoor=function(b,e,c,f,g,k){var m,p,n,q=new paper.Path,h=new paper.Path;q.strokeColor="#000000";q.strokeWidth=4;"right"===g?(p=new paper.Point(0,0),n=new paper.Point(e.length,0)):"left"===g&&(p=new paper.Point(e.length,0),n=new paper.Point(0,0));q.moveTo(n);"in"===k?(q.lineTo(new paper.Point(n.x,n.y+e.length/2)),g=-45):(q.lineTo(new paper.Point(n.x,n.y-e.length/2)),g=45);h=q.clone();h.rotate(g,h.segments[1].point);p=new paper.Path.Line(p,void 0);b.addChild(p);b.addChild(q);b.addChild(h);
c.attach("mousedrag",function(b){});f.attach("mousedrag",function(b){});e.attach("mouseenter",function(){c.opacity=1;f.opacity=1;c.drag=!1;f.drag=!1});e.attach("mousemove",function(){clearTimeout(m);m=setTimeout(function(){c.opacity=0;f.opacity=0},400)});b.attach("mousedrag",function(e){1!=c.drag&&1!=f.drag&&(b.position=e.point,c.opacity=0,f.opacity=0)})};engine2D.makeFoldDoubleDoor=function(b,e,c,f,g,k){};engine2D.makeHingeDoubleDoor=function(b,e,c,f,g,k){};
engine2D.makeHingeSingleDoor=function(b,e,c,f,g,k){function m(c,h,n){c.drag=!0;c.position.x=h.point.x;c.opacity=1;f.opacity=1;e.segments[n].point.x=h.point.x;guide.segments[n].point.x=h.point.x;t.segments[1].point.y="in"===k?t.segments[0].point.y+e.length:t.segments[0].point.y-e.length;u.clear();w.clear();A.clear();B.clear();D.clear();"right"===g&&(0==n?u=new Path.Arc(h.point,new Point(t.segments[0].point.x-e.length*C,t.segments[0].point.y-e.length*r),new Point(t.segments[1].point.x,t.segments[1].point.y)):
(t.segments[0].point.x=h.point.x,t.segments[1].point.x=h.point.x,v=t.segments[0].point.x-e.length*C,y=t.segments[0].point.y-e.length*r,u=new Path.Arc(new Point(e.segments[0].point.x,e.segments[0].point.y),new Point(v,y),new Point(t.segments[1].point.x,t.segments[1].point.y))),u.strokeColor="#000000",u.strokeWidth=1,w=new Path.Arc(new Point(e.segments[1].point.x,e.segments[1].point.y-e.length),new Point(e.segments[0].point.x,e.segments[0].point.y),new Point(e.segments[1].point.x,e.segments[1].point.y+
e.length)),A=new Path.Arc(new Point(e.segments[0].point.x,e.segments[0].point.y-e.length),new Point(e.segments[1].point.x,e.segments[1].point.y),new Point(e.segments[0].point.x,e.segments[0].point.y+e.length)),B=w.clone(),D=A.clone(),w.strokeColor=A.strokeColor="#000000",w.strokeWidth=A.strokeWidth=1,w.dashArray=A.dashArray=[10,10],w.opacity=A.opacity=0,B.strokeColor=D.strokeColor="#000000",B.strokeWidth=D.strokeWidth=20,B.opacity=D.opacity=0,b.appendBottom(u),b.appendBottom(B),b.appendBottom(w),
b.appendBottom(D),b.appendBottom(A))}var p,n,q,h,v,y;q=Math.PI/180*45;var C=Math.sin(q),r=Math.cos(q),t=new paper.Path;t.strokeColor="#000000";t.strokeWidth=4;var z=new paper.Path.Circle(new paper.Point(0,0),10);z.fillColor="#FFCC00";z.opacity=0;"right"===g?(n=new paper.Point(0,0),h=new paper.Point(e.length,0)):"left"===g&&(n=new paper.Point(e.length,0),h=new paper.Point(0,0));t.moveTo(h);"in"===k?(t.lineTo(new paper.Point(h.x,h.y+e.length)),q=new paper.Point(h.x,h.y+e.length),v=h.x+e.length*C,y=
h.y+e.length*r):(t.lineTo(new paper.Point(h.x,h.y-e.length)),q=new paper.Point(h.x,h.y-e.length),v=h.x-e.length*C,y=h.y-e.length*r);var u=new paper.Path.Arc(n,new paper.Point(v,y),q);u.strokeColor="#000000";u.strokeWidth=1;n=new paper.Point(e.length,0-e.length);q=new paper.Point(e.length,0+e.length);mp=new paper.Point(0,0);var w=new paper.Path.Arc(n,mp,q),B=new paper.Path.Arc(n,mp,q);n=new paper.Point(0,0-e.length);q=new paper.Point(0,0+e.length);mp=new paper.Point(0,e.length);var A=new paper.Path.Arc(n,
mp,q),D=new paper.Path.Arc(n,mp,q);w.strokeColor=A.strokeColor="#000000";w.strokeWidth=A.strokeWidth=1;w.dashArray=A.dashArray=[10,10];w.opacity=A.opacity=0;B.strokeColor=D.strokeColor="#000000";B.strokeWidth=D.strokeWidth=20;B.opacity=D.opacity=0;b.addChild(t);b.addChild(u);b.addChild(B);b.addChild(w);b.addChild(D);b.addChild(A);b.addChild(z);e.attach("mouseenter",function(){c.opacity=1;f.opacity=1;c.drag=!1;f.drag=!1;z.opacity=0;w.opacity=0;A.opacity=0});e.attach("mousemove",function(){clearTimeout(p);
p=setTimeout(function(){c.opacity=0;f.opacity=0},400)});c.attach("mousedrag",function(b){m(this,b,0)});f.attach("mousedrag",function(b){m(this,b,1)});B.on("mouseenter",function(){c.opacity=0;f.opacity=0;z.opacity=1;w.opacity=1;A.opacity=0;u.opacity=.1;t.opacity=.1});B.attach("mousemove",function(b){clearTimeout(p);z.position=b.point;p=setTimeout(function(){z.opacity=0;w.opacity=0;u.opacity=1;t.opacity=1},400)});D.attach("mouseenter",function(){c.opacity=0;f.opacity=0;z.opacity=1;w.opacity=0;A.opacity=
1;u.opacity=.1;t.opacity=.1});D.attach("mousemove",function(b){clearTimeout(p);z.position=b.point;p=setTimeout(function(){z.opacity=0;A.opacity=0;u.opacity=1;t.opacity=1},400)});b.attach("mousedrag",function(e){1!=c.drag&&1!=f.drag&&(b.position=e.point,c.opacity=0,f.opacity=0,z.opacity=0,w.opacity=0,A.opacity=0)})};engine2D=window.engine2D||{};
engine2D.show=function(){console.log("engine2d.show()");SCENE="2d";animateStop();engine3D.freeMemory();engine2D.freeMemory();engine3D.hide();$("#engine2D").show();toggleRight("menuRight",!0);toggleLeft("menuLeft2D",!0);$("#menuFloorSelector").show();[1,5,8,9,10].forEach(function(b){$("#menuBottomItem"+b).show()});$("#menuBottom").show();if(void 0!==scene2DWallGroup[FLOOR].children[0]){engine2D.calculateWallCorners();engine2D.attachObjectsToWalls(scene2DDoorGroup);engine2D.attachObjectsToWalls(scene2DWindowGroup);engine2D.makeFloor();
engine2D.drawWall();engine2D.clear(FLOOR,!0);var b=document.getElementById("zoom2DProgress");b&&(zoom2Dimg=new Image,zoom2DCTX=b.getContext("2d"),zoom2DSlider=document.getElementById("zoom2DSlider"),zoom2Dimg.onload=drawImage,zoom2Dimg.src="images/progress-tiles.jpg");$("#zoom2DLevel").show()}engineGUI.menuSelect(6,"menuTopItem","#ff3700");correctMenuHeight()};
engine2D.clear=function(b,e){for(var c=0;c<scene2DWallGroup[b].children.length;c++)scene2DWallGroup[b].children[c].visible=e;for(c=0;c<scene2DFloorShape[b].children.length;c++)scene2DFloorShape[b].children[c].visible=e};
engine2D.hide=function(){if(canvas2D){for(var b=0;b<scene2DWallGroup.length;b++)engine2D.clear(b,!1);canvas2D.off("mouseenter");canvas2D.off("mouseleave");canvas2D.off("mousedown");canvas2D.off("mouseup");canvas2D.off("mousedrag");canvas2D.off("mousemove");canvas2D.off("doubleclick")}try{$("#menu2DTools").tooltipster("hide")}catch(e){}$("#engine2D").hide();$("#menuLeft2D").hide();$("#menuRight2D").hide()};
engine2D.makeGrid=function(b,e){for(var c=0;c<=paper.view.size.width;c+=b){var f=new paper.Path.Line(new paper.Point(c,0),new paper.Point(c,paper.view.size.width)),g=new paper.Path.Line(new paper.Point(0,c),new paper.Point(paper.view.size.width,c));f.strokeColor=g.strokeColor=e;canvas2D.addChild(f);canvas2D.addChild(g)}};
engine2D.lockObject=function(b){var e=scene2D.getObjects().filter(function(c){return c.id===b});!0===e[0].lockMovementX?(e[0].item(2).set({visible:!1}),e[0].set({lockMovementX:!1,lockMovementY:!1})):(e[0].item(2).set({visible:!0}),e[0].set({lockMovementX:!0,lockMovementY:!0}));return!1};
engine2D.collectArrayFromContainer=function(b){var e=[],c,f;for(f in scene2DWallMesh[b])"wall"===f.name&&(c={wall:"standard",interior:"",exterior:""},c.id=f.id,c.locked=f.lockMovementX,c.position.x1=f.item(0).path[0][1],c.position.y1=f.item(0).path[0][2],c.position.x2=f.item(0).path[1][3],c.position.y2=f.item(0).path[1][4],c.curve.x=f.item(0).path[1][1],c.curve.y=f.item(0).path[1][2],e.push(c));for(f in scene2DDoorMesh[b])"door"===f.name&&(c={},c.door=f.name,c.id=f.id,c.locked=f.lockMovementX,c.open=
f.open,c.direction=f.direction,c.position.x1=f.get("x1"),c.position.y1=f.get("y1"),c.position.x2=f.get("x2"),c.position.y2=f.get("y2"),c.position.z=f.z,c.curve.x=0,c.curve.y=0,e.push(c));return e};engine2D=window.engine2D||{};
engine2D.makeFloor=function(){for(i=0;i<scene2DWallGroup.length;i++)if(void 0!==scene2DWallGroup[i].children[0]){console.log("2D Floor Generate ["+i+"] "+scene2DWallGroup[i].children.length);var b=new paper.Path;b.closed=!0;var e=scene2DWallGroup[i].children[0].children[0].children[0],c=e.segments[0].point;b.moveTo(c);for(a=0;a<scene2DWallGroup[i].children.length;a++)for(e=scene2DWallGroup[i].children[a].children[4].children[0],x=0;x<scene2DWallGroup[i].children.length;x++){var f=scene2DWallGroup[i].children[x].children[4].children[0];
if(e.id!=f.id&&e.hitTest(f.segments[0].point)){b.quadraticCurveTo(c,f.segments[1].point);c=f.segments[1].point;break}}e=document.createElement("canvas");e.width=b.bounds.width;e.height=b.bounds.height;var g=e.getContext("2d"),c=new Image;c.src="../objects/FloorPlan/Default/4.png";c.onload=function(){g.fillStyle=g.createPattern(this,"repeat");g.fillRect(0,0,b.bounds.width,b.bounds.height);g.fill()};e=new paper.Raster(e,new paper.Point(b.bounds.x,b.bounds.y));e.fitBounds(b.bounds,!0);scene2DFloorShape[i]=
new paper.Group([b,e]);scene2DFloorShape[i].clipped=!0;scene2DFloorShape[i].on("mousedown",engine2D.drawWall_onMouseDown);engine2D.calculateWallMeasureColor(i)}};engine2D.makeLabel=function(b,e,c,f){var g=new paper.PointText;g.content=b+"\n"+e;g.justification="center";g.fontSize=28;g.position=new paper.Point(c,f);paper.project.layers.push(g);return g};
engine2D.fillFloor=function(b){var e=1,c={x:0,y:0};for(i=0;i<scene2DWallMesh[FLOOR].length;i++){var f=scene2DWallMesh[FLOOR][i],g={x:f.item(0).path[0][1],y:f.item(0).path[0][2]},k={x:f.item(0).path[1][3],y:f.item(0).path[1][4]};1==e&&(b.path[0][1]=g.x,b.path[0][2]=g.y);b.path[e][1]=f.item(0).path[1][1];b.path[e][2]=f.item(0).path[1][2];k.x==c.x&&k.y==c.y&&(k=g);b.path[e][3]=k.x;b.path[e][4]=k.y;c=k;e++}};engine2D=window.engine2D||{};engine2D.History=[];engine2D.HistoryForward=function(){};engine2D.HistoryBack=function(){};engine2D.HistoryAdd=function(){};var engine2D=window.engine2D||{},panAndZoom;engine2D.initialize=function(){var b=document.getElementById("engine2D");paper.setup(b);paper.view.setViewSize(window.innerWidth,window.innerHeight);panAndZoom=new SimplePanAndZoom;$("#engine2D").bind("mousewheel",function(b){if(b.shiftKey)paper.view.center=panAndZoom.changeCenter(paper.view.center,b.deltaX,b.deltaY,b.deltaFactor);else{var c=panAndZoom.changeZoom(paper.view.zoom,-b.deltaY);5>=c&&1<=c&&(paper.view.zoom=c)}return b.preventDefault()})};
engine2D["new"]=function(){for(var b=0;3>b;b++)scene2DWallMesh[b]=[],scene2DFloorShape[b]=new paper.Group,scene2DWallDimentions[b]=[],scene2DDoorGroup[b]=new paper.Group,scene2DWindowGroup[b]=new paper.Group,scene2DWallGroup[b]=new paper.Group,scene2DWallPointGroup[b]=new paper.Group,scene2DLabelGroup[b]=new paper.Group,scene2DInteriorMesh[b]=[],scene2DExteriorMesh[b]=[];canvas2D=new paper.Group;b=new paper.Path.Circle(new paper.Point(0,0),450);b.fillColor="#CCCCCC";b.opacity=.2;b.position.x=paper.view.center.x+
40;b.position.y=paper.view.center.y+80;var e=new paper.Path.Rectangle(new paper.Point(0,0),paper.view.viewSize);e.fillColor="#ffffff";canvas2D.addChild(e);canvas2D.addChild(b);engine2D.makeGrid(40,"#6dcff6");engine2D.makeGrid(20,"#E0E0E0")};
engine2D.open=function(b){var e=0;b.file("scene2DFloorContainer.json").async("string").then(function(b){$.each(JSON.parse(b),function(b){$.each(this,function(b){void 0!==this.door?scene2DDoorGroup[e].addChild(engine2D.makeDoor(this.length,{x:this.x,y:this.y},this.z,this.type,this.open,this.direction,this.door)):void 0!==this.window?scene2DWindowGroup[e].addChild(engine2D.makeWindow(this.length,{x:this.x,y:this.y},this.z,this.open,this.direction,this.window)):void 0!==this.wall?scene2DWallGroup[e].addChild(engine2D.makeWall({x:this.x1,
y:this.y1},{x:this.x2,y:this.y2},{x:this.cx,y:this.cy},this.h)):void 0!==this.label&&scene2DLabelGroup[e].addChild(engine2D.makeLabel(this.label,this.size,this.x,this.y))});engine2D.makeFloor();e++})})};engine2D=window.engine2D||{};engine2D.makeStairs=function(b,e,c){b=new paper.Group;new paper.Path;return b};var engine2D=window.engine2D||{},drawWall={radius:4,tolerance:20,handle:null,path:null,curPoint:null,prevPoint:null,curHandleSeg:null},makeWall={dragging:!1};engine2D.drawWall=function(){var b=2*drawWall.radius;drawWall.tolerance<b&&(drawWall.tolerance=b);drawWall.handle=drawWall.radius*paper.Numerical.KAPPA;canvas2D.on("mousedown",engine2D.drawWall_onMouseDown)};
engine2D.drawWall_onMouseDown=function(b){this.on("mouseup",engine2D.drawWall_onMouseUp);this.on("mousedrag",engine2D.drawWall_onMouseDrag);drawWall.path=new paper.Path({segments:[b.point,b.point],strokeColor:"#ff5733",strokeWidth:10,strokeCap:"round"});drawWall.prevPoint=drawWall.path.firstSegment.point;drawWall.curPoint=drawWall.path.lastSegment.point;drawWall.curHandleSeg=null;drawWall.path.on("mouseup",engine2D.drawWall_onMouseUp);makeWall.dragging=!0;paper.project.layers.push(drawWall.path)};
engine2D.drawWall_onMouseUp=function(b){this.off("mouseup",engine2D.drawWall_onMouseUp);this.off("mousedrag",engine2D.drawWall_onMouseDrag);drawWall.path.off("mouseup",engine2D.drawWall_onMouseUp);var e;for(b=0;b<drawWall.path.segments.length;b+=2){var c=drawWall.path.segments[b].point,f=drawWall.path.segments[b+1].point;console.log("Wall draw Segment "+c+":"+f);for(var c=new paper.Path({segments:[c,f]}),g,f=0;f<scene2DWallGroup[FLOOR].children.length&&!(g=scene2DWallGroup[FLOOR].children[f],e=g.children[4].children[0].getIntersections(c),
0<e.length);f++);if(0<e.length)for(c=0;c<e.length;c++)console.log("Convert to wall Path + Attach "+e[c].intersection.point),engine2D.splitWall(g,e[c]);else console.log("Convert to wall Path")}drawWall.path.visible=!1;drawWall.path.remove();makeWall.dragging=!1};
engine2D.drawWall_onMouseDrag=function(b){b.preventDefault();b=b.point;var e=b.x-drawWall.prevPoint.x,c=b.y-drawWall.prevPoint.y,f=(new paper.Point(e,c)).abs();f.x<f.y?(drawWall.curPoint.x=drawWall.prevPoint.x,drawWall.curPoint.y=b.y):(drawWall.curPoint.x=b.x,drawWall.curPoint.y=drawWall.prevPoint.y);var e=drawWall.curPoint.x-drawWall.prevPoint.x,c=drawWall.curPoint.y-drawWall.prevPoint.y,g=new paper.Point(e,c);g.length=1;drawWall.curHandleSeg&&(e=drawWall.prevPoint.x+g.x*drawWall.radius,c=drawWall.prevPoint.y+
g.y*drawWall.radius,drawWall.curHandleSeg.point=new paper.Point(e,c),e=g.x*-drawWall.handle,c=g.y*-drawWall.handle,drawWall.curHandleSeg.handleIn=new paper.Point(e,c));Math.min(f.x,f.y)>drawWall.tolerance&&(e=drawWall.curPoint.x-g.x*drawWall.radius,c=drawWall.curPoint.y-g.y*drawWall.radius,b=new paper.Point(e,c),b=new paper.Segment(b,null,g*drawWall.handle),drawWall.path.insert(drawWall.path.segments.length-1,b),drawWall.curHandleSeg=drawWall.path.lastSegment,drawWall.prevPoint=drawWall.curHandleSeg.point.clone(),
drawWall.path.add(drawWall.curHandleSeg),drawWall.curPoint=drawWall.path.lastSegment.point)};
engine2D.makeWall=function(b,e,c,f){console.log("Normal "+b.x+":"+b.y+"-"+e.x+":"+e.y);var g=new paper.Group,k=new paper.Path;k.doors=[];k.windows=[];var m=new paper.Path.Circle(new paper.Point(c.x,c.y),10);m.fillColor="#33CCFF";m.opacity=.5;var p=new paper.Path.Circle(new paper.Point(0,0),8);p.fillColor="#FFCC00";p.visible=!1;k.moveTo(new paper.Point(b.x,b.y));k.quadraticCurveTo(new paper.Point(c.x,c.y),e.x,e.y);b=k.clone();b.strokeColor="#00FF00";b.strokeWidth=1;b.visible=!1;e=new paper.Path;c=
new paper.Path;var n=new paper.PointText,q=new paper.Path.Rectangle(new paper.Rectangle(0,0,50,18)),h=new paper.Group,v=new paper.Group;h.fontSize=v.fontSize=14;q.fillColor="#ffffff";var y=k.segments[0].point.subtract(k.segments[1].point).angle;e=engine2D.pathOffset(k,-20,1);c=engine2D.pathOffset(k,20,1);n.rotation=y;q.rotation=y;n.content=(e.children[0].length/100).toFixed(1)+"m";q.position=e.position;n.position=e.position;h.addChild(q.clone());h.addChild(n.clone());n.content=(c.children[0].length/
100).toFixed(1)+"m";q.position=c.position;n.position=c.position;v.addChild(q);v.addChild(n.clone());n.remove();k.strokeColor="black";k.strokeWidth=20;120>k.length&&(m.visible=!1,p.visible=!1);80>k.length&&(e.visible=!1,c.visible=!1,h.visible=!1,v.visible=!1);n=new paper.Group([k]);g.addChild(e);g.addChild(c);g.addChild(h);g.addChild(v);g.addChild(n);g.addChild(b);g.addChild(p);g.addChild(m);g.addChild(engine2D.calculatePathOffset(k,-10,1,1.5));g.addChild(engine2D.calculatePathOffset(k,10,1,1.5));
paper.project.layers.push(g);m.attach("mouseenter",function(){this.opacity=1});m.attach("mouseleave",function(){this.opacity=.5});m.attach("doubleclick",function(b){b=new paper.Path;b.moveTo(k.segments[0].point);b.lineTo(k.segments[1].point);onPathDrag(this.parent,b.getLocationAt(b.length/2))});m.attach("mousedrag",function(b){onPathDrag(this.parent,b)});n.on("mouseenter",engine2D.wall_onMouseEnter);n.on("mousemove",engine2D.wall_onMouseMove);n.on("mouseleave",engine2D.wall_onMouseLeave);onPathDrag=
function(b,c){b.children[7].position=c.point;var e=b.children[4].children[0],h=b.children[5],f=e.segments[0].point,n=e.segments[1].point;e.clear();e.moveTo(f);e.quadraticCurveTo(c.point,n);h.clear();h.moveTo(f);h.quadraticCurveTo(c.point,n)};onPathTouchDrag=function(b){b.preventDefault();b=b.originalEvent.changedTouches[0];onPathDrag({clientX:b.pageX,clientY:b.pageY});return!1};g.h=f;g.visible=!1;return g};
engine2D.wall_onMouseEnter=function(b){this.children[0].parent.parent.children[5].visible=!0;this.children[0].parent.parent.children[6].visible=!0};engine2D.wall_onMouseLeave=function(b){this.children[0].parent.parent.children[5].visible=!1;this.children[0].parent.parent.children[6].visible=!1};engine2D.wall_onMouseMove=function(b){this.children[0].parent.parent.children[6].position=this.children[0].getNearestPoint(b.point)};
engine2D.edge_onMouseEnter=function(b){this.children[2].opacity=1;this.children[3].opacity=1;this.on("mousedown",engine2D.edge_onMouseDown);this.on("mouseleave",engine2D.edge_onMouseLeave)};engine2D.edge_onMouseLeave=function(b){this.children[2].opacity=0;this.children[3].opacity=0};engine2D.wallRelativePoints=function(b,e,c){var f=b.point,g=c[1].point;e.hitTest(g)&&(f=c[0].point,g=b.point);return{start:f,end:g}};
engine2D.edge_onMouseDrag=function(b){b.preventDefault();0==this.dragging&&(this.dragging=!0,this.off("mouseenter",engine2D.edge_onMouseEnter),this.off("mouseleave",engine2D.edge_onMouseLeave));makeWall.dragging=!0;for(i=0;i<this.attachments.length;i++){var e=this.attachments[i];e.parent.parent.children[7].visible=120<e.length?!0:!1;var c=engine2D.wallRelativePoints(b,this.children[2],e.segments),f=e.segments[0].point.x+e.segments[1].point.x,g=e.segments[0].point.y+e.segments[1].point.y,k=e.segments[0].point.subtract(e.segments[1].point).angle,
m=c.start.subtract(c.end).angle,f=new paper.Point(f/2,g/2),g=e.doors.length;if(0<g)for(d=0;d<g;d++)e.doors[d].rotate(m-k),e.doors[d].position=f;else e.parent.parent.children[7].position=f;e.clear();e.moveTo(c.start);e.quadraticCurveTo(f,c.end);e.parent.parent.children[0].clear();e.parent.parent.children[1].clear();e.parent.parent.children[0]=engine2D.pathOffset(e,-20,1,e.parent.parent.children[0].strokeColor);e.parent.parent.children[1]=engine2D.pathOffset(e,20,1,e.parent.parent.children[1].strokeColor);
e.parent.parent.children[2].position=e.parent.parent.children[0].children[0].getLocationAt(e.parent.parent.children[0].children[0].length/2).point;e.parent.parent.children[3].position=e.parent.parent.children[1].children[0].getLocationAt(e.parent.parent.children[1].children[0].length/2).point;e.parent.parent.children[2].children[0].rotation=m-k;e.parent.parent.children[3].children[0].rotation=m-k;e.parent.parent.children[2].children[1].rotation=k;e.parent.parent.children[3].children[1].rotation=k;
e.parent.parent.children[2].children[1].content=(e.parent.parent.children[0].children[0].length/100).toFixed(2)+"m";e.parent.parent.children[3].children[1].content=(e.parent.parent.children[1].children[0].length/100).toFixed(2)+"m";e.parent.parent.children[8]=engine2D.calculatePathOffset(e,-10,1,1.5);e.parent.parent.children[9]=engine2D.calculatePathOffset(e,10,1,1.5)}this.position=b.point;engine2D.edgeSmashCorner(this)};
engine2D.edgeSmashCorner=function(b){if(2<=b.attachments.length)for(var e=0;e<b.attachments.length;e+=2)if(void 0!==b.attachments[e+1]){var c=engine2D.calculateWallAngle(b.attachments[e],b.attachments[e+1]),c=Math.abs(c)+180,c=Math.abs(c-360);b.children[4].children[3].content=Math.round(c)+"\u00b0";b.children[4].children[0].clear();b.children[4].children[1].clear();var c=b.attachments[e].parent.parent.children[9].getIntersections(b.attachments[e+1].parent.parent.children[9]),f=b.attachments[e].parent.parent.children[8].getIntersections(b.attachments[e+
1].parent.parent.children[8]),g=b.attachments[e].parent.parent.children[9].getIntersections(b.attachments[e+1].parent.parent.children[8]),k=b.attachments[e].parent.parent.children[8].getIntersections(b.attachments[e+1].parent.parent.children[9]);b.children[1].clear();c[0]&&(b.children[1].moveTo(c[0].point),g[0]&&k[0]&&(b.children[1].lineTo(g[0].point),b.children[1].lineTo(k[0].point)));f[0]&&(c[0]?b.children[1].lineTo(f[0].point):b.children[1].moveTo(f[0].point),g[0]&&k[0]&&(b.children[1].lineTo(g[0].point),
b.children[1].lineTo(k[0].point)))}};engine2D.edge_onMouseDown=function(b){this.on("mouseup",engine2D.edge_onMouseUp);this.on("mousedrag",engine2D.edge_onMouseDrag)};
engine2D.edge_onMouseUp=function(b){this.dragging=!1;this.off("mousedrag",engine2D.edge_onMouseDrag);for(i=0;i<this.attachments.length;i++){b=this.attachments[i];makeWall.dragging=!1;var e=b.parent.parent.children[5],c=this.attachments[i].getLocationAt(this.attachments[i].length/2).point;e.clear();e.moveTo(this.attachments[i].segments[0].point);e.quadraticCurveTo(c,this.attachments[i].segments[1].point);engine2D.calculateWallMeasureWidth(this,b.parent.parent.children[0]);engine2D.calculateWallMeasureWidth(this,
b.parent.parent.children[1])}this.children[2].opacity=0;this.children[3].opacity=0;this.off("mouseleave",engine2D.edge_onMouseLeave);this.off("mousedown",engine2D.edge_onMouseDown);this.on("mouseenter",engine2D.edge_onMouseEnter)};
paper.Shape.ArrowLine=function(b,e,c,f,g){function k(b,c,e,h){var f=[],n=Math.sqrt(Math.pow(e-b,2)+Math.pow(h-c,2));f[0]=e-10*((e-b)*Math.cos(.5)-(h-c)*Math.sin(.5))/n;f[1]=h-10*((h-c)*Math.cos(.5)+(e-b)*Math.sin(.5))/n;f[2]=e-10*((e-b)*Math.cos(.5)+(h-c)*Math.sin(.5))/n;f[3]=h-10*((h-c)*Math.cos(.5)-(e-b)*Math.sin(.5))/n;return f}var m=k(b,e,c,f),p=k(c,f,b,e),n=m[0],q=m[1],h=m[2],v=m[3],m=p[0],y=p[1],C=p[2],p=p[3],r=new paper.Path({segments:[new paper.Point(b,e),new paper.Point(c,f)],strokeWidth:1});
c=new paper.Path({segments:[new paper.Point(n,q),new paper.Point(c,f),new paper.Point(h,v)]});c=new paper.CompoundPath([r,c]);!0===g&&(b=new paper.Path({segments:[new paper.Point(m,y),new paper.Point(b,e),new paper.Point(C,p)]}),c.addChild(b));return c};engine2D.calculatePathOffset=function(b,e,c,f){for(var g=new paper.Path,k=0;k<c+1;k++){var m=k/c*b.length,p=b.getPointAt(m),m=b.getNormalAt(m);m.length=e;g.add(p.add(m))}g.scale(f);g.smooth;g.remove();return g};
engine2D.pathOffset=function(b,e,c,f){b=engine2D.calculatePathOffset(b,e,c,1);b=new paper.Shape.ArrowLine(b.segments[0].point.x,b.segments[0].point.y,b.segments[1].point.x,b.segments[1].point.y,!0);b.strokeColor=f;b.strokeWidth=1;return b};engine2D.calculateWallMeasureWidth=function(b,e){for(i=0;i<b.attachments.length;i++)for(l=0;2>l;l++)if(b.attachments[i].hitTest(e.children[0].segments[l].point)){e.scale(.8);break}};
engine2D.calculateWallMeasureColor=function(b,e){for(a=0;a<scene2DWallGroup[b].children.length;a++)for(l=0;2>l;l++){var c=scene2DWallGroup[b].children[a].children[l];scene2DFloorShape[b].hitTest(c.children[0].segments[0].point)?c.strokeColor="#606060":c.strokeColor="#000000"}};
engine2D.addWallCorner=function(b,e){var c=new paper.Path.Circle(e,60),f=new paper.Path.Circle(e,15),g=new paper.Path.Circle(e,17),k=new paper.Path.Circle(e,8),f=new paper.CompoundPath(f,g);f.fillColor=k.fillColor="#00CC33";f.opacity=k.opacity=0;g=new paper.Path;g.fillColor="#000000";c=new paper.Group([c,g,k,f]);c.dragging=!1;c.attachments=[];c.on("mouseenter",engine2D.edge_onMouseEnter);scene2DWallPointGroup[FLOOR].addChild(c)};
engine2D.calculateWallCorners=function(){console.log("Fix Wall Corner Geometry "+scene2DWallGroup[FLOOR].children.length);scene2DWallPointGroup[FLOOR]=new paper.Group;for(var b=0;b<scene2DWallGroup[FLOOR].children.length;b++)for(var e=scene2DWallGroup[FLOOR].children[b].children[4].children[0].segments,c=0;c<e.length;c++){var f=scene2DWallPointGroup[FLOOR].hitTest(e[c].point);if(f)for(var g=0;g<scene2DWallGroup[FLOOR].children.length;g++){var k=f.item.parent,m=scene2DWallGroup[FLOOR].children[g].children[4].children[0];
m.hitTest(k.position)&&k.attachments.push(m)}else engine2D.addWallCorner(e,e[c].point)}for(b=0;b<scene2DWallPointGroup[FLOOR].children.length;b++)k=scene2DWallPointGroup[FLOOR].children[b],engine2D.calculateWallEdge(k),engine2D.edgeSmashCorner(k);paper.project.layers.push(scene2DWallPointGroup[FLOOR])};
engine2D.calculateWallEdge=function(b){for(a=0;a<b.attachments.length&&void 0!==b.attachments[a+1];a+=2){var e=b.bounds.width/2,c=new paper.Path,f=new paper.Path,g=new paper.Path,k=new paper.Path.Arc,m=new paper.PointText;if(b.attachments[a].length>e&&b.attachments[a+1].length>e){k=new paper.Point(b.bounds.center.x,b.bounds.center.y);c=b.attachments[a].getLocationAt(e).point;f=b.attachments[a+1].getLocationAt(e).point;Math.round(k.subtract(c).length)>e&&(c=b.attachments[a].getLocationAt(b.attachments[a].length-
e).point);Math.round(k.subtract(f).length)>e&&(f=b.attachments[a+1].getLocationAt(b.attachments[a+1].length-e).point);c=new paper.Path.Line(k,c);f=new paper.Path.Line(k,f);c.strokeColor="#ffffff";c.strokeWidth=1;f.style=c.style;e=engine2D.calculateWallAngle(b.attachments[a],b.attachments[a+1]);g.add(c.segments[1].point);g.add(f.segments[1].point);var p=g.getLocationAt(g.length/2).point;m.position=p;g.clear();g.add(p);g.add(k);g.scale(2);p=g.segments[0].point;g.remove();k=new paper.Path.Arc(c.segments[1].point,
p,f.segments[1].point);k.strokeColor="#000000";k.strokeWidth=1;m.content=Math.abs(e)+"\u00b0";m.justification="center";m.fontSize=14}g=new paper.Group([c,f,k,m]);b.addChild(g)}};engine2D.calculateWallAngle=function(b,e){var c=b.segments[0].point.subtract(b.segments[1].point).angle,f=e.segments[0].point.subtract(e.segments[1].point).angle;return c-f};engine2D.joinWall=function(b){};engine2D.splitWall=function(b,e){console.log(b)};
engine2D.joinWallEdgeCircle=function(b){scene2D.getObjects().filter(function(e){return e.id===b});return!1};engine2D.splitWallEdgeCircle=function(b){for(var e=scene2D.getObjects().filter(function(c){return c.id===b}),c=scene2DMakeWallEdgeCircle(e[0].left,e[0].top,!1),f=1;4>f;f++)e[0].line[f]&&(c.line[f]=e[0].line[f],e[0].line[f]=void 0,e[0].bend[f]=void 0),e[0].pivot[f]&&(c.pivot[f]=e[0].pivot[f],e[0].pivot[f]=void 0);scene2D.add(c);return!1};
engine2D.snapObjectToWall=function(b,e){var c=b.segments[0].point.subtract(b.segments[1].point).angle;e.rotation=c};
engine2D.attachObjectsToWalls=function(b){for(i=0;i<scene2DWallGroup.length;i++)if(void 0!==scene2DWallGroup[i].children[0]){console.log("2D Atach Objects to Walls ["+i+"] "+b[i].children.length);for(var e=0;e<b[i].children.length;e++)for(var c=b[i].children[e],f=0;f<scene2DWallGroup[i].children.length;f++){var g=scene2DWallGroup[i].children[f],k=g.children[4].children[0].getIntersections(c.children[1]);if(k[0]){f=g.children[4].children[0].hitTest(k[0].point);b===scene2DDoorGroup?f.item.doors.push(b[i].children[e]):
b===scene2DWindowGroup&&f.item.windows.push(b[i].children[e]);engine2D.snapObjectToWall(f.item,c);g.children[7].visible=!1;break}}}};engine2D=window.engine2D||{};
engine2D.makeWindow=function(b,e,c,f,g,k){var m=new paper.Group;c=new paper.Path;f=new paper.Path;var p=new paper.Group,n=new paper.Group;c.moveTo(new paper.Point(0,0));c.lineTo(new paper.Point(b,0));c.strokeColor="#000000";c.strokeWidth=10;f.moveTo(new paper.Point(0,0));f.lineTo(new paper.Point(b,0));f.strokeColor="#ffff";f.strokeWidth=22;m.addChild(f);m.addChild(c);c.group=m;m.position=new paper.Point(e.x,e.y);m.attach("mousedrag",function(b){1!=p.drag&&1!=n.drag&&(m.position=b.point,p.opacity=
0,n.opacity=0)});paper.project.layers.push(m);return m};var SimplePanAndZoom,StableZoom;SimplePanAndZoom=function(){function b(){}b.prototype.changeZoom=function(b,c){return 0>c?1.05*b:0<c?b/1.05:b};b.prototype.changeCenter=function(b,c,f,g){c=new paper.Point(c,-f);c=c.multiply(g);return b.add(c)};return b}();function zoom2DdrawBase(b){zoom2DCTX.drawImage(zoom2Dimg,0,0,zoom2Dwidth,zoom2Dheight,0,0,zoom2Dwidth,zoom2Dheight)}
function zoom2DdrawProgress(b){b=zoom2DSlider.value;var e;e=65+1.55*b;zoom2DCTX.drawImage(zoom2Dimg,0,zoom2Dheight,e,zoom2Dheight,0,0,e,zoom2Dheight);b=Math.round(b/10);zoom2DCTX.fillStyle="grey";zoom2DCTX.font="12pt Arial";zoom2DCTX.fillText(b,20,35)}function drawImage(){zoom2DdrawBase(zoom2DCTX);zoom2DdrawProgress(zoom2DCTX)};var engine3D=window.engine3D||{};function scene3DSplitViewTop(){var b=window.innerWidth/1.4,e=.2*window.innerHeight;$("#left-component-1").css({width:b});$("#right-component-1").css({left:b});$("#vertical-divider-1").css({left:b});$("#bottom-component").css({height:e});$("#top-component").css({bottom:e});$("#horizontal-divider").css({bottom:e});engine3D.initRendererQuadSize()}
function scene3DSplitViewFront(){var b=.3*window.innerWidth,e=.2*window.innerHeight;$("#left-component-1").css({width:b});$("#right-component-1").css({left:b});$("#vertical-divider-1").css({left:b});$("#bottom-component").css({height:e});$("#top-component").css({bottom:e});$("#horizontal-divider").css({bottom:e});engine3D.initRendererQuadSize()}
function scene3DSplitViewSide(){var b=.15*window.innerWidth,e=window.innerHeight/1.4;$("#left-component-1").css({width:b});$("#right-component-1").css({left:b});$("#vertical-divider-1").css({left:b});$("#bottom-component").css({height:e});$("#top-component").css({bottom:e});$("#horizontal-divider").css({bottom:e});engine3D.initRendererQuadSize()}function scene3DSplitView3D(){}
function camera3DFloorFlyIn(b){(new TWEEN.Tween(camera3D.position)).to({x:0,y:10,z:0},2E3).easing(TWEEN.Easing.Quadratic.InOut).start();(new TWEEN.Tween(controls3D.target)).to({x:0,y:0,z:0},2E3).easing(TWEEN.Easing.Quadratic.InOut).onComplete(function(){FLOOR=b;engine3D.showFloor()}).start()}function camera3DNoteAdd(){}function scene3DFloorInsertAR(){"undefined"==typeof NyARRgbRaster_Canvas2D&&$.getScript("js/dynamic/JSARToolKit.js",function(b,e,c){})}
function scene3DFloorInsertPicture(){camera3DPositionCache=camera3D.position.clone();camera3DPivotCache=controls3D.target.clone();camera3DInsertPictureEnter()}function camera3DInsertPictureEnter(){(new TWEEN.Tween(camera3D.position)).to({x:0,y:10,z:0},2E3).easing(TWEEN.Easing.Quadratic.InOut).start()}
function camera3DInsertPictureExit(){(new TWEEN.Tween(camera3D.position)).to({x:camera3DPositionCache.x,y:camera3DPositionCache.y,z:camera3DPositionCache.z},2E3).easing(TWEEN.Easing.Quadratic.InOut).start()}
function camera3DPictureEnter(){var b=(new THREE.Vector3(0,-1.75,-.4)).applyMatrix4(camera3D.matrixWorld);(new TWEEN.Tween(SelectedPicture.position)).to(b,2E3).easing(TWEEN.Easing.Quadratic.InOut).onComplete(function(){engine3D.initPanorama("WebGLPanorama","3428",.7,.64)}).start();(new TWEEN.Tween(SelectedPicture.rotation)).to({x:camera3D.rotation.x,y:camera3D.rotation.y,z:camera3D.rotation.z},2E3).easing(TWEEN.Easing.Quadratic.InOut).start()}
function camera3DPictureExit(){disposePanorama("WebGLPanorama");(new TWEEN.Tween(SelectedPicture.position)).to({x:camera3DPositionCache.x,y:camera3DPositionCache.y,z:camera3DPositionCache.z},2E3).easing(TWEEN.Easing.Quadratic.InOut).start();(new TWEEN.Tween(SelectedPicture.rotation)).to({x:camera3DPivotCache.x,y:camera3DPivotCache.y,z:camera3DPivotCache.z},2E3).easing(TWEEN.Easing.Quadratic.InOut).start()}
function camera3DNoteEnter(){if(""!==SelectedNote.name){var b=(new THREE.Vector3(0,-.5,-.6)).applyMatrix4(camera3D.matrixWorld);(new TWEEN.Tween(SelectedNote.position)).to(b,2E3).easing(TWEEN.Easing.Quadratic.InOut).onComplete(function(){$("#WebGLNote").show()}).start();(new TWEEN.Tween(SelectedNote.rotation)).to({x:camera3D.rotation.x,y:camera3D.rotation.y,z:camera3D.rotation.z},2E3).easing(TWEEN.Easing.Quadratic.InOut).start()}}
function camera3DNoteExit(){$("#WebGLNote").hide();(new TWEEN.Tween(SelectedNote.position)).to({x:camera3DPositionCache.x,y:camera3DPositionCache.y,z:camera3DPositionCache.z},2E3).easing(TWEEN.Easing.Quadratic.InOut).start();(new TWEEN.Tween(SelectedNote.rotation)).to({x:camera3DPivotCache.x,y:camera3DPivotCache.y,z:camera3DPivotCache.z},2E3).easing(TWEEN.Easing.Quadratic.InOut).start()}
function camera3DAnimate(b,e,c,f){scene3DAnimateRotate||((new TWEEN.Tween(camera3D.position)).to({x:b,y:e,z:c},f).easing(TWEEN.Easing.Quadratic.InOut).start(),(new TWEEN.Tween(controls3D.target)).to({x:0,y:0,z:0},f).easing(TWEEN.Easing.Quadratic.InOut).start())}
function camera3DWalkViewToggle(){controls3D instanceof THREE.FirstPersonControls?(camera3DPositionCache=new THREE.Vector3(0,6,20),camera3DPivotCache=new THREE.Vector3(0,0,0),camera3DAnimateResetView(),engine3D.enableOrbitControls(camera3D,renderer.domElement)):controls3D instanceof THREE.OrbitControls?(alertify.confirm("",function(b){b&&(camera3DPositionCache=camera3D.position.clone(),camera3DPivotCache=controls3D.target.clone(),scene3DAnimateRotate=!1,(new TWEEN.Tween(camera3D.position)).to({x:0,
y:1.5,z:18},2E3).easing(TWEEN.Easing.Quadratic.InOut).start(),(new TWEEN.Tween(controls3D.target)).to({x:0,y:1.5,z:0},2E3).easing(TWEEN.Easing.Quadratic.InOut).onComplete(function(){engine3D.enableFirstPersonControls()}).start())}),$(".alertify-message").append($.parseHTML("<img src='images/help/wasd-keyboard.jpg' /><br/><br/>Use (W,A,S,D) or arrow keys to move."))):alertify.alert("Not Available in Edit Mode")}function camera3DAnimateResetView(){}
engine3D.enableTransformControls=function(b){controls3D=new THREE.TransformControls(camera3D,renderer.domElement);controls3D.attach(SelectedObject);controls3D.setMode(b);$("#WebGLInteractiveMenu").hide();$("#WebGLTextureSelect").hide()};engine3D.enableOrbitControls=function(b,e){controls3D instanceof THREE.OrbitControls||(controls3D=new THREE.OrbitControls(b,e),controls3D.minDistance=3,controls3D.maxDistance=25,controls3D.maxPolarAngle=Math.PI/2);controls3D.enabled=!0};
engine3D.enableFirstPersonControls=function(){controls3D.enabled=!1;controls3D=new THREE.FirstPersonControls(camera3D,renderer.domElement);controls3D.movementSpeed=5;controls3D.lookSpeed=.15;controls3D.noFly=!0;controls3D.lookVertical=!1;controls3D.activeLook=!0;controls3D.lon=-90;controls3D.lat=0;controls3D.enabled=!0};
engine3D.open3DModel=function(b,e,c,f,g,k,m,p,n,q){try{b.split(".").pop();var h=b.substring(0,b.lastIndexOf("/")+1)+"Textures/",v=function(h){h.name=b;h.boundingBox=[];h.boundingBox.max=[];h.boundingBox.max.x=0;h.boundingBox.max.y=0;h.boundingBox.max.z=0;h.traverse(function(b){if(b instanceof THREE.Mesh){if(b.geometry.computeFaceNormals(),b.geometry.computeVertexNormals(),b.geometry.computeBoundingBox(),h.boundingBox.max.x<b.geometry.boundingBox.max.x&&(h.boundingBox.max.x=b.geometry.boundingBox.max.x),
h.boundingBox.max.y<b.geometry.boundingBox.max.y&&(h.boundingBox.max.y=b.geometry.boundingBox.max.y),h.boundingBox.max.z<b.geometry.boundingBox.max.z&&(h.boundingBox.max.z=b.geometry.boundingBox.max.z),b.castShadow=!0,n&&(b.receiveShadow=!0),null!==b.material&&(b.material.side=THREE.DoubleSide,1<b.material.shininess-10?b.material.shininess-=10:0===b.material.shininess&&(b.material.shininess=.1),b.material.transparent=1>b.material.opacity?!0:!1,null!==b.material.map&&b.material.map.image.complete&&
(!THREE.Math.isPowerOfTwo(b.material.map.image.width)||!THREE.Math.isPowerOfTwo(b.material.map.image.height)))){var c=new THREE.Texture(engine3D.generateClampToEdgeTexture(b.material.map.image));c.needsUpdate=!0;c.minFilter=THREE.LinearFilter;b.material.map=c}}else b instanceof THREE.PointLight&&console.log("light found!")});h.position.x=c;h.position.y=f;h.position.z=g;h.rotation.x=k;h.rotation.y=m+Math.PI;console.log("ObjectLoader add model to scene "+h.name);e===scene3DHouseGroundContainer&&(_scene3DHouseGroundContainer=
h);e.add(h);var v,C;if(q){v=new THREE.MeshBasicMaterial({color:0});engine3D.fontLoader.load("fonts/helvetiker_regular.typeface.js",function(b){C=new THREE.TextGeometry(q,{font:b,weight:"normal",size:.05,height:.01})});var z=new THREE.Mesh(C,v);z.position.x=1.25;z.position.y=.5;z.position.z=.05;z.rotation.y=1.5;z.name=q;engine3D.open3DModel("objects/Platform/note.jsz",h,1.25,.1,-.3,0,1.5,1,!1,null);h.add(z);console.log(b+" Add Note: '"+q+"'")}if(e==scene3DFloorFurnitureContainer[FLOOR]){v=new THREE.LineBasicMaterial({color:0,
linewidth:2});C=new THREE.Geometry;var u=c-3*h.boundingBox.max.x,w=g-3*h.boundingBox.max.z,z=c+3*h.boundingBox.max.x,p=g+3*h.boundingBox.max.z;C.vertices.push(new THREE.Vector3(u,0,w));C.vertices.push(new THREE.Vector3(z,0,w));C.vertices.push(new THREE.Vector3(u,0,w));C.vertices.push(new THREE.Vector3(u,0,p));var y=new THREE.Line(C,v,THREE.LineSegments);y.position.y=.01;var D=[],F=[];D[0]=400*h.boundingBox.max.z;D[1]=400*h.boundingBox.max.x;engine3D.fontLoader.load("font/helvetiker_regular.typeface.js",
function(b){for(var e=0;1>=e;e++){var h;h=100<D[e]?(D[e]/100).toFixed(2)+" m":Math.round(D[e])+" cm";F[e]=new THREE.TextGeometry(h,{font:b,weight:"normal",size:.2,height:.01});F[e].computeBoundingBox()}b=new THREE.Mesh(F[0],v);b.position.x=c-F[0].boundingBox.max.x/2;b.position.y=.01;b.position.z=w-.1;b.rotation.x=-1.5;e=new THREE.Mesh(F[1],v);e.position.x=u-.1;e.position.y=.01;e.position.z=g+F[1].boundingBox.max.x/2;e.rotation.x=-1.55;e.rotation.z=1.6;y.add(b);y.add(e)});h.add(y);y.visible=!1}};if("jsz"==
b.split(".").pop()){var y=b.split("/").pop().slice(0,-4)+".json";$.ajax(b,{contentType:"application/zip",beforeSend:function(b){b.overrideMimeType("text/plain; charset=x-user-defined")},success:function(b){(new JSZip).loadAsync(b).then(function(c){c.file(y).async("string").then(function(c){b=c;b=JSON.parse(b);c=new THREE.ObjectLoader;c.setTexturePath(h);for(var e=0;e<b.object.children.length;e++){b.object.children[e].uuid=THREE.Math.generateUUID();for(var f=1,n=0;n<b.geometries.length;n++)if(b.geometries[n].uuid==
b.object.children[e].geometry){f=b.geometries[n].materials[0].opacity;break}0===f&&(f=.99);for(n=0;n<b.materials.length;n++){for(var g=0;g<b.textures.length;g++)if(b.textures[g].uuid==b.materials[n].map){b.textures[g].uuid=THREE.Math.generateUUID();b.materials[n].map=b.textures[g].uuid;break}if(b.materials[n].uuid==b.object.children[e].material){b.materials[n].opacity=f;f=THREE.Math.generateUUID();for(g=0;g<b.object.children.length;g++)b.object.children[g].material==b.materials[n].uuid&&(b.object.children[g].material=
f);b.materials[n].uuid=f;break}}}c.parse(b,v)})})},error:function(c,e,h){alertify.alert("3D Model ("+b+") Loading Error")}})}else"obj"==b.split(".").pop()&&(loader=new THREE.OBJLoader,loader.load(b,function(h){h.name=b;h.position.x=c;h.position.y=f;h.position.z=g;h.rotation.x=k;h.rotation.y=m;console.log("OBJMTL add model to scene"+b.slice(0,-4));console.log(h);e.add(h)},onProgress,onError))}catch(C){console.log("open3DModel Error "+C)}};
engine3D.generateClampToEdgeTexture=function(b){var e=document.createElement("canvas"),c=e.getContext("2d"),f=c.createPattern(b,"repeat"),g=b.width;b.height>b.width&&(g=b.height);e.width=g;e.height=g;c.fillStyle=f;c.fillRect(0,0,g,g);c.fill();return e};
engine3D.showHouse=function(){console.log("showHouse()");engine3D.freeMemory();engine3D.hide();engine2D.hide();SCENE="house";engineGUI.initMenu("menuRight3DHouse","Exterior/index.json");engine3D.enableOrbitControls(camera3D,renderer.domElement);SSAOProcessing.enabled=!1;$(renderer.domElement).bind("mousedown",on3DHouseMouseDown);$(renderer.domElement).bind("mouseup",on3DHouseMouseUp);$(renderer.domElement).bind("mouseup",on3DHouseMouseMove);$(renderer.domElement).bind("dblclick",onDocumentDoubleClick);
"moveXY"==TOOL3DINTERACTIVE?engineGUI.menuSelect(0,"menuInteractiveItem","#ff3700"):"moveZ"==TOOL3DINTERACTIVE?engineGUI.menuSelect(1,"menuInteractiveItem","#ff3700"):"rotate"==TOOL3DINTERACTIVE&&engineGUI.menuSelect(2,"menuInteractiveItem","#ff3700");[2,3,4,5,6,7,11,12,13].forEach(function(b){$("#menuBottomItem"+b).show()});$("#menuBottom").show();toggleRight("menuRight",!0);toggleLeft("menuLeft3DHouse",!0);engineGUI.menuSelect(1,"menuTopItem","#ff3700");correctMenuHeight();engine3D.setSky(DAY);
scene3D.add(skyMesh);settings.clouds&&scene3D.add(weatherSkyCloudsMesh);settings.rainbow&&scene3D.add(weatherSkyRainbowMesh);engine3D.setLights();engine3D.makeFloor();scene3D.add(scene3DHouseGroundContainer);scene3D.add(scene3DHouseContainer);scene3D.add(scene3DRoofContainer);if(void 0!=scene2DWallGroup[FLOOR].children[0]){for(var b=[-1,0,1,2,3,4],e=0;e<scene2DFloorShape.length;e++){var c=.1+b[e]*scene2DWallGroup[FLOOR].children[0].h;scene3DFloorShapeContainer[e].position.y=c;scene3DCeilingShapeContainer[e].position.y=
c+scene2DWallGroup[FLOOR].children[0].h;scene3D.add(scene3DFloorShapeContainer[e]);scene3D.add(scene3DCeilingShapeContainer[e])}for(var e=0;e<scene3DFloorFurnitureContainer.length;e++)scene3D.add(scene3DFloorFurnitureContainer[e])}scene3DCube&&scene3DCube.add(scene3DCubeMesh);$("#engine3D").show();$("#WebGLCanvas").show();setTimeout(function(){camera3DAnimate(0,6,18,1E3)},1E3);engine3D.animate()};
engine3D.showLandscape=function(){scene3DAnimateRotate=!1;engine3D.freeMemory();engine3D.hide();engine2D.hide();SCENE="landscape";engine3D.setSky("day");engine3D.setLights();engine3D.enableOrbitControls(camera3D,renderer.domElement);camera3D.position.set(10,10,15);camera3D.lookAt(scene3D.position);TOOL3DLANDSCAPE="rotate";scene3D.add(skyMesh);scene3D.add(terrain3D);$(renderer.domElement).bind("mousedown",on3DLandscapeMouseDown);$(renderer.domElement).bind("mouseup",on3DLandscapeMouseUp);$(renderer.domElement).bind("mousemove",
on3DLandscapeMouseMove);engineGUI.menuSelect(0,"menuLeft3DLandscapeItem","#ff3700");toggleLeft("menuLeft3DLandscape",!0);engineGUI.menuSelect(2,"menuTopItem","#ff3700");correctMenuHeight();$("#engine3D").show();$("#WebGLCanvas").show();engine3D.animate()};
engine3D.showFloor=function(){console.log("showFloor()");scene3DAnimateRotate=!1;engine3D.freeMemory();engine3D.hide();engine2D.hide();SCENE="floor";engineGUI.initMenu("menuRight3DFloor","Interior/index.json");engine3D.enableOrbitControls(camera3D,renderer.domElement);engine3D.buildPanorama(skyFloorMesh,"0000",75,75,75,"",null);scene3D.add(skyFloorMesh);engine3D.setLights();engine3D.makeFloor();engine3D.makeWalls();scene3D.add(scene3DFloorFurnitureContainer[FLOOR]);scene3D.add(scene3DFloorShapeContainer[FLOOR]);
scene3D.add(scene3DFloorGroundContainer);scene3DFloorShapeContainer[FLOOR].position.y=.1;if("measure"==TOOL3DFLOOR){scene3DFloorMeasurementsGenerate();for(var b=0;b<scene3DFloorFurnitureContainer[FLOOR].children.length;b++)scene3DFloorFurnitureContainer[FLOOR].children[b].children[1]&&(scene3DFloorFurnitureContainer[FLOOR].children[b].children[1].visible=!0)}scene3D.add(scene3DFloorWallContainer[FLOOR]);scene3D.add(scene3DFloorShapeContainer[FLOOR]);$(renderer.domElement).bind("mousedown",on3DFloorMouseDown);
$(renderer.domElement).bind("mouseup",on3DFloorMouseUp);$(renderer.domElement).bind("mousemove",on3DFloorMouseMove);$(renderer.domElement).bind("dblclick",onDocumentDoubleClick);$("#menuFloorSelectorText").html(scene3DFloorFurnitureContainer[FLOOR].name);$("#menuFloorSelector").show();[8,9,10,11,12,13].forEach(function(b){$("#menuBottomItem"+b).show()});$("#menuBottom").show();toggleRight("menuRight",!0);toggleLeft("menuLeft3DFloor",!0);engineGUI.menuSelect(5,"menuTopItem","#ff3700");engineGUI.menuSelect(0,
"menuLeft3DFloorItem","#ff3700");correctMenuHeight();scene3DCube&&scene3DCube.add(scene3DCubeMesh);$("#engine3D").show();$("#WebGLCanvas").show();setTimeout(function(){camera3DAnimate(0,10,12,1E3)},500);engine3D.animate()};
engine3D.showFloorLevel=function(){scene3DAnimateRotate=!1;engine3D.freeMemory();engine3D.hide();engine2D.hide();SCENE="floorlevel";engine3D.setSky("day");engine3D.setLights();engine3D.enableOrbitControls(camera3D,renderer.domElement);camera3D.position.set(10,10,15);camera3D.lookAt(scene3D.position);engine3D.generateLevelWalls();scene3D.add(skyMesh);scene3D.add(scene3DHouseGroundContainer);engineGUI.menuSelect(3,"menuTopItem","#ff3700");correctMenuHeight();$("#engine3D").show();$("#WebGLCanvas").show();
engine3D.animate()};
engine3D.showRoofDesign=function(){scene3DAnimateRotate=!1;engine3D.freeMemory();engine3D.hide();engine2D.hide();SCENE="roof";engineGUI.initMenu("menuRight3DRoof","Roof/index.json");engine3D.setLights();engine3D.initRendererQuad();scene3D.add(camera3DQuadGrid);scene3D.add(scene3DRoofContainer);$("#WebGLSplitCanvas-0").bind("mousemove",on3DRoofSplit0MouseMove);$("#WebGLSplitCanvas").bind("mouseup",on3DRoofVDividerMouseUp);toggleRight("menuRight",!0);engineGUI.menuSelect(4,"menuTopItem","#ff3700");
correctMenuHeight();$("#engine3D").show();$("#WebGLSplitCanvas").show();engine3D.animate()};
engine3D.hide=function(){$("#engine3D").hide();if(void 0!==renderer){scene3DCube&&scene3DCube.remove(scene3DCubeMesh);for(b=0;b<scene2DFloorShape.length;b++)scene3D.remove(scene3DFloorShapeContainer[b]),scene3D.remove(scene3DCeilingShapeContainer[b]);$(renderer.domElement).unbind("mousedown",on3DHouseMouseDown);$(renderer.domElement).unbind("mouseup",on3DHouseMouseUp);$(renderer.domElement).unbind("mousemove",on3DHouseMouseMove);$(renderer.domElement).unbind("dblclick",onDocumentDoubleClick);$("#WebGLSplitCanvas-0").unbind("mousemove",
on3DRoofSplit0MouseMove);$("#WebGLSplitCanvas").unbind("mouseup",on3DRoofVDividerMouseUp);$(renderer.domElement).unbind("mousedown",on3DFloorMouseDown);$(renderer.domElement).unbind("mouseup",on3DFloorMouseUp);$(renderer.domElement).unbind("mousemove",on3DFloorMouseMove);$(renderer.domElement).unbind("mousedown",on3DLandscapeMouseDown);$(renderer.domElement).unbind("mouseup",on3DLandscapeMouseUp);$(renderer.domElement).unbind("mousemove",on3DLandscapeMouseMove);disposePanorama("WebGLPanorama");$("#WebGLCanvas").hide();
$("#WebGLSplitCanvas").hide();$("#menuLeft3DHouse").hide();$("#menuLeft3DLandscape").hide();$("#menuLeft3DFloor").hide();$("#menuRight3DHouse").hide();$("#menuRight3DFloor").hide();$("#menuRight3DRoof").hide();$("#menuRightObjects").hide();$("#menuRight").hide();$("#menuFloorSelector").hide();$("#menuWallInput").hide();for(var b=1;13>=b;b++)$("#menuBottomItem"+b).hide();$("#menuBottom").hide()}};
function selectFloor(b){b=FLOOR+b;scene3DFloorFurnitureContainer[b]instanceof THREE.Object3D?(FLOOR=b,"floor"==SCENE?engine3D.showFloor():"2d"==SCENE&&engine2D.show()):alertify.confirm("Add New Floor?",function(b){b&&engine3D.newFloor()})}
engine3D.newFloor=function(b){var e=scene3DFloorFurnitureContainer.length;null===b&&(b="Floor "+e);scene3DFloorFurnitureContainer[e]=new THREE.Object3D;scene3DFloorFurnitureContainer[e].name=b;scene3DFloorMeasurementsContainer[e]=new THREE.Object3D;scene3DFloorWallContainer[e]=new THREE.Object3D;scene3DFloorShapeContainer[e]=new THREE.Object3D;scene3DFloorShapeTextures[e]=[];scene3DCeilingShapeContainer[e]=new THREE.Object3D;scene3DCeilingShapeTextures[e]=[];scene2DWallMesh[e]=[];scene2DWallDimentions[e]=
[]};function selectDayNight(){"day"==DAY?(DAY="night",$("#menuBottomItem6").attr("class","hi-icon icon-night tooltip")):"night"==DAY&&(DAY="day",$("#menuBottomItem6").attr("class","hi-icon icon-day tooltip"));scene3D.remove(skyMesh);engine3D.setSky(DAY);engine3D.setLights();engine.setWeather();scene3D.add(skyMesh)}engine3D.selectWeather=function(){"sunny"==WEATHER?WEATHER="snowy":"snowy"==WEATHER?WEATHER="rainy":"rainy"==WEATHER&&(WEATHER="sunny");engine.setWeather()};
function scene3DObjectSelectRemove(){"house"==SCENE?scene3DHouseContainer.remove(SelectedObject):"floor"==SCENE&&scene3DFloorFurnitureContainer[FLOOR].remove(SelectedObject);scene3DObjectUnselect()}
function scene3DObjectSelectMenuPosition(b,e){var c=new THREE.Vector3(b,e,.1),f,g;null!==SelectedObject?c=c.setFromMatrixPosition(SelectedObject.matrixWorld):null!==SelectedWall&&(c=c.setFromMatrixPosition(SelectedWall.matrixWorld));c.project(camera3D);f=(c.x+1)/2;g=(-c.y+1)/2;c.x=f*window.innerWidth;c.y=g*window.innerHeight;return c}
function scene3DObjectSelectMenu(b,e,c){b=scene3DObjectSelectMenuPosition(b,e);$(c).css("top",b.y-60).css("left",b.x);$(c).show();null===SelectedObject&&null!==SelectedWall&&($("#WebGLTextureSelect").css("top",b.y+$(c).height()).css("left",b.x-$("#WebGLTextureSelect").width()/2),$("#WebGLColorWheelSelect").css("top",b.y-$("#WebGLColorWheelSelect").height()-32).css("left",b.x-$("#WebGLColorWheelSelect").width()/2))}
function scene3DObjectSelect(b,e,c,f){if(controls3D instanceof THREE.OrbitControls)if(b=new THREE.Vector3(b,e,.5),b.unproject(c),c=(new THREE.Raycaster(c.position,b.sub(c.position).normalize())).intersectObjects(f.children,!0),0<c.length){if(SelectedObject!==c[0].object){scene3DObjectUnselect();controls3D.enabled=!1;SelectedObject=scene3DObjectSelectedRoot(f,c[0].object.uuid);if(0<=c[0].object.name.indexOf("Platform/note.jsz"))SelectedNote=c[0].object,camera3DPositionCache=SelectedNote.position.clone(),
camera3DPivotCache=SelectedNote.rotation.clone(),camera3DNoteEnter();else if(!(0<=SelectedObject.name.indexOf("Platform/camera.jsz")))if(SelectedObject.children===scene3DFloorWallContainer[FLOOR].children)SelectedWall=c[0].object,scene3DObjectSelectMenu(mouse.x,mouse.y,"#WebGLWallPaintMenu");else{if(-1!=SelectedObject.name.indexOf("house"))return!0;f=SelectedObject.children[SelectedObject.children.length-1];b=65280;rightButtonDown&&(b=16776960);b=new THREE.MeshBasicMaterial({color:b,side:THREE.BackSide,
opacity:.5,transparent:!0});"{highlighteMesh}"!==f.name?(f=SelectedObject.clone(),f.name="{highlighteMesh}",f.position.set(0,0,0),f.rotation.set(0,0,0),f.scale.multiplyScalar(1.06),SelectedObject.add(f)):f.visible=!0;for(e=0;e<f.children.length;e++)"Mesh"===f.children[e].type?(f.children[e].material=b,f.children[e].material.depthWrite=!0,f.children[e].material.depthTest=!0):f.remove(f.children[e]);$("#WebGLSelectMenu").tooltipster("update",'<a href="#item" onclick="" class="lo-icon icon-info" style="color:#606060"></a><a href="#" onclick="" class="lo-icon icon-settings" style="color:#606060"></a>');
f=scene3DObjectSelectMenuPosition(mouse.x,mouse.y);$("#WebGLSelectMenu").css({position:"absolute",left:f.x,top:f.y-50,"z-index":0});f=0;SelectedObject.boundingBox&&(f=SelectedObject.boundingBox.max.x);8<c[0].distance&&4>f?(camera3DPositionCache=camera3D.position.clone(),camera3DPivotCache=controls3D.target.clone(),(new TWEEN.Tween(camera3D.position)).to({x:SelectedObject.position.x,y:SelectedObject.position.y+4,z:SelectedObject.position.z+5},1E3).easing(TWEEN.Easing.Quadratic.InOut).onComplete(function(){$("#WebGLSelectMenu").tooltipster("show")}).start(),
(new TWEEN.Tween(controls3D.target)).to({x:SelectedObject.position.x,y:SelectedObject.position.y,z:SelectedObject.position.z},1E3).easing(TWEEN.Easing.Quadratic.InOut).start()):$("#WebGLSelectMenu").tooltipster("show");toggleSideMenus(!1)}return!0}}else scene3DObjectUnselect();return!1}function scene3DObjectSelectedRoot(b,e){for(var c=0;c<b.children.length;c++)for(var f=0;f<b.children[c].children.length;f++)if(b.children[c].children[f].uuid===e)return b.children[c];return b}
function scene3DObjectUnselect(){if(controls3D instanceof THREE.OrbitControls){if(null!==SelectedObject){var b=SelectedObject.children[SelectedObject.children.length-1];"{highlighteMesh}"===b.name&&(b.visible=!1);SelectedWall=SelectedObject=null;$("#WebGLSelectMenu").tooltipster("hide");$("#WebGLInteractiveMenu").hide();$("#WebGLWallPaintMenu").hide();$("#WebGLColorWheelSelect").hide();$("#WebGLTextureSelect").hide()}else null!==SelectedNote?(SelectedNote=null,camera3DNoteExit()):null!==SelectedPicture&&
(SelectedPicture=null,camera3DPictureExit());controls3D.enabled=!0;camera3DPivotCache=camera3DPositionCache=null}}
engine3D.collectArrayFromContainer=function(b){for(var e=[],c=0;c<b.children.length;c++){var f={};f.file=b.children[c].children[0].name;try{f.note=b.children[c].children[2].name}catch(g){}f.textures="Textures";f.position.x=b.children[c].children[0].position.x;f.position.y=b.children[c].children[0].position.y;f.position.z=b.children[c].children[0].position.z;f.rotation.x=b.children[c].children[0].rotation.x;f.rotation.y=b.children[c].children[0].rotation.y;f.rotation.z=b.children[c].children[0].rotation.z;
e.push(f)}return e};function imageBase64(b){b=document.getElementById(b);var e=document.createElement("canvas");e.width=b.width;e.height=b.height;e.getContext("2d").drawImage(b,0,0);return e.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,"")}function scene3DFloorMeasurementsGenerate(){material=new THREE.LineBasicMaterial({color:0,linewidth:2})}
function scene3DFloorMeasurementShow(){for(var b=!0,e=0;e<scene3DFloorFurnitureContainer[FLOOR].children.length;e++).8>scene3DFloorFurnitureContainer[FLOOR].children[e].position.y&&(scene3DFloorFurnitureContainer[FLOOR].children[e].children[1].visible=!scene3DFloorFurnitureContainer[FLOOR].children[e].children[1].visible),b=scene3DFloorFurnitureContainer[FLOOR].children[e].children[1].visible;b?(engineGUI.menuSelect(0,"menuLeft3DFloorItem","#ff3700"),TOOL3DFLOOR="measure"):(engineGUI.menuSelect(0,
"menuLeft3DFloorItem","black"),TOOL3DFLOOR="")}function scene3DFloorObjectWallMeasurementAjust(){}
engine3D.generateLevelWalls=function(){scene3DLevelWallContainer=new THREE.Object3D;var b=new THREE.BoxGeometry(15,4,13),e=new THREE.MeshBasicMaterial({color:14737632}),b=new THREE.Mesh(b,e);b.position.y=2;scene3DLevelWallContainer.add(b);b=new THREE.BoxGeometry(10,4,9);e=new THREE.MeshBasicMaterial({color:11579568});b=new THREE.Mesh(b,e);b.position.x=2.5;b.position.z=-2;b.position.y=6;scene3DLevelWallContainer.add(b);scene3D.add(scene3DLevelWallContainer)};
engine3D.setBackground=function(b){var e=document.createElement("canvas");e.width=window.innerWidth;e.height=window.innerHeight;var c=e.getContext("2d");"blue"==b?(b=c.createLinearGradient(0,0,0,e.height),b.addColorStop(0,"#1e4877"),b.addColorStop(.5,"#4584b4"),c.fillStyle=b,c.fillRect(0,0,e.width,e.height),document.getElementById("engine3D").style.background="url("+e.toDataURL("image/png")+")"):"split"==b?(c.lineWidth=1,c.beginPath(),c.moveTo(.5*window.innerWidth,0),c.lineTo(.5*window.innerWidth,
window.innerHeight),c.stroke(),c.beginPath(),c.moveTo(0,.5*window.innerHeight),c.lineTo(window.innerWidth,.5*window.innerHeight),c.stroke(),document.getElementById("engine3D").style.background="url("+e.toDataURL("image/png")+")"):document.body.style.background="#fff"};
engine3D.setLights=function(){scene3D.remove(sceneAmbientLight);scene3D.remove(sceneDirectionalLight);scene3D.remove(sceneSpotLight);"house"==SCENE?"day"==DAY?settings.sunlight?(sceneAmbientLight=new THREE.AmbientLight,scene3D.add(sceneAmbientLight),scene3D.add(sceneDirectionalLight),sceneSpotLight.intensity=1,sceneSpotLight.castShadow=!1,scene3D.add(sceneSpotLight)):(sceneAmbientLight=new THREE.AmbientLight(16777215,.7),scene3D.add(sceneAmbientLight),scene3D.add(sceneDirectionalLight)):(sceneSpotLight.intensity=
.8,sceneSpotLight.castShadow=!1,scene3D.add(sceneSpotLight)):"landscape"==SCENE?(sceneAmbientLight=new THREE.AmbientLight(16777215,.5),scene3D.add(sceneAmbientLight),scene3D.add(sceneDirectionalLight)):"roof"==SCENE?(sceneAmbientLight=new THREE.AmbientLight(16777215,.1),scene3D.add(sceneAmbientLight),sceneSpotLight.intensity=.6,sceneSpotLight.castShadow=!1,scene3D.add(sceneSpotLight)):"floorlevel"==SCENE?(sceneAmbientLight=new THREE.AmbientLight(16777215,.5),scene3D.add(sceneAmbientLight),scene3D.add(sceneDirectionalLight)):
"floor"==SCENE&&(sceneAmbientLight=new THREE.AmbientLight,scene3D.add(sceneAmbientLight),sceneDirectionalLight.intensity=.6,scene3D.add(sceneDirectionalLight))};
function insertSceneObject(b){"database"==RUNMODE&&(b="php/objects.php?id="+b,$.ajax({type:"GET",dataType:"json",url:b,async:!1,success:function(c){b=c.file},error:function(b,c,e){alertify.alert("Database Error - 3D Object Not Found")}}));var e=0,c=0,f=0;if("house"==SCENE){f=scene3DHouseContainer.children.length-1;c=e=0;try{e=scene3DHouseContainer.children[f].position.x+scene3DHouseContainer.children[f].geometry.boundingBox.max.x,c=scene3DHouseContainer.children[f].position.z+scene3DHouseContainer.children[f].geometry.boundingBox.max.z}catch(g){}engine3D.open3DModel(b,
scene3DHouseContainer,e,0,c,0,0,1,!0,null)}else"floor"==SCENE&&(f=scene3DFloorFurnitureContainer[FLOOR].children.length-1,e=scene3DFloorFurnitureContainer[FLOOR].children[f].position.x+scene3DFloorFurnitureContainer[FLOOR].children[f].geometry.boundingBox.max.x,c=scene3DFloorFurnitureContainer[FLOOR].children[f].position.z+scene3DFloorFurnitureContainer[FLOOR].children[f].geometry.boundingBox.max.z,engine3D.open3DModel(b,scene3DFloorFurnitureContainer[FLOOR],e,0,c,0,0,1,!0,null))}
function CalculateCutawayGeometry(){alertify.confirm("This feature is experimental and may not work properly. Continue?",function(b){b&&(b=new THREE.BoxGeometry(20,16,1),new THREE.Mesh(b))})}
function animatePanorama(){if(rendererPanorama instanceof THREE.WebGLRenderer){requestAnimationID=window.requestAnimationFrame(animatePanorama);clock.getDelta();mouse.x+=.1;mouse.y=Math.max(-85,Math.min(85,mouse.y));var b=THREE.Math.degToRad(90-mouse.y),e=THREE.Math.degToRad(mouse.x);target.x=Math.sin(b)*Math.cos(e);target.y=Math.cos(b);target.z=Math.sin(b)*Math.sin(e);camera3DPanorama.lookAt(target);rendererPanorama.render(scene3DPanorama,camera3DPanorama)}else engine3D.animate()}
function animateHouseRotate(){requestAnimationID=window.requestAnimationFrame(animateHouseRotate);if(scene3DAnimateRotate){var b=.19*clock.getDelta(),e=camera3D.position.x,c=camera3D.position.z,f=Math.cos(b),b=Math.sin(b);camera3D.position.x=e*f+c*b;camera3D.position.z=c*f-e*b;camera3D.lookAt(scene3D.position);animateClouds();renderer.render(scene3D,camera3D)}else engine3D.animate()}
function animateFloor(){requestAnimationID=window.requestAnimationFrame(animateFloor);sceneSpotLight.visible=!1;controls3D.update();leftButtonDown?renderer.render(scene3D,camera3D):(SSAOProcessing.enabled&&(scene3D.overrideMaterial=depthMaterial,renderer.render(scene3D,camera3D,depthRenderTarget,!0),scene3D.overrideMaterial=null),effectComposer.render());TWEEN.update()}
function animateLandscape(){requestAnimationID=window.requestAnimationFrame(animateLandscape);leftButtonDown&&"rotate"==TOOL3DLANDSCAPE&&controls3D.update();terrain3D.water.material.uniforms.time.value=(new Date).getTime()%1E4;renderer.render(scene3D,camera3D)}
function renderSunlight(){if(settings.sunlight){var b=new THREE.Vector3(0,10,-10),e=new THREE.MeshDepthMaterial,c=new THREE.Vector3;c.copy(b).project(camera3D);c.x+=1;c.y+=1;sunlight.godrayGenUniforms.vSunPositionScreenSpace.value.x=c.x;sunlight.godrayGenUniforms.vSunPositionScreenSpace.value.y=c.y;sunlight.godraysFakeSunUniforms.vSunPositionScreenSpace.value.x=c.x;sunlight.godraysFakeSunUniforms.vSunPositionScreenSpace.value.y=c.y;renderer.clearTarget(sunlight.rtTextureColors,!0,!0,!1);var b=.74*
window.innerHeight,f=.74*window.innerHeight;c.x*=window.innerWidth;c.y*=window.innerHeight;renderer.setScissor(c.x-f/2,c.y-b/2,f,b);renderer.enableScissorTest(!0);sunlight.godraysFakeSunUniforms.fAspect.value=window.innerWidth/window.innerHeight;sunlight.scene.overrideMaterial=sunlight.materialGodraysFakeSun;renderer.render(sunlight.scene,sunlight.camera,sunlight.rtTextureColors);renderer.enableScissorTest(!1);scene3D.overrideMaterial=null;renderer.render(scene3D,camera3D,sunlight.rtTextureColors);
scene3D.overrideMaterial=e;renderer.render(scene3D,camera3D,sunlight.rtTextureDepth,!0);e=1*Math.pow(6,-1);sunlight.godrayGenUniforms.fStepSize.value=e;sunlight.godrayGenUniforms.tInput.value=sunlight.rtTextureDepth;sunlight.scene.overrideMaterial=sunlight.materialGodraysGenerate;renderer.render(sunlight.scene,sunlight.camera,sunlight.rtTextureGodRays2);e=1*Math.pow(6,-2);sunlight.godrayGenUniforms.fStepSize.value=e;sunlight.godrayGenUniforms.tInput.value=sunlight.rtTextureGodRays2;renderer.render(sunlight.scene,
sunlight.camera,sunlight.rtTextureGodRays1);e=1*Math.pow(6,-3);sunlight.godrayGenUniforms.fStepSize.value=e;sunlight.godrayGenUniforms.tInput.value=sunlight.rtTextureGodRays1;renderer.render(sunlight.scene,sunlight.camera,sunlight.rtTextureGodRays2);sunlight.godrayCombineUniforms.tColors.value=sunlight.rtTextureColors;sunlight.godrayCombineUniforms.tGodRays.value=sunlight.rtTextureGodRays2;sunlight.scene.overrideMaterial=sunlight.materialGodraysCombine;renderer.render(sunlight.scene,sunlight.camera);
sunlight.scene.overrideMaterial=null}else renderer.render(scene3D,camera3D)}function animateClouds(){weatherSkyCloudsMesh.rotation.y=camera3D.rotation.y;weatherSkyCloudsMesh.rotation.z=camera3D.rotation.z;weatherSkyCloudsMesh.rotation.x=camera3D.rotation.x;weatherSkyCloudsMesh.position.x=camera3D.position.x/1.5}
function animateHouse(){requestAnimationID=window.requestAnimationFrame(animateHouse);scene3DAnimateRotate?engine3D.animate():(animateClouds(),controls3D.enabled&&(controls3D.update(),rendererCube&&rendererCube.render(scene3DCube,camera3DCube)),leftButtonDown?renderer.render(scene3D,camera3D):(SSAOProcessing.enabled&&(scene3D.overrideMaterial=depthMaterial,renderer.render(scene3D,camera3D,depthRenderTarget,!0),scene3D.overrideMaterial=null),effectComposer.render()),TWEEN.update())}
function animateRoof(){requestAnimationID=window.requestAnimationFrame(animateRoof);for(i=0;4>i;i++)rendererQuad[i].render(scene3D,camera3DQuad[i])}function animateRoof0(){requestAnimationID=window.requestAnimationFrame(animateRoof);rendererQuad[0].render(scene3D,camera3DQuad[0])}function animateStop(){requestAnimationID&&(window.cancelAnimationFrame(requestAnimationID),requestId=void 0)}
engine3D.animate=function(){animateStop();"house"==SCENE?scene3DAnimateRotate?animateHouseRotate():animateHouse():"floor"==SCENE?animateFloor():"landscape"==SCENE||"floorlevel"==SCENE?animateLandscape():"roof"==SCENE&&animateRoof()};
function fileSelect(b){window.File&&window.FileReader&&window.FileList&&window.Blob?($("#fileInput").click(),"2ddraftplan"==b?$("#fileInput").bind("change",handleFile2DImageSelect):"2dautocad"==b?$("#fileInput").bind("change",handleFile2DAutoCADConvert):"3dobject"==b&&$("#fileInput").bind("change",handleFile3DObjectSelect)):alert("The File APIs are not fully supported in this browser.")}
function errorHandler(b){switch(b.target.error.code){case b.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case b.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case b.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}}
function ajaxBeforeSubmit(){var b=$("#fileInput")[0].files[0].size,e=$("#fileInput")[0].files[0].type;switch(e){case "application/zip":case "application/octet-stream":break;default:return alert(e+" is unsupported file type!"),!1}if(10485760<b)return alert("<b>"+b+"</b> Too big file! <br />File is too big, it should be less than 5 MB."),!1}
function handleFile3DObjectSelect(b){switch(b.target.files[0].type){case "application/zip":case "application/octet-stream":var e={beforeSubmit:ajaxBeforeSubmit,resetForm:!0};$("#uploadForm").submit(function(){$(this).ajaxSubmit(e);return!1});break;case "application/x-javascript":fileReader=new FileReader;fileReader.onerror=errorHandler;fileReader.onloadstart=function(b){};fileReader.onload=function(c){console.log("Load File: "+$("#fileInput").value+":"+b.target.files[0].name);engine3D.open(c.target.result);
engine2D.open(c.target.result)};fileReader.readAsText(file);break;default:return alert("file type should be .js, .json or .zip"),!1}}function handleFile2DAutoCADConvert(b){fileReader=new FileReader;fileReader.onerror=errorHandler;fileReader.onload=function(b){b=new DXFParser(b.target.result);console.log(b)};fileReader.readAsText(b.target.files[0]);$("#fileInput").unbind("change",handleFile2DAutoCADConvert)}
function handleFile2DImageSelect(b){b.target.files[0].type.match("image.*")?(fileReader=new FileReader,fileReader.onerror=errorHandler,fileReader.onabort=function(b){alert("File read cancelled")},fileReader.onload=function(b){var c=new Image;c.src=b.target.result;scene2DFloorDraftPlanImage[FLOOR]=new fabric.Image(c,{top:1,left:1,width:window.innerWidth,height:window.innerHeight,opacity:.6,selectable:!1});scene2D.add(scene2DFloorDraftPlanImage[FLOOR]);scene2D.sendToBack(scene2DFloorDraftPlanImage[FLOOR]);
scene2D.renderAll()},fileReader.readAsDataURL(b.target.files[0]),$("#fileInput").unbind("change",handleFile2DImageSelect)):alert("Currently only photos are supported")}
function toggleTextureSelect(){if($("#WebGLTextureSelect").is(":visible"))$("#WebGLTextureSelect").hide(),$("#WebGLColorWheelSelect").hide();else{$("#WebGLTextureSelect").empty();if(null!==SelectedWall){var b=$("<div>",{"class":"scroll","data-ui":"jscroll-default",style:"width:100%;height:80px"}),e=$("<div>",{"class":"objectItem",style:"width:100px;height:64px"}),c=$("<a>",{href:"#"}).append($("<img>",{id:"test",src:"objects/Wall/Textures/W2367.jpg"}));e.append(c);c=$("<a>",{href:"#"}).append($("<img>",
{id:"test",src:"objects/Wall/Textures/W3465.jpg"}));e.append(c);$("#WebGLTextureSelect").append(b.append(e))}$("#WebGLTextureSelect").show();null!==SelectedWall&&$("#WebGLColorWheelSelect").show()}};engine3D=window.engine3D||{};
function onWindowResize(){camera3D.aspect=window.innerWidth/window.innerHeight;camera3D.updateProjectionMatrix();SSAOProcessing.enabled&&SSAOPass.uniforms.resolution.value.set(1/(window.innerWidth*dpr),1/(window.innerHeight*dpr));FXAAProcessing.enabled&&FXAAPass.uniforms.resolution.value.set(1/(window.innerWidth*dpr),1/(window.innerHeight*dpr));effectComposer.setSize(window.innerWidth*dpr,window.innerHeight*dpr);renderer.setSize(window.innerWidth,window.innerHeight);engine3D.initRendererQuadSize();correctMenuHeight()}
function onCubeMouseMove(b){b.preventDefault()}
function onDocumentDoubleClick(b){b.preventDefault();scene3D.visible&&controls3D instanceof THREE.OrbitControls&&null===SelectedObject&&(vector=new THREE.Vector3(b.clientX/window.innerWidth*2-1,2*-(b.clientY/window.innerHeight)+1,.1),vector.unproject(camera3D),b=(new THREE.Raycaster(camera3D.position,vector.sub(camera3D.position).normalize())).intersectObjects(scene3DHouseGroundContainer.children),0<b.length&&(console.log("doubleclick"),clearTimeout(doubleClickTime),scene3DPivotPoint.position.set(b[0].point.x,
0,b[0].point.z),(new TWEEN.Tween(controls3D.target)).to({x:b[0].point.x,y:0,z:b[0].point.z},800).easing(TWEEN.Easing.Quadratic.InOut).start(),doubleClickTime=setTimeout(function(){scene3D.remove(scene3DPivotPoint)},4E3)))}
function on3DLandscapeMouseMove(b){b.preventDefault();if("angle"==TOOL3DLANDSCAPE)leftButtonDown&&(terrain3D.rotation.y=b.clientX>window.innerWidth/2?terrain3D.rotation.y+.015:terrain3D.rotation.y-.015);else if(b=new THREE.Vector3(b.clientX/window.innerWidth*2-1,2*-(b.clientY/window.innerHeight)+1,.5),b.unproject(camera3D),b=(new THREE.Raycaster(camera3D.position,b.sub(camera3D.position).normalize())).intersectObjects(terrain3D.children),0<b.length&&(terrain3DMouse.vertex.x=Math.floor(b[0].point.x*
plot_vertices-map_left*plot_vertices),terrain3DMouse.vertex.y=Math.floor(b[0].point.z*plot_vertices-map_top*plot_vertices),terrain3D.material.uniforms.ring_center.value.x=b[0].point.x,terrain3D.material.uniforms.ring_center.value.y=-b[0].point.z),leftButtonDown)landscape.onmousemove()}
function on3DLandscapeMouseDown(b){b.preventDefault();1==b.which&&(leftButtonDown=!0);controls3D.enabled=!1;if("rotate"==TOOL3DLANDSCAPE)controls3D.enabled=!0;else if("hill"==TOOL3DLANDSCAPE||"valley"==TOOL3DLANDSCAPE)terrain3DMouse.x=b.clientX,terrain3DMouse.y=b.clientY}function on3DLandscapeMouseUp(b){leftButtonDown=!1;controls3D.enabled=!1;if("hill"==TOOL3DLANDSCAPE||"valley"==TOOL3DLANDSCAPE)terrain3DMouse.x=b.clientX,terrain3DMouse.y=b.clientY}
$(document).on("keyup",function(b){b.preventDefault();"house"===SCENE&&27===b.which&&(camera3DPositionCache=new THREE.Vector3(0,6,20),camera3DPivotCache=new THREE.Vector3(0,0,0),camera3DAnimateResetView())});function on3DHouseMouseDown(b){on3DMouseDown(b);scene3DObjectSelect(mouse.x,mouse.y,camera3D,scene3DHouseContainer)||scene3D.add(scene3DPivotPoint)}function on3DRoofVDividerMouseUp(b){scene3DInitializeRendererQuadSize()}function on3DRoofSplit0MouseMove(b){}
function on3DRoofSplit1MouseMove(b){}function on3DRoofSplit2MouseMove(b){}function on3DRoofSplit3MouseMove(b){}function on3DHouseMouseUp(b){on3DMouseUp(b)}function on3DFloorMouseDown(b){on3DMouseDown(b);scene3DObjectSelect(mouse.x,mouse.y,camera3D,scene3DFloorFurnitureContainer[FLOOR])||scene3D.add(scene3DPivotPoint)}
function on3DFloorMouseUp(b){on3DMouseUp(b);b=.1;null===SelectedObject&&(b=.5);for(var e=0;e<scene3DFloorWallContainer[FLOOR].children.length;e++)tween=(new TWEEN.Tween(scene3DFloorWallContainer[FLOOR].children[e].material)).to({opacity:b},500).start()}
function on3DCubeMove(){0!=engine3D.showCube&&(camera3DCube.position.copy(camera3D.position),camera3DCube.position.sub(controls3D.center),camera3DCube.position.setLength(18),camera3DCube.lookAt(scene3DCube.position),camera3DCube.updateMatrixWorld())}
function on3DObjectMove(b,e){var c=new THREE.Vector3(e.clientX/window.innerWidth*2-1,2*-(e.clientY/window.innerHeight)+1,-2);c.unproject(camera3D);c=(new THREE.Raycaster(camera3D.position,c.sub(camera3D.position).normalize())).intersectObjects(b.children,!0);0<c.length&&(leftButtonDown?($("#WebGLSelectMenu").tooltipster("hide"),SelectedObject.position.x=c[0].point.x,SelectedObject.position.z=c[0].point.z):rightButtonDown&&($("#WebGLSelectMenu").tooltipster("hide"),SelectedObject.rotation.y=c[0].point.x))}
function on3DHouseMouseMove(b){b.preventDefault();0===TWEEN.getAll().length&&(null!==SelectedObject?on3DObjectMove(scene3DHouseGroundContainer,b):on3DCubeMove())}
function on3DFloorMouseMove(b){b.preventDefault();if(0===TWEEN.getAll().length)if(null!==SelectedObject)on3DObjectMove(scene3DFloorGroundContainer,b);else{b=new THREE.Vector3(0,0,8);b.applyQuaternion(camera3D.quaternion);scene3DCutawayPlaneMesh.position.copy(b);scene3DCutawayPlaneMesh.lookAt(camera3D.position);b=[];for(var e=scene3DCutawayPlaneMesh.position.clone(),c=0;c<scene3DCutawayPlaneMesh.geometry.vertices.length;c++){var f=scene3DCutawayPlaneMesh.geometry.vertices[c].clone().applyMatrix4(scene3DCutawayPlaneMesh.matrix).sub(scene3DCutawayPlaneMesh.position),
g=(new THREE.Raycaster(e,f.clone().normalize())).intersectObjects(scene3DFloorWallContainer[FLOOR].children);0<g.length&&g[0].distance<f.length()&&((new TWEEN.Tween(g[0].object.material)).to({opacity:.1},800).start(),b.push(g[0].object.id))}on3DCubeMove()}}
function on3DMouseMove(b){b.preventDefault();!leftButtonDown||!rightButtonDown||controls3D instanceof THREE.TransformControls||controls3D instanceof THREE.FirstPersonControls||(clearTimeout(clickMenuTime),camera3DCube.position.copy(camera3D.position),camera3DCube.position.sub(controls3D.center),camera3DCube.position.setLength(18),camera3DCube.lookAt(scene3DCube.position))}
function on3DMouseDown(b){b.preventDefault();1===b.which&&(leftButtonDown=!0);3===b.which&&(rightButtonDown=!0);mouse.x=b.clientX/window.innerWidth*2-1;mouse.y=2*-(b.clientY/window.innerHeight)+1;scene3DAnimateRotate=!1;clickTime=setTimeout(function(){0<=document.getElementById("arrow-right").src.indexOf("images/arrowright.png")&&toggleSideMenus(!1)},1400)}
function on3DMouseUp(b){b.preventDefault();1==b.which&&(leftButtonDown=!1);3==b.which&&(rightButtonDown=!1);controls3D instanceof THREE.TransformControls||controls3D instanceof THREE.FirstPersonControls||(scene3D.remove(scene3DPivotPoint),clearTimeout(clickTime),null!=SelectedObject?(mouse.x=b.clientX/window.innerWidth*2-1,mouse.y=2*-(b.clientY/window.innerHeight)+1,b=scene3DObjectSelectMenuPosition(mouse.x,mouse.y),$("#WebGLSelectMenu").css({position:"absolute",left:b.x,top:b.y-50}),$("#WebGLSelectMenu").tooltipster("show")):
clickTime=setTimeout(function(){0<=document.getElementById("arrow-right").src.indexOf("images/arrowleft.png")&&toggleSideMenus(!0)},1400))};engine3D=window.engine3D||{};
engine3D.makeFloor=function(){for(i=0;i<scene2DFloorShape.length;i++)if(void 0!==scene2DFloorShape[i].children[0]){console.log("3D Floor Generate ["+i+"] "+scene2DWallGroup[i].children.length);scene3DFloorShapeContainer[i]=new THREE.Object3D;scene3DCeilingShapeContainer[i]=new THREE.Object3D;var b=new THREE.Shape;for(a=0;a<scene2DFloorShape[i].children[0].segments.length;a++){var e=scene2DFloorShape[i].children[0].segments[a].point,c=e.x/100*2-1,e=2*-(e.y/100)+1,c=c-13,e=e+7;0===a?b.moveTo(c,e):b.lineTo(c,
e)}var c=new THREE.ShapeGeometry(b),e=new THREE.MeshBasicMaterial,f=THREE.ImageUtils.loadTexture(scene3DFloorShapeTextures[i][0]);f.wrapS=THREE.RepeatWrapping;f.wrapT=THREE.RepeatWrapping;e.map=f;e=new THREE.Mesh(c,e);e.rotation.x=-(90*RADIAN);scene3DFloorShapeContainer[i].add(e);f=THREE.ImageUtils.loadTexture(scene3DCeilingShapeTextures[i][0]);f.wrapS=THREE.RepeatWrapping;f.wrapT=THREE.RepeatWrapping;c=new THREE.MeshBasicMaterial;c.map=f;c.side=THREE.BackSide;e=e.clone();e.material=c;scene3DCeilingShapeContainer[i].add(e);
if(0==i){c=new THREE.Mesh(new THREE.ExtrudeGeometry(b,{amount:-2,bevelEnabled:!1}));c.rotation.x=-(90*RADIAN);var g=new ThreeBSP(c);scene3DFloorShapeContainer[i].add(c);_scene3DHouseGroundContainer.traverse(function(b){if(b instanceof THREE.Mesh){var c=new ThreeBSP(b),c=g.subtract(c).toMesh();c.geometry.computeVertexNormals();b.geometry=c.geometry}});scene3DHouseGroundContainer.visible=!1;_scene3DHouseGroundContainer.position.z=-10;scene3D.add(_scene3DHouseGroundContainer)}}};engine3D=window.engine3D||{};engine3D.History=[];engine3D.historyForward=function(){};engine3D.historyBack=function(){};engine3D.historyAdd=function(){};engine3D.initHousePlanner=function(){if(Detector.webgl){getCookie("firstTimer")?(createCookie("firstTimer","1",15),window.location.href="#start"):window.location.href="#scene";"local"==RUNMODE&&($("#menuTopItem12").hide(),$("#menuTopItem15").hide());$("#menuTop").show();$("#menuBottom").show();0===window.innerWidth&&(window.innerWidth=parent.innerWidth,window.innerHeight=parent.innerHeight);spinner.className="cssload-container";spinner.setAttribute("style","position:absolute;top:32%;left:40%;");spinner.innerHTML=
"<ul class='cssload-flex-container'><li><span class='cssload-loading'></span></li></ul>";projector=new THREE.Projector;clock=new THREE.Clock;mouse=new THREE.Vector2;touch=new THREE.Vector2;target=new THREE.Vector3;textureLoader=new THREE.TextureLoader;scene3DFloorGroundContainer=new THREE.Object3D;scene3DPivotPoint=new THREE.Object3D;var b=new THREE.BoxGeometry(15,15,3);b.computeBoundingBox();material=new THREE.MeshBasicMaterial({color:16776960,side:THREE.DoubleSide});scene3DCutawayPlaneMesh=new THREE.Mesh(b,
material);!0===engine3D.showCube&&(b=[new THREE.MeshBasicMaterial({color:3385941,transparent:!0,opacity:.9,shading:THREE.FlatShading,vertexColors:THREE.VertexColors}),new THREE.MeshBasicMaterial({color:5622784,transparent:!0,opacity:.9,shading:THREE.FlatShading,vertexColors:THREE.VertexColors}),new THREE.MeshBasicMaterial({color:0,transparent:!0,opacity:.9,shading:THREE.FlatShading,vertexColors:THREE.VertexColors}),new THREE.MeshBasicMaterial({color:0,transparent:!0,opacity:.9,shading:THREE.FlatShading,
vertexColors:THREE.VertexColors}),new THREE.MeshBasicMaterial({color:255,transparent:!0,opacity:.9,shading:THREE.FlatShading,vertexColors:THREE.VertexColors}),new THREE.MeshBasicMaterial({color:5592490,transparent:!0,opacity:.9,shading:THREE.FlatShading,vertexColors:THREE.VertexColors})],material=new THREE.MultiMaterial(b),material.vertexColors=THREE.FaceColors,b=engine3D.initCube(8),b.computeLineDistances(),scene3DCubeMesh=new THREE.Line(b,new THREE.LineDashedMaterial({color:16725760,dashSize:3,
gapSize:1,linewidth:2}),THREE.LineSegments),scene3DCubeMesh.geometry.dynamic=!0);engine3D.initRenderer();engine3D.initTerrainGround();engine3D.initTerrainWater();engine3D.initTerrainClouds();engine2D.initialize();engine3D["new"]();engine2D["new"]();engine3D.enableOrbitControls(camera3D,renderer.domElement);engine3D.initLights();$("#menuWeatherText").html("Sunny");$("#menuDayNightText").html("Day");engine3D.open3DModel("objects/Platform/floor.jsz",scene3DFloorGroundContainer,0,0,0,0,0,1,!1,null);engine3D.open3DModel("objects/Landscape/round.jsz",
scene3DHouseGroundContainer,0,0,0,0,0,1,!0,null);engine3D.open3DModel("objects/Platform/pivotpoint.jsz",scene3DPivotPoint,0,0,.1,0,0,1,!1,null);$(window).bind("resize",onWindowResize);$(window).bind("beforeunload",function(){return"Are you sure you want to leave?"});engine3D.showHouse()}else/MSIE (\d+\.\d+);/.test(navigator.userAgent)?$("body").append("<br/><br/><br/><div><center><img src='images/webgl.gif' /><h1>Looks like you broke the Internet!</h1><br/><h2>...your WebGL not enabled?</h2><br/><br/>You are running Internet Explorer, the browser does not support WebGL, please install one of these popular browsers<br/><br/><a href='http://www.mozilla.org/en-US/firefox'><img src='images/firefox.png'/></a> <a href='http://www.google.ca/chrome'><img src='images/chrome.png'/></a></center></div>"):
/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&$("body").append("<br/><br/><br/><div><center><img src='images/webgl.gif' /><h1>Looks like you broke the Internet!</h1><br/><h2>...your WebGL not enabled?</h2><img src='images/firefox-webgl.png'/></center></div>"),$("#menuTop").hide(),$("#menuBottom").hide(),document.getElementsByTagName("body")[0].style.overflow="auto",document.getElementsByTagName("html")[0].style.overflow="auto"};
engine3D.initRenderer=function(){camera3D=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.1,80);dpr=1;void 0!==window.devicePixelRatio&&(dpr=window.devicePixelRatio);renderer=new THREE.WebGLRenderer({devicePixelRatio:dpr,antialias:!1});renderer.shadowMap.enabled=!0;renderer.shadowMapSoft=!0;renderer.shadowMapAutoUpdate=!0;renderer.setSize(window.innerWidth,window.innerHeight);document.getElementById("WebGLCanvas").appendChild(renderer.domElement);!0===engine3D.showCube&&(scene3DCube=
new THREE.Scene,camera3DCube=new THREE.PerspectiveCamera(60,1,1,50),camera3DCube.up=camera3D.up,scene3DCube.add(scene3DCubeMesh),rendererCube=new THREE.WebGLRenderer({devicePixelRatio:dpr,antialias:!1,alpha:!0}),rendererCube.setSize(100,100),document.getElementById("WebGLCubeCanvas").appendChild(rendererCube.domElement))};
engine3D.initRendererQuad=function(){$("div.split-pane").splitPane();for(i=0;4>i;i++)rendererQuad[i]=new THREE.WebGLRenderer({devicePixelRatio:dpr,antialias:!1}),rendererQuad[i].setClearColor(16777215),$("#WebGLSplitCanvas-"+i).append(rendererQuad[i].domElement);camera3DQuad[0]=new THREE.OrthographicCamera($("#WebGLSplitCanvas-0").parent().parent().width()/-60,$("#WebGLSplitCanvas-0").parent().parent().width()/60,$("#WebGLSplitCanvas-0").parent().parent().height()/10,$("#WebGLSplitCanvas-0").parent().parent().height()/
-10,-30,30);camera3DQuad[0].up=new THREE.Vector3(0,0,-1);camera3DQuad[0].lookAt(new THREE.Vector3(0,-1,0));camera3DQuad[1]=new THREE.OrthographicCamera($("#WebGLSplitCanvas-1").parent().parent().width()/-60,$("#WebGLSplitCanvas-1").parent().parent().width()/60,$("#WebGLSplitCanvas-1").parent().parent().height()/10,$("#WebGLSplitCanvas-1").parent().parent().height()/-10,-30,30);camera3DQuad[1].lookAt(new THREE.Vector3(1,0,0));camera3DQuad[1].position.set(0,0,0);camera3DQuad[2]=new THREE.OrthographicCamera($("#WebGLSplitCanvas-2").parent().parent().width()/
-60,$("#WebGLSplitCanvas-2").parent().parent().width()/60,$("#WebGLSplitCanvas-2").parent().parent().height()/10,$("#WebGLSplitCanvas-2").parent().parent().height()/-40,-30,30);camera3DQuad[2].lookAt(new THREE.Vector3(1,0,0));camera3DQuad[2].position.set(0,0,0);camera3DQuad[3]=new THREE.PerspectiveCamera(70,$("#WebGLSplitCanvas-3").parent().width()/$("#WebGLSplitCanvas-3").parent().height(),1,50);camera3DQuad[3].position.set(0,14,8);camera3DQuad[3].lookAt(new THREE.Vector3(0,0,0));camera3DQuadGrid=
new THREE.GridHelper(15,1,new THREE.Color(102),new THREE.Color(7196662));engine3D.initRendererQuadSize()};engine3D.initRendererQuadSize=function(){if(camera3DQuad[0]instanceof THREE.OrthographicCamera)for(i=0;4>i;i++){var b=$("#WebGLSplitCanvas-"+i).parent().parent().width(),e=$("#WebGLSplitCanvas-"+i).parent().parent().height();camera3DQuad[i].aspect=b/e;camera3DQuad[i].updateProjectionMatrix();rendererQuad[i].setSize(b,e)}};
engine3D.initPostprocessing=function(){console.log("init EffectComposer");effectComposer=new THREE.EffectComposer(renderer);effectComposer.setSize(window.innerWidth*dpr,window.innerHeight*dpr);var b=new THREE.RenderPass(scene3D,camera3D);effectComposer.addPass(b);if(SSAOProcessing.enabled){console.log("init SSAOShader");var b=THREE.ShaderLib.depthRGBA,e=THREE.UniformsUtils.clone(b.uniforms);depthMaterial=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:e,
blending:THREE.NoBlending});depthRenderTarget=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter});SSAOPass=new THREE.ShaderPass(THREE.SSAOShader);SSAOPass.renderToScreen=!0;SSAOPass.uniforms.tDepth.value=depthRenderTarget;SSAOPass.uniforms.size.value.set(1/(window.innerWidth*dpr),1/(window.innerHeight*dpr));SSAOPass.uniforms.cameraNear.value=camera3D.near;SSAOPass.uniforms.cameraFar.value=camera3D.far;SSAOPass.uniforms.onlyAO.value=
1==SSAOProcessing.renderMode;SSAOPass.uniforms.aoClamp.value=.3;SSAOPass.uniforms.lumInfluence.value=.5;effectComposer.addPass(SSAOPass)}FXAAProcessing.enabled&&(console.log("init FXAAShader"),FXAAPass=new THREE.ShaderPass(THREE.FXAAShader),FXAAPass.uniforms.resolution.value.set(1/(window.innerWidth*dpr),1/(window.innerHeight*dpr)),FXAAPass.renderToScreen=!0,effectComposer.addPass(FXAAPass))};
engine3D.initLights=function(){sceneDirectionalLight=new THREE.DirectionalLight;sceneDirectionalLight.color.setHSL(.1,1,.95);sceneDirectionalLight.position.set(1,1.8,.8).normalize();sceneDirectionalLight.target.position.set(0,0,0);sceneDirectionalLight.position.multiplyScalar(50);sceneDirectionalLight.castShadow=!0;sceneDirectionalLight.shadow.mapSize.width=2048;sceneDirectionalLight.shadow.mapSize.height=2048;sceneDirectionalLight.shadow.camera.left=-15;sceneDirectionalLight.shadow.camera.left=15;
sceneDirectionalLight.shadow.camera.top=15;sceneDirectionalLight.shadow.camera.bottom=-15;sceneDirectionalLight.shadow.camera.far=2E3;sceneDirectionalLight.shadow.bias=-1E-4;sceneSpotLight=new THREE.SpotLight;sceneSpotLight.shadow.camera.near=1;sceneSpotLight.shadow.camera.far=38;sceneSpotLight.castShadow=!0;sceneSpotLight.intensity=.8;sceneSpotLight.position.set(-4,35,4)};engine3D.initPhysics=function(){};
engine3D.initCube=function(b){b*=.5;geometry=new THREE.Geometry;geometry.vertices.push(new THREE.Vector3(-b,-b,-b),new THREE.Vector3(-b,b,-b),new THREE.Vector3(-b,b,-b),new THREE.Vector3(b,b,-b),new THREE.Vector3(b,b,-b),new THREE.Vector3(b,-b,-b),new THREE.Vector3(b,-b,-b),new THREE.Vector3(-b,-b,-b),new THREE.Vector3(-b,-b,b),new THREE.Vector3(-b,b,b),new THREE.Vector3(-b,b,b),new THREE.Vector3(b,b,b),new THREE.Vector3(b,b,b),new THREE.Vector3(b,-b,b),new THREE.Vector3(b,-b,b),new THREE.Vector3(-b,
-b,b),new THREE.Vector3(-b,-b,-b),new THREE.Vector3(-b,-b,b),new THREE.Vector3(-b,b,-b),new THREE.Vector3(-b,b,b),new THREE.Vector3(b,b,-b),new THREE.Vector3(b,b,b),new THREE.Vector3(b,-b,-b),new THREE.Vector3(b,-b,b));return geometry};
engine3D["new"]=function(){animateStop();scene3D=new THREE.Scene;scene3DRoofContainer=new THREE.Object3D;scene3DHouseContainer=new THREE.Object3D;scene3DHouseGroundContainer=new THREE.Object3D;scene3DHouseFXContainer=new THREE.Object3D;scene3DLevelGroundContainer=new THREE.Object3D;scene3DLevelWallContainer=new THREE.Object3D;skyMesh=new THREE.Object3D;skyFloorMesh=new THREE.Object3D;engine3D.fontLoader=new THREE.FontLoader;for(var b=0;2>=b;b++)scene3DFloorFurnitureContainer[b]=new THREE.Object3D,
scene3DFloorMeasurementsContainer[b]=new THREE.Object3D,scene3DFloorWallContainer[b]=new THREE.Object3D,scene3DFloorShapeContainer[b]=new THREE.Object3D,scene3DCeilingShapeContainer[b]=new THREE.Object3D,scene3DFloorShapeTextures[b]=[],scene3DCeilingShapeTextures[b]=[],scene3DWallInteriorTextures[b]=[],scene3DWallExteriorTextures[b]=[];engine3D.enableOrbitControls(camera3D,renderer.domElement);engine3D.initPostprocessing()};
engine3D.open=function(b){var e=0;b.file("scene3DFloorContainer.json").async("string").then(function(b){$.each(JSON.parse(b),function(b){$.each(this,function(b){b=null;void 0!==this.note&&(b=this.note);void 0!==this.file&&engine3D.open3DModel(this.file,scene3DFloorFurnitureContainer[e],this["position.x"],this["position.y"],this["position.z"],this["rotation.x"],this["rotation.y"],1,!0,b);void 0!==this.floor&&scene3DFloorShapeTextures[e].push(this.floor);void 0!==this.ceiling&&scene3DCeilingShapeTextures[e].push(this.ceiling)});
e++})});b.file("scene3DTerrain.json").async("string").then(function(b){$.each(JSON.parse(b),function(b){engine3D.open3DModel(this.file,scene3DHouseGroundContainer,this["position.x"],this["position.y"],this["position.z"],this["rotation.x"],this["rotation.y"],1,!0,null)})});b.file("scene3DHouseContainer.json").async("string").then(function(b){$.each(JSON.parse(b),function(b){engine3D.open3DModel(this.file,scene3DHouseContainer,this["position.x"],this["position.y"],this["position.z"],this["rotation.x"],
this["rotation.y"],1,!0,null)})});b.file("scene3DRoofContainer.json").async("string").then(function(b){$.each(JSON.parse(b),function(b){engine3D.open3DModel(this.file,scene3DRoofContainer,this["position.x"],this["position.y"],this["position.z"],this["rotation.x"],this["rotation.y"],1,!0,null)})})};engine3D=window.engine3D||{};
engine3D.initPanorama=function(b,e,c,f){scene3DPanorama=new THREE.Scene;camera3DPanorama=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1E3);rendererPanorama=new THREE.WebGLRenderer({devicePixelRatio:window.devicePixelRatio||1,antialias:!1});rendererPanorama.setSize(window.innerWidth*c,window.innerHeight*f);document.getElementById(b).appendChild(rendererPanorama.domElement);document.addEventListener("mousedown",onPanoramaMouseDown,!1);document.addEventListener("mousewheel",onPanoramaMouseWheel,
!1);document.addEventListener("touchstart",onPanoramaTouchStart,!1);document.addEventListener("touchmove",onPanoramaTouchMove,!1);document.getElementById(b).appendChild(spinner);engine3D.buildPanorama(scene3DPanorama,e,1024,1024,1024,"_",null);document.getElementById(b).removeChild(spinner);$("#"+b).show();animatePanorama()};
engine3D.buildPanorama=function(b,e,c,f,g,k,m){if(!(0<b.children.length)){var p=["panoramas/"+e+"/"+k+"right.jpg","panoramas/"+e+"/"+k+"left.jpg","panoramas/"+e+"/"+k+"top.jpg","panoramas/"+e+"/"+k+"bottom.jpg","panoramas/"+e+"/"+k+"front.jpg","panoramas/"+e+"/"+k+"back.jpg"],p=[new THREE.MeshBasicMaterial({map:textureLoader.load("panoramas/"+e+"/_right.jpg"),side:THREE.BackSide}),new THREE.MeshBasicMaterial({map:textureLoader.load("panoramas/"+e+"/_left.jpg"),side:THREE.BackSide}),new THREE.MeshBasicMaterial({map:textureLoader.load("panoramas/"+
e+"/_top.jpg"),side:THREE.BackSide}),new THREE.MeshBasicMaterial({map:textureLoader.load("panoramas/"+e+"/_bottom.jpg"),side:THREE.BackSide}),new THREE.MeshBasicMaterial({map:textureLoader.load("panoramas/"+e+"/_front.jpg"),side:THREE.BackSide}),new THREE.MeshBasicMaterial({map:textureLoader.load("panoramas/"+e+"/_back.jpg"),side:THREE.BackSide})];c=new THREE.BoxGeometry(c,f,g);m=new THREE.Mesh(c,new THREE.MultiMaterial(p));b.add(m);textureLoader.load("panoramas/"+e+"/right.jpg",function(b){p[0].map=
b});textureLoader.load("panoramas/"+e+"/left.jpg",function(b){p[1].map=b});textureLoader.load("panoramas/"+e+"/top.jpg",function(b){p[2].map=b});textureLoader.load("panoramas/"+e+"/bottom.jpg",function(b){p[3].map=b});textureLoader.load("panoramas/"+e+"/front.jpg",function(b){p[4].map=b});textureLoader.load("panoramas/"+e+"/back.jpg",function(b){p[5].map=b})}};
function onPanoramaMouseDown(b){b.preventDefault();document.addEventListener("mousemove",onPanoramaMouseMove,!1);document.addEventListener("mouseup",onPanoramaMouseUp,!1)}function onPanoramaMouseMove(b){var e=b.movementY||b.mozMovementY||0;mouse.x-=.1*(b.movementX||b.mozMovementX||0);mouse.y+=.1*e}function onPanoramaMouseUp(b){document.removeEventListener("mousemove",onPanoramaMouseMove);document.removeEventListener("mouseup",onPanoramaMouseUp)}
function onPanoramaMouseWheel(b){b.wheelDeltaY?camera3DPanorama.fov-=.05*b.wheelDeltaY:b.wheelDelta?camera3DPanorama.fov-=.05*b.wheelDelta:b.detail&&(camera3DPanorama.fov+=1*b.detail);camera3DPanorama.updateProjectionMatrix()}function onPanoramaTouchStart(b){b.preventDefault();b=b.touches[0];touch.x=b.screenX;touch.y=b.screenY}function onPanoramaTouchMove(b){b.preventDefault();b=b.touches[0];mouse.x-=.1*(b.screenX-touch.x);mouse.y+=.1*(b.screenY-touch.y);touch.x=b.screenX;touch.y=b.screenY}
function disposePanorama(b){rendererPanorama instanceof THREE.WebGLRenderer&&(document.removeEventListener("mousedown",onPanoramaMouseDown,!1),document.removeEventListener("mousewheel",onPanoramaMouseWheel,!1),document.removeEventListener("touchstart",onPanoramaTouchStart,!1),document.removeEventListener("touchmove",onPanoramaTouchMove,!1),document.getElementById(b).removeChild(rendererPanorama.domElement));$("#"+b).hide();scene3DPanorama=camera3DPanorama=rendererPanorama=null};var engine3D=window.engine3D||{},plots_x=20,plots_y=20,plot_vertices=2,map_left=plots_x/-2,map_top=plots_y/-2,terrain3DMouse={x:0,y:0,vertex:{x:null,y:null}},verticeIndex=function(b){return b.x+b.y*(plots_x*plot_vertices+1)},findLattices=function(){return function(b,e){var c=[],f,g,k;f=[0];g=0;k=[];for(var m,p,n;g<=b;){for(yieldable=[];;){m=[];for(p=0;p<g+1;p++)n=f[p],Math.pow(p,2)+Math.pow(n,2)<=Math.pow(g,2)&&(m.push({x:p,y:n}),f[p]+=1);if(0===m.length)break;k=k.concat(m)}g+=1;f.push(0)}for(f=0;f<
k.length;f++)g=k[f],c.push(g),0!==g.x&&c.push({x:-g.x,y:g.y}),0!==g.y&&c.push({x:g.x,y:-g.y}),g.x&&g.y&&c.push({x:-g.x,y:-g.y});for(f=0;f<c.length;f++)c[f].x+=e.x,c[f].y+=e.y;return c}}(),landscape=new function(){var b=null;this.select=function(e){b=e};this.onmousemove=function(){if(!controls3D.enabled){var e=findLattices(3*plot_vertices,terrain3DMouse.vertex);this.tools[b](3*plot_vertices,e);for(var c,f=0;f<e.length;f++)c=verticeIndex(e[f]),6<terrain3D.displacement.array[c]&&(terrain3D.displacement.array[c]=
6),-5>terrain3D.displacement.array[c]&&(terrain3D.displacement.array[c]=-5),terrain3D.water.displacement.array[c]=terrain3D.displacement.array[c];terrain3D.water.displacement.needsUpdate=!0}};this.tools={hill:function(b,c){var e,g,k;for(e=0;e<c.length;e++)g=c[e],0>g.x||0>g.y||g.x>=plots_x*plot_vertices+1||g.y>=plots_y*plot_vertices+1||(k=verticeIndex(g),g=Math.sqrt(Math.pow(terrain3DMouse.vertex.x-g.x,2)+Math.pow(terrain3DMouse.vertex.y-g.y,2)),terrain3D.displacement.array[k]+=.03*Math.pow(b-g,.5),
terrain3D.displacement.needsUpdate=!0)},valley:function(b,c){var e,g,k;for(e=0;e<c.length;e++)g=c[e],0>g.x||0>g.y||g.x>=plots_x*plot_vertices+1||g.y>=plots_y*plot_vertices+1||(k=verticeIndex(g),g=Math.sqrt(Math.pow(terrain3DMouse.vertex.x-g.x,2)+Math.pow(terrain3DMouse.vertex.y-g.y,2)),terrain3D.displacement.array[k]-=.03*Math.pow(b-g,.5),terrain3D.displacement.needsUpdate=!0)}}};function Degrees2Radians(b){return Math.PI/180*b}
function scene3DLandscapeGetHeightData(b,e){void 0===e&&(e=1);var c=document.createElement("canvas");c.width=b.width;c.height=b.height;var f=c.getContext("2d"),g=b.width*b.height,c=new Float32Array(g);f.drawImage(b,0,0);for(var k=0;k<g;k++)c[k]=0;f=f.getImageData(0,0,b.width,b.height).data;for(k=g=0;k<f.length;k+=4){var m=f[k]+f[k+1]+f[k+2];c[g++]=m/(12*e)}return c}
engine3D.initTerrainGround=function(){$.ajax({url:"shaders/ground.vertex.fx",beforeSend:function(b){b.overrideMimeType("text/plain; charset=x-shader/x-vertex")},success:function(b){$.ajax({url:"shaders/ground.fragment.fx",beforeSend:function(b){b.overrideMimeType("text/plain; charset=x-shader/x-fragment")},success:function(e){terrain3DMaterial=new THREE.ShaderMaterial({uniforms:{texture_grass:{type:"t",value:textureLoader.load("objects/Landscape/Textures/G36096.jpg")},texture_bare:{type:"t",value:textureLoader.load("objects/Landscape/Textures/F46734.jpg")},
texture_snow:{type:"t",value:textureLoader.load("objects/Landscape/Textures/F46734.jpg")},show_ring:{type:"i",value:!0},ring_width:{type:"f",value:.15},ring_color:{type:"v4",value:new THREE.Vector4(1,0,0,1)},ring_center:{type:"v3",value:new THREE.Vector3},ring_radius:{type:"f",value:1.6}},vertexShader:b,fragmentShader:e});var c=new THREE.PlaneBufferGeometry(plots_x,plots_y,plots_x*plot_vertices,plots_y*plot_vertices);e=new THREE.Float32Attribute(1*c.attributes.position.count,1);c.addAttribute("displacement",
e);terrain3D=new THREE.Mesh(c,terrain3DMaterial);terrain3D.displacement=c.attributes.displacement;terrain3D.displacement.dynamic=!0;terrain3D.rotation.x=-Math.PI/2;$.ajax({url:"shaders/water.vertex.fx",beforeSend:function(b){b.overrideMimeType("text/plain; charset=x-shader/x-vertex")},success:function(b){$.ajax({url:"shaders/water.fragment.fx",beforeSend:function(b){b.overrideMimeType("text/plain; charset=x-shader/x-fragment")},success:function(e){terrain3D.water=new THREE.Mesh(c,new THREE.ShaderMaterial({uniforms:{water_level:{type:"f",
value:-1},time:{type:"f",value:0}},vertexShader:b,fragmentShader:e,transparent:!0}));terrain3D.water.displacement=c.attributes.displacement;terrain3D.water.displacement.dynamic=!0;terrain3D.water.position.z=-1;terrain3D.add(terrain3D.water)}})}})}})}})};
engine3D.initTerrainClouds=function(){weatherSkyCloudsMesh=new THREE.Mesh;weatherSkyRainbowMesh=new THREE.Mesh;$.ajax({url:"shaders/clouds.vertex.fx",beforeSend:function(b){b.overrideMimeType("text/plain; charset=x-shader/x-vertex")},success:function(b){$.ajax({url:"shaders/clouds.fragment.fx",beforeSend:function(b){b.overrideMimeType("text/plain; charset=x-shader/x-fragment")},success:function(e){var c=new THREE.Fog(4555956,-100,1E3);weatherSkyMaterial=new THREE.ShaderMaterial({uniforms:{map:{type:"t"},
fogColor:{type:"c",value:c.color},fogNear:{type:"f",value:c.near},fogFar:{type:"f",value:c.far}},vertexShader:b,fragmentShader:e,depthWrite:!1,depthTest:!1,transparent:!0});weatherSkyGeometry=new THREE.Geometry;e=new THREE.Mesh(new THREE.PlaneGeometry(4,4));for(c=0;20>c;c++)e.position.x=getRandomInt(-20,20),e.position.y=getRandomInt(5.5,10),e.position.z=c,e.rotation.z=getRandomInt(5,10),e.scale.x=e.scale.y=getRandomInt(.5,1),e.updateMatrix(),weatherSkyGeometry.merge(e.geometry,e.matrix);engine3D.setWeather();
engine3D.initSunlight()}})}})};function getRandomInt(b,e){return Math.floor(Math.random()*(e-b+1))+b}engine3D.initTerrainWater=function(){};engine3D=window.engine3D||{};
engine3D.makeWalls=function(){for(var b=0;b<scene2DWallGroup.length;b++)if(void 0!==scene2DWallGroup[b].children[0]){scene3DFloorWallContainer[b]=new THREE.Object3D;console.log("3D Wall Generate ["+b+"] "+scene2DWallGroup[b].children.length);for(var e=0;e<scene2DWallGroup[FLOOR].children.length;e++){var c=scene2DWallGroup[FLOOR].children[e].children[0].children[0];console.log(c);var f=c.segments[0].point.x/100*2-1,g=2*-(c.segments[0].point.y/100)+1,k=(c.segments[0].point.x+c.segments[1].point.x)/
2/100*2-1,m=-((c.segments[0].point.y+c.segments[1].point.y)/2)/100*2+1,p=c.segments[1].point.x/100*2-1,c=2*-(c.segments[1].point.y/100)+1,f=Math.round(f-13),g=Math.round(g+7),k=Math.round(k-13),m=Math.round(m+7),p=Math.round(p-13),c=Math.round(c+7);console.log("x1:"+f+" y1:"+g+" x2:"+p+" y2:"+c+" cx:"+k+" cy:"+m);var n=new THREE.Shape;n.moveTo(f,g);n.quadraticCurveTo(k,m,p,c);n.moveTo(p,c);n.quadraticCurveTo(k,m,f,g);f=new THREE.ExtrudeGeometry(n,{amount:4,bevelEnabled:!1});f.computeBoundingBox();
g=new THREE.MeshLambertMaterial({map:scene3DWallInteriorTextureDefault,transparent:!0,opacity:.6});f=new THREE.Mesh(f,g);f.rotation.x=-(90*RADIAN);f.position.y=0;scene3DFloorWallContainer[FLOOR].add(f)}}};engine3D=window.engine3D||{};
engine3D.initSunlight=function(){if(settings.sunlight){new THREE.Vector3(0,10,-10);new THREE.MeshDepthMaterial;new THREE.Vector3;sunlight.scene=new THREE.Scene;sunlight.camera=new THREE.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-1E4,1E4);sunlight.camera.position.z=50;sunlight.scene.add(sunlight.camera);var b={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat};sunlight.rtTextureColors=new THREE.WebGLRenderTarget(window.innerWidth,
window.innerHeight,b);sunlight.rtTextureDepth=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,b);var e=window.innerWidth/4,c=window.innerHeight/4;sunlight.rtTextureGodRays1=new THREE.WebGLRenderTarget(e,c,b);sunlight.rtTextureGodRays2=new THREE.WebGLRenderTarget(e,c,b);b=THREE.ShaderGodRays.godrays_generate;sunlight.godrayGenUniforms=THREE.UniformsUtils.clone(b.uniforms);sunlight.materialGodraysGenerate=new THREE.ShaderMaterial({uniforms:sunlight.godrayGenUniforms,vertexShader:b.vertexShader,
fragmentShader:b.fragmentShader});b=THREE.ShaderGodRays.godrays_combine;sunlight.godrayCombineUniforms=THREE.UniformsUtils.clone(b.uniforms);sunlight.materialGodraysCombine=new THREE.ShaderMaterial({uniforms:sunlight.godrayCombineUniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader});b=THREE.ShaderGodRays.godrays_fake_sun;sunlight.godraysFakeSunUniforms=THREE.UniformsUtils.clone(b.uniforms);sunlight.materialGodraysFakeSun=new THREE.ShaderMaterial({uniforms:sunlight.godraysFakeSunUniforms,
vertexShader:b.vertexShader,fragmentShader:b.fragmentShader});sunlight.godraysFakeSunUniforms.bgColor.value.setHex(1297);sunlight.godraysFakeSunUniforms.sunColor.value.setHex(16772608);sunlight.godrayCombineUniforms.fGodRayIntensity.value=.4;sunlight.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(window.innerWidth,window.innerHeight),sunlight.materialGodraysGenerate);sunlight.quad.position.z=-9900;sunlight.scene.add(sunlight.quad)}};
engine3D.setWeather=function(){scene3D.remove(weatherSkyCloudsMesh);scene3D.remove(weatherSkyRainbowMesh);if("day"==DAY){if(settings.clouds&&(texture=textureLoader.load("images/cloud.png"),texture.magFilter=THREE.LinearFilter,texture.minFilter=THREE.LinearFilter,weatherSkyMaterial.uniforms.map.value=texture,weatherSkyCloudsMesh=new THREE.Mesh(weatherSkyGeometry,weatherSkyMaterial),scene3D.add(weatherSkyCloudsMesh)),settings.rainbow){texture=textureLoader.load("images/rainbow.png");texture.minFilter=
THREE.LinearFilter;var b=weatherSkyMaterial.clone();b.uniforms.map.value=texture;geometry=new THREE.Geometry;var e=new THREE.Mesh(new THREE.PlaneGeometry(18,18));e.position.x=getRandomInt(1,15);e.position.y=getRandomInt(5,8);e.position.z=-2;e.updateMatrix();geometry.merge(e.geometry,e.matrix);weatherSkyRainbowMesh=new THREE.Mesh(geometry,b);scene3D.add(weatherSkyRainbowMesh)}}else"night"==DAY&&settings.clouds&&(texture=textureLoader.load("images/cloud2.png"),texture.magFilter=THREE.LinearFilter,texture.minFilter=
THREE.LinearFilter,weatherSkyMaterial.uniforms.map.value=texture,weatherSkyCloudsMesh=new THREE.Mesh(weatherSkyGeometry,weatherSkyMaterial),scene3D.add(weatherSkyCloudsMesh))};engine3D.setSky=function(b){if(skyMesh.name!=b){var e="0000";"day"==b?e=settings.panorama_day:"night"==b&&(e=settings.panorama_night);skyMesh=new THREE.Object3D;engine3D.buildPanorama(skyMesh,e,75,75,75,"",null);skyMesh.position.y=5;skyMesh.name=b}};engine3D.setSkyEffects=function(){};$(function(){var b=!0,e=document.getElementById("picker"),c=e.getContext("2d"),f=new Image;f.onload=function(){c.drawImage(f,0,0,f.width,f.height)};var g="images/colorwheel1.png";switch($(e).attr("var")){case "2":g="images/colorwheel2.png";break;case "3":g="images/colorwheel3.png";break;case "4":g="images/colorwheel4.png";break;case "5":g="images/colorwheel5.png"}f.src=g;$("#picker").mousemove(function(f){if(b){var g=$(e).offset();f=c.getImageData(Math.floor(f.pageX-g.left),Math.floor(f.pageY-g.top),
1,1).data;g="rgb("+f[0]+", "+f[1]+", "+f[2]+")";$(".preview").css("backgroundColor",g);$("#rVal").val(f[0]);$("#gVal").val(f[1]);$("#bVal").val(f[2]);$("#rgbVal").val(f[0]+","+f[1]+","+f[2]);f=f[2]+256*f[1]+65536*f[0];$("#hexVal").val("#"+("0000"+f.toString(16)).substr(-6))}});$("#picker").click(function(c){b=!b});$(".preview").click(function(c){$(".colorpicker").fadeToggle("slow","linear");b=!0})});var engineGUI=window.engineGUI||{};engineGUI.makeScreenshot=function(){getScreenshotData=!0};engineGUI.addNewFloor=function(){if($("#addNewFloor").val()){engine3D.newFloor($("#addNewFloor").val());var b="<a href='#' onclick='camera3DFloorFlyIn("+scene3DFloorFurnitureContainer.length+")'><span>"+$("#addNewFloor").val()+"</span></a>",b=$("<li>").append(b);$("#menuLeft3DHouseFloorList").append(b)}};
engineGUI.generateItemList=function(){$("#generateItemList").empty();for(var b=0;b<scene3DFloorFurnitureContainer.length;b++){console.log(scene3DFloorFurnitureContainer[b].name);for(var e=0;e<scene3DFloorFurnitureContainer[b].children.length;e++)console.log(scene3DFloorFurnitureContainer[b].children[e].children[0].name)}for(b=0;b<scene3DHouseContainer.children.length;b++)console.log(scene3DHouseContainer.children[b].children[0].name)};engineGUI.exportPDF=function(){};var Alertify=function(b,e){var c,f=b.document;c=function(){function b(b){"undefined"!=typeof q&&b.parentNode===q&&q.removeChild(b)}var c,m,p,n,q,h,v,y=!1,C=[],r=!1,t={defaultOkLabel:"Ok",okLabel:this.defaultOkLabel,defaultCancelLabel:"Cancel",cancelLabel:this.defaultCancelLabel,defaultMaxLogItems:2,maxLogItems:this.defaultMaxLogItems,promptValue:"",promptPlaceholder:"",delay:5E3,defaultDelay:5E3,transition:e,addListeners:function(b,c){var e="undefined"!=typeof p,f="undefined"!=typeof m,n=this,g=function(){n.hide();
e&&p.removeEventListener("click",q);f&&m.removeEventListener("click",v)},q=function(c){g(c);"function"==typeof b&&("undefined"==typeof h?b(c):b(h.value,c))},v=function(b){g(b);"function"==typeof c&&c(b)};e&&p.addEventListener("click",q);f&&m.addEventListener("click",v)},build:function(b){var c=(b.cssClass||"","<button class='alertify-button alertify-button-ok' id='alertify-ok'>{{ok}}</button>"),e="<div class='alertify-dialog'><div class='alertify-inner'>"+"<p class='alertify-message'>{{message}}</p>".replace("{{message}}",
b.message);return("confirm"===b.type||"prompt"===b.type)&&(c="<button class='alertify-button alertify-button-cancel' id='alertify-cancel'>{{cancel}}</button><button class='alertify-button alertify-button-ok' id='alertify-ok'>{{ok}}</button>"),"prompt"===b.type&&(e+="<div class='alertify-text-wrapper'><input type='text' class='alertify-text' id='alertify-text'></div>"),e=(e+"<nav class='alertify-buttons'>{{buttons}}</nav></div></div>").replace("{{buttons}}",c).replace("{{ok}}",this.okLabel).replace("{{cancel}}",
this.cancelLabel),n.className="alertify",e},closeLogOnClick:!1,closeLogOnClickDefault:!1,setCloseLogOnClick:function(b){this.closeLogOnClick=!!b},close:function(c,e){var h,f,n=e&&!isNaN(e)?+e:this.delay,g=this;this.closeLogOnClick&&c.addEventListener("click",function(){h(c)});f=function(c){c.stopPropagation();this.removeEventListener(g.transition.type,f);b(this)};h=function(c){var e=1;"undefined"!=typeof c&&c.parentNode===q&&(g.transition.supported&&(c.addEventListener(g.transition.type,f),c.className+=
" alertify-log-hide",e=500),setTimeout(function(){b(c)},e||1))};0!==e&&setTimeout(function(){h(c)},n)},dialog:function(b,c,e,h){this.init();C.push({type:c,message:b,onOkay:e,onCancel:h});y||this.setup()},hide:function(){var b,c=this;C.splice(0,1);0<C.length?this.setup(!0):(y=!1,b=function(e){e.stopPropagation();n.removeEventListener(c.transition.type,b)},this.transition.supported&&n.addEventListener(this.transition.type,b),n.className="alertify alertify-hide alertify-hidden")},init:function(){this.injectCss();
null===f.getElementById("alertify")&&(y=!1,C=[],n=f.createElement("div"),n.setAttribute("id","alertify"),n.className="alertify alertify-hidden",f.body.appendChild(n));null===f.getElementById("alertify-logs")&&(q=f.createElement("div"),q.setAttribute("id","alertify-logs"),q.className="alertify-logs",f.body.appendChild(q));if(!v){var b=f.createElement("fakeelement"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"},h;for(h in c)if(c.hasOwnProperty(h)&&
b.style[h]!==e){v=c[h];r=!0;break}}this.transition={type:v,supported:r}},log:function(b,c,e){this.init();q.className="alertify-logs";var h=q.childNodes.length-this.maxLogItems;if(0<=h)for(var f=0,h=h+1;h>f;f++)this.close(q.childNodes[f],1);this.notify(b,c,e)},notify:function(b,c,e){var h=f.createElement("div");h.className="alertify-log alertify-log-"+(c||"default");h.innerHTML=b;"function"==typeof e&&h.addEventListener("click",e);q.appendChild(h);setTimeout(function(){h.className+=" alertify-log-show"},
50);this.close(h,this.delay)},setup:function(b){var c=C[0],g=this,q=function(b){n.removeEventListener(g.transition.type,q)};y=!0;this.transition.supported&&!b&&n.addEventListener(this.transition.type,q);n.innerHTML=this.build(c);p=f.getElementById("alertify-ok")||e;m=f.getElementById("alertify-cancel")||e;h=f.getElementById("alertify-text")||e;f.getElementById("alertify-form");h&&("string"==typeof this.promptPlaceholder&&(h.placeholder=this.promptPlaceholder),"string"==typeof this.promptValue&&(h.value=
this.promptValue));this.addListeners(c.onOkay,c.onCancel)},okBtn:function(b){return this.okLabel=b,this},setDelay:function(b){var c=parseInt(b||0,10);return this.delay=isNaN(c)?this.defultDelay:b,this},cancelBtn:function(b){return this.cancelLabel=b,this},setMaxLogItems:function(b){this.maxLogItems=parseInt(b||this.defaultMaxLogItems)},reset:function(){this.okBtn(this.defaultOkLabel);this.cancelBtn(this.defaultCancelLabel);this.setMaxLogItems();this.promptPlaceholder=this.promptValue="";this.delay=
this.defaultDelay;this.setCloseLogOnClick(this.closeLogOnClickDefault)},injectCss:function(){if(!c){var b=f.getElementsByTagName("head")[0],e=f.createElement("style");e.type="text/css";e.innerHTML=".alertify,.alertify *,.alertify-button{box-sizing:border-box}.alertify{font-family:inherit;position:fixed;background-color:rgba(0,0,0,.6);left:0;right:0;top:0;bottom:0;width:100%;height:100%;z-index:99999}.alertify .alertify-alert,.alertify .alertify-dialog{width:100%;margin:0 auto;position:relative;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%)}.alertify .alertify-alert .alertify-inner,.alertify .alertify-dialog .alertify-inner{width:400px;max-width:95%;margin:0 auto;padding:12px;background:#fff;box-shadow:0 2px 4px -1px rgba(0,0,0,.14),0 4px 5px 0 rgba(0,0,0,.098),0 1px 10px 0 rgba(0,0,0,.084)}.alertify .alertify-buttons{text-align:right}.alertify,.alertify-hide,.alertify-log,.alertify-show{box-sizing:border-box;-webkit-transition:all .3s cubic-bezier(.25,.8,.25,1);transition:all .3s cubic-bezier(.25,.8,.25,1)}.alertify-dialog{padding:12px}.alertify-hidden{opacity:0;display:none}.alertify-logs{position:fixed;z-index:5000;bottom:0;right:0}.alertify-log{display:block;margin-top:10px;position:relative;right:-100%;opacity:0}.alertify-log-show{right:0;opacity:1}.alertify-log-hide{-webkit-transform:translate(100%,0);-ms-transform:translate(100%,0);transform:translate(100%,0);opacity:0}.alertify-inner{text-align:center}.alertify-text{margin-bottom:15px;width:100%;font-size:100%;border:1px solid #CCC;padding:12px}.alertify .alertify-message{padding:12px;margin:0;text-align:left}.alertify-button{background:0 0;color:rgba(0,0,0,.87);position:relative;outline:0;border:0;display:inline-block;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;padding:0 6px;margin:6px 8px;line-height:36px;min-height:36px;white-space:nowrap;min-width:88px;text-align:center;text-transform:uppercase;font-weight:500;font-size:14px;text-decoration:none;cursor:pointer;border-radius:2px}.alertify-button:active,.alertify-button:hover{background-color:rgba(0,0,0,.05)}.alertify-log{float:right;clear:right;background:rgba(0,0,0,.8);padding:12px 24px;color:#fff;box-shadow:0 2px 5px 0 rgba(0,0,0,.26)}.alertify-log.alertify-log-error{background:rgba(244,67,54,.8)}.alertify-log.alertify-log-success{background:rgba(76,175,80,.9)}";
b.insertBefore(e,b.firstChild);c=!0}}};return{reset:function(){return t.reset(),this},alert:function(b,c,e){return t.dialog(b,"alert",c,e),this},confirm:function(b,c,e){return t.dialog(b,"confirm",c,e),this},prompt:function(b,c,e){return t.dialog(b,"prompt",c,e),this},log:function(b,c){return t.log(b,"default",c),this},success:function(b,c){return t.log(b,"success",c),this},error:function(b,c){return t.log(b,"error",c),this},cancelBtn:function(b){return t.cancelBtn(b),this},okBtn:function(b){return t.okBtn(b),
this},delay:function(b){return t.setDelay(b),this},placeholder:function(b){return t.promptPlaceholder=b,this},defaultValue:function(b){return t.promptValue=b,this},maxLogItems:function(b){return t.setMaxLogItems(b),this},closeLogOnClick:function(b){return t.setCloseLogOnClick(!!b),this}}};"undefined"!=typeof module&&module&&module.exports?module.exports=c:"function"==typeof define&&define.amd?define(function(){return new c}):b.alertify=new c}("undefined"!=typeof window?window:{});var saveAs=saveAs||function(b){if(!("undefined"===typeof b||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=b.document.createElementNS("http://www.w3.org/1999/xhtml","a"),c="download"in e,f=/constructor/i.test(b.HTMLElement)||b.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent),k=function(c){(b.setImmediate||b.setTimeout)(function(){throw c;},0)},m=function(c){setTimeout(function(){"string"===typeof c?(b.URL||b.webkitURL||b).revokeObjectURL(c):c.remove()},4E4)},p=function(b){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(b.type)?
new Blob([String.fromCharCode(65279),b],{type:b.type}):b},n=function(h,n,q){q||(h=p(h));var v=this,r="application/octet-stream"===h.type,y,z=function(){for(var b=["writestart","progress","write","writeend"],b=[].concat(b),c=b.length;c--;){var e=v["on"+b[c]];if("function"===typeof e)try{e.call(v,v)}catch(A){k(A)}}};v.readyState=v.INIT;c?(y=(b.URL||b.webkitURL||b).createObjectURL(h),setTimeout(function(){e.href=y;e.download=n;var b=new MouseEvent("click");e.dispatchEvent(b);z();m(y);v.readyState=v.DONE})):
function(){if((g||r&&f)&&b.FileReader){var c=new FileReader;c.onloadend=function(){var e=g?c.result:c.result.replace(/^data:[^;]*;/,"data:attachment/file;");b.open(e,"_blank")||(b.location.href=e);v.readyState=v.DONE;z()};c.readAsDataURL(h);v.readyState=v.INIT}else y||(y=(b.URL||b.webkitURL||b).createObjectURL(h)),r?b.location.href=y:b.open(y,"_blank")||(b.location.href=y),v.readyState=v.DONE,z(),m(y)}()},q=n.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(b,
c,e){c=c||b.name||"download";e||(b=p(b));return navigator.msSaveOrOpenBlob(b,c)};q.abort=function(){};q.readyState=q.INIT=0;q.WRITING=1;q.DONE=2;q.error=q.onwritestart=q.onprogress=q.onwrite=q.onabort=q.onerror=q.onwriteend=null;return function(b,c,e){return new n(b,c||b.name||"download",e)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);
"undefined"!==typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!==typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs});(function(b){b.easing.jswing=b.easing.swing;b.extend(b.easing,{def:"easeOutQuad",swing:function(e,c,f,g,k){return b.easing[b.easing.def](e,c,f,g,k)},easeInQuad:function(b,c,f,g,k){return g*(c/=k)*c+f},easeOutQuad:function(b,c,f,g,k){return-g*(c/=k)*(c-2)+f},easeInOutQuad:function(b,c,f,g,k){return 1>(c/=k/2)?g/2*c*c+f:-g/2*(--c*(c-2)-1)+f},easeInCubic:function(b,c,f,g,k){return g*(c/=k)*c*c+f},easeOutCubic:function(b,c,f,g,k){return g*((c=c/k-1)*c*c+1)+f},easeInOutCubic:function(b,c,f,g,k){return 1>
(c/=k/2)?g/2*c*c*c+f:g/2*((c-=2)*c*c+2)+f},easeInQuart:function(b,c,f,g,k){return g*(c/=k)*c*c*c+f},easeOutQuart:function(b,c,f,g,k){return-g*((c=c/k-1)*c*c*c-1)+f},easeInOutQuart:function(b,c,f,g,k){return 1>(c/=k/2)?g/2*c*c*c*c+f:-g/2*((c-=2)*c*c*c-2)+f},easeInQuint:function(b,c,f,g,k){return g*(c/=k)*c*c*c*c+f},easeOutQuint:function(b,c,f,g,k){return g*((c=c/k-1)*c*c*c*c+1)+f},easeInOutQuint:function(b,c,f,g,k){return 1>(c/=k/2)?g/2*c*c*c*c*c+f:g/2*((c-=2)*c*c*c*c+2)+f},easeInSine:function(b,c,
f,g,k){return-g*Math.cos(c/k*(Math.PI/2))+g+f},easeOutSine:function(b,c,f,g,k){return g*Math.sin(c/k*(Math.PI/2))+f},easeInOutSine:function(b,c,f,g,k){return-g/2*(Math.cos(Math.PI*c/k)-1)+f},easeInExpo:function(b,c,f,g,k){return 0==c?f:g*Math.pow(2,10*(c/k-1))+f},easeOutExpo:function(b,c,f,g,k){return c==k?f+g:g*(-Math.pow(2,-10*c/k)+1)+f},easeInOutExpo:function(b,c,f,g,k){return 0==c?f:c==k?f+g:1>(c/=k/2)?g/2*Math.pow(2,10*(c-1))+f:g/2*(-Math.pow(2,-10*--c)+2)+f},easeInCirc:function(b,c,f,g,k){return-g*
(Math.sqrt(1-(c/=k)*c)-1)+f},easeOutCirc:function(b,c,f,g,k){return g*Math.sqrt(1-(c=c/k-1)*c)+f},easeInOutCirc:function(b,c,f,g,k){return 1>(c/=k/2)?-g/2*(Math.sqrt(1-c*c)-1)+f:g/2*(Math.sqrt(1-(c-=2)*c)+1)+f},easeInElastic:function(b,c,f,g,k){b=1.70158;var e=0,p=g;if(0==c)return f;if(1==(c/=k))return f+g;e||(e=.3*k);p<Math.abs(g)?(p=g,b=e/4):b=e/(2*Math.PI)*Math.asin(g/p);return-(p*Math.pow(2,10*--c)*Math.sin(2*(c*k-b)*Math.PI/e))+f},easeOutElastic:function(b,c,f,g,k){b=1.70158;var e=0,p=g;if(0==
c)return f;if(1==(c/=k))return f+g;e||(e=.3*k);p<Math.abs(g)?(p=g,b=e/4):b=e/(2*Math.PI)*Math.asin(g/p);return p*Math.pow(2,-10*c)*Math.sin(2*(c*k-b)*Math.PI/e)+g+f},easeInOutElastic:function(b,c,f,g,k){b=1.70158;var e=0,p=g;if(0==c)return f;if(2==(c/=k/2))return f+g;e||(e=.3*k*1.5);p<Math.abs(g)?(p=g,b=e/4):b=e/(2*Math.PI)*Math.asin(g/p);return 1>c?-.5*p*Math.pow(2,10*--c)*Math.sin(2*(c*k-b)*Math.PI/e)+f:p*Math.pow(2,-10*--c)*Math.sin(2*(c*k-b)*Math.PI/e)*.5+g+f},easeInBack:function(b,c,f,g,k,m){void 0==
m&&(m=1.70158);return g*(c/=k)*c*((m+1)*c-m)+f},easeOutBack:function(b,c,f,g,k,m){void 0==m&&(m=1.70158);return g*((c=c/k-1)*c*((m+1)*c+m)+1)+f},easeInOutBack:function(b,c,f,g,k,m){void 0==m&&(m=1.70158);return 1>(c/=k/2)?g/2*c*c*(((m*=1.525)+1)*c-m)+f:g/2*((c-=2)*c*(((m*=1.525)+1)*c+m)+2)+f},easeInBounce:function(e,c,f,g,k){return g-b.easing.easeOutBounce(e,k-c,0,g,k)+f},easeOutBounce:function(b,c,f,g,k){return(c/=k)<1/2.75?7.5625*g*c*c+f:c<2/2.75?g*(7.5625*(c-=1.5/2.75)*c+.75)+f:c<2.5/2.75?g*(7.5625*
(c-=2.25/2.75)*c+.9375)+f:g*(7.5625*(c-=2.625/2.75)*c+.984375)+f},easeInOutBounce:function(e,c,f,g,k){return c<k/2?.5*b.easing.easeInBounce(e,2*c,0,g,k)+f:.5*b.easing.easeOutBounce(e,2*c-k,0,g,k)+.5*g+f}})})(jQuery);!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof exports?module.exports=b:b(jQuery)}(function(b){function e(e){var h=e||window.event,n=p.call(arguments,1),k,m=0,t=0,z=0,u=0,w=0;if(e=b.event.fix(h),e.type="mousewheel","detail"in h&&(t=-1*h.detail),"wheelDelta"in h&&(t=h.wheelDelta),"wheelDeltaY"in h&&(t=h.wheelDeltaY),"wheelDeltaX"in h&&(m=-1*h.wheelDeltaX),"axis"in h&&h.axis===h.HORIZONTAL_AXIS&&(m=-1*t,t=0),k=0===t?m:t,"deltaY"in h&&(t=-1*h.deltaY,k=t),"deltaX"in
h&&(m=h.deltaX,0===t&&(k=-1*m)),0!==t||0!==m){if(1===h.deltaMode){var B=b.data(this,"mousewheel-line-height");k*=B;t*=B;m*=B}else 2===h.deltaMode&&(B=b.data(this,"mousewheel-page-height"),k*=B,t*=B,m*=B);if(z=Math.max(Math.abs(t),Math.abs(m)),(!g||g>z)&&(g=z,q.settings.adjustOldDeltas&&"mousewheel"===h.type&&0===z%120&&(g/=40)),q.settings.adjustOldDeltas&&"mousewheel"===h.type&&0===z%120&&(k/=40,m/=40,t/=40),k=Math[1<=k?"floor":"ceil"](k/g),m=Math[1<=m?"floor":"ceil"](m/g),t=Math[1<=t?"floor":"ceil"](t/
g),q.settings.normalizeOffset&&this.getBoundingClientRect)h=this.getBoundingClientRect(),u=e.clientX-h.left,w=e.clientY-h.top;return e.deltaX=m,e.deltaY=t,e.deltaFactor=g,e.offsetX=u,e.offsetY=w,e.deltaMode=0,n.unshift(e,k,m,t),f&&clearTimeout(f),f=setTimeout(c,200),(b.event.dispatch||b.event.handle).apply(this,n)}}function c(){g=null}var f,g,k=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],m="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],
p=Array.prototype.slice;if(b.event.fixHooks)for(var n=k.length;n;)b.event.fixHooks[k[--n]]=b.event.mouseHooks;var q=b.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=m.length;c;)this.addEventListener(m[--c],e,!1);else this.onmousewheel=e;b.data(this,"mousewheel-line-height",q.getLineHeight(this));b.data(this,"mousewheel-page-height",q.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=m.length;c;)this.removeEventListener(m[--c],
e,!1);else this.onmousewheel=null;b.removeData(this,"mousewheel-line-height");b.removeData(this,"mousewheel-page-height")},getLineHeight:function(c){c=b(c);var e=c["offsetParent"in b.fn?"offsetParent":"parent"]();return e.length||(e=b("body")),parseInt(e.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(c){return b(c).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};b.fn.extend({mousewheel:function(b){return b?this.bind("mousewheel",b):this.trigger("mousewheel")},
unmousewheel:function(b){return this.unbind("mousewheel",b)}})});(function(b){b.fn.unveil=function(e,c){function f(){n=p.filter(function(){var c=b(this);if(!c.is(":hidden")){var e=g.scrollTop(),f=e+g.height(),n=c.offset().top;return n+c.height()>=e-k&&n<=f+k}}).trigger("unveil");p=p.not(n)}var g=b(window),k=e||0,m=1<window.devicePixelRatio?"data-src-retina":"data-src",p=this,n;this.one("unveil",function(){var b=this.getAttribute(m);if(b=b||this.getAttribute("data-src"))this.setAttribute("src",b),"function"===typeof c&&c.call(this)});g.scroll(f);g.resize(f);f();
return this}})(window.jQuery||window.Zepto);!function(b,e,c){function f(){return"function"!=typeof e.createElement?e.createElement(arguments[0]):n?e.createElementNS.call(e,"http://www.w3.org/2000/svg",arguments[0]):e.createElement.apply(e,arguments)}var g=[],k=[];c={_version:"3.3.1",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(b,c){var e=this;setTimeout(function(){c(e[b])},0)},addTest:function(b,c,e){k.push({name:b,fn:c,options:e})},addAsyncTest:function(b){k.push({name:null,fn:b})}};var m=function(){};
m.prototype=c;m=new m;c._prefixes=c._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];var p=e.documentElement,n="svg"===p.nodeName.toLowerCase();n||!function(b,c){function e(){var b=E.elements;return"string"==typeof b?b.split(" "):b}function h(b){var c=G[b[D]];return c||(c={},F++,b[D]=F,G[F]=c),c}function f(b,e,f){if(e||(e=c),k)return e.createElement(b);f||(f=h(e));var n;return n=f.cache[b]?f.cache[b].cloneNode():A.test(b)?(f.cache[b]=f.createElem(b)).cloneNode():f.createElem(b),
!n.canHaveChildren||p.test(b)||n.tagUrn?n:f.frag.appendChild(n)}function n(b,c){c.cache||(c.cache={},c.createElem=b.createElement,c.createFrag=b.createDocumentFragment,c.frag=c.createFrag());b.createElement=function(e){return E.shivMethods?f(e,b,c):c.createElem(e)};b.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+e().join().replace(/[\w\-:]+/g,function(b){return c.createElem(b),c.frag.createElement(b),'c("'+b+'")'})+");return n}")(E,
c.frag)}function g(b){b||(b=c);var e=h(b);if(E.shivCSS&&!q&&!e.hasCSS){var f,g=b;f=g.createElement("p");g=g.getElementsByTagName("head")[0]||g.documentElement;f=(f.innerHTML="x<style>article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}</style>",g.insertBefore(f.lastChild,g.firstChild));e.hasCSS=!!f}return k||n(b,e),b}var q,k,m=b.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,
A=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,D="_html5shiv",F=0,G={};!function(){try{var b=c.createElement("a");b.innerHTML="<xyz></xyz>";q="hidden"in b;var e;if(!(e=1==b.childNodes.length)){c.createElement("a");var h=c.createDocumentFragment();e="undefined"==typeof h.cloneNode||"undefined"==typeof h.createDocumentFragment||"undefined"==typeof h.createElement}k=e}catch(H){k=q=!0}}();var E={elements:m.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",
version:"3.7.3",shivCSS:!1!==m.shivCSS,supportsUnknownElements:k,shivMethods:!1!==m.shivMethods,type:"default",shivDocument:g,createElement:f,createDocumentFragment:function(b,f){if(b||(b=c),k)return b.createDocumentFragment();f=f||h(b);for(var n=f.frag.cloneNode(),g=0,q=e(),v=q.length;v>g;g++)n.createElement(q[g]);return n},addElements:function(b,c){var e=E.elements;"string"!=typeof e&&(e=e.join(" "));"string"!=typeof b&&(b=b.join(" "));E.elements=e+" "+b;g(c)}};b.html5=E;g(c);"object"==typeof module&&
module.exports&&(module.exports=E)}("undefined"!=typeof b?b:this,e);c.testStyles=function(b,c,g,k){var h,q,v,m,y=f("div"),w;v=e.body;w=(v||(v=f(n?"svg":"body"),v.fake=!0),v);if(parseInt(g,10))for(;g--;)v=f("div"),v.id=k?k[g]:"modernizr"+(g+1),y.appendChild(v);return h=f("style"),h.type="text/css",h.id="smodernizr",(w.fake?w:y).appendChild(h),w.appendChild(y),h.styleSheet?h.styleSheet.cssText=b:h.appendChild(e.createTextNode(b)),y.id="modernizr",w.fake&&(w.style.background="",w.style.overflow="hidden",
m=p.style.overflow,p.style.overflow="hidden",p.appendChild(w)),q=c(y,b),w.fake?(w.parentNode.removeChild(w),p.style.overflow=m,p.offsetHeight):y.parentNode.removeChild(y),!!q};(function(){var b,c,e,f,n,r;for(r in k)if(k.hasOwnProperty(r)){if(b=[],c=k[r],c.name&&(b.push(c.name.toLowerCase()),c.options&&c.options.aliases&&c.options.aliases.length))for(e=0;e<c.options.aliases.length;e++)b.push(c.options.aliases[e].toLowerCase());e="function"===typeof c.fn?c.fn():c.fn;for(f=0;f<b.length;f++)n=b[f],n=
n.split("."),1===n.length?m[n[0]]=e:(!m[n[0]]||m[n[0]]instanceof Boolean||(m[n[0]]=new Boolean(m[n[0]])),m[n[0]][n[1]]=e),g.push((e?"":"no-")+n.join("-"))}})();(function(b){var c=p.className,e=m._config.classPrefix||"";if(n&&(c=c.baseVal),m._config.enableJSClass)c=c.replace(new RegExp("(^|\\s)"+e+"no-js(\\s|$)"),"$1"+e+"js$2");m._config.enableClasses&&(c+=" "+e+b.join(" "+e),n?p.className.baseVal=c:p.className=c)})(g);delete c.addTest;delete c.addAsyncTest;for(c=0;c<m._q.length;c++)m._q[c]();b.Modernizr=
m}(window,document);!function(){var b="undefined"!=typeof module&&module.exports,e="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,c=function(){var b,c,e=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),
"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],f=0;c=e.length;for(var n={};c>f;f++)if(b=e[f],b&&b[1]in document){f=0;for(c=b.length;c>f;f++)n[e[0][f]]=b[f];return n}return!1}(),f={request:function(b){var f=c.requestFullscreen;b=b||document.documentElement;/5\.1[\.\d]* Safari/.test(navigator.userAgent)?
b[f]():b[f](e&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[c.exitFullscreen]()},toggle:function(b){this.isFullscreen?this.exit():this.request(b)},raw:c};return c?(Object.defineProperties(f,{isFullscreen:{get:function(){return!!document[c.fullscreenElement]}},element:{enumerable:!0,get:function(){return document[c.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!document[c.fullscreenEnabled]}}}),void(b?module.exports=f:window.screenfull=f)):void(b?module.exports=!1:window.screenfull=
!1)}();(function(b){function e(){var c=b(this),e=C(c);c.is(".fixed-top, .fixed-bottom, .horizontal-percent")?c.css("min-height",z(e.first)+z(e.last)+b(e.divider).height()+"px"):c.css("min-width",u(e.first)+u(e.last)+b(e.divider).width()+"px")}function c(c){c.preventDefault();var e=b(this),h=e.parent();e.addClass("dragged");c.type.match(/^touch/)&&e.addClass("touch");var n=m(h,r(c),t(c));b(document).on("touchmove mousemove",n);b(document).one("touchend mouseup",function(c){b(document).off("touchmove mousemove",
n);e.removeClass("dragged touch");h.trigger("dividerdragend",[f(h)])});h.trigger("dividerdragstart",[f(h)])}function f(b){var c=b.is(".fixed-top, .fixed-bottom, .horizontal-percent")?"height":"width";return{firstComponentSize:b.find(".split-pane-component:first")[c](),lastComponentSize:b.find(".split-pane-component:last")[c]()}}function g(){var c=b(this),e=k(c),h=c.parent().closest(".split-pane")[0]||window;b(h).on(h===window?"resize":"splitpaneresize",function(b){(b.target===document?window:b.target)===
h&&e(b)})}function k(b){var c=C(b);if(b.is(".fixed-top"))return function(e){e=z(c.last);e=c.splitPane.offsetHeight-e-c.divider.offsetHeight;c.first.offsetHeight>e&&w(c,e+"px");b.trigger("splitpaneresize")};if(b.is(".fixed-bottom"))return function(e){e=z(c.first);e=c.splitPane.offsetHeight-e-c.divider.offsetHeight;c.last.offsetHeight>e&&B(c,e+"px");b.trigger("splitpaneresize")};if(b.is(".horizontal-percent"))return function(e){e=z(c.last);var h=z(c.first),h=c.splitPane.offsetHeight-h-c.divider.offsetHeight;
c.last.offsetHeight>h?B(c,h/c.splitPane.offsetHeight*100+"%"):c.splitPane.offsetHeight-c.first.offsetHeight-c.divider.offsetHeight<e&&B(c,e/c.splitPane.offsetHeight*100+"%");b.trigger("splitpaneresize")};if(b.is(".fixed-left"))return function(e){e=u(c.last);e=c.splitPane.offsetWidth-e-c.divider.offsetWidth;c.first.offsetWidth>e&&A(c,e+"px");b.trigger("splitpaneresize")};if(b.is(".fixed-right"))return function(e){e=u(c.first);e=c.splitPane.offsetWidth-e-c.divider.offsetWidth;c.last.offsetWidth>e&&
D(c,e+"px");b.trigger("splitpaneresize")};if(b.is(".vertical-percent"))return function(e){e=u(c.last);var h=u(c.first),h=c.splitPane.offsetWidth-h-c.divider.offsetWidth;c.last.offsetWidth>h?D(c,h/c.splitPane.offsetWidth*100+"%"):c.splitPane.offsetWidth-c.first.offsetWidth-c.divider.offsetWidth<e&&D(c,e/c.splitPane.offsetWidth*100+"%");b.trigger("splitpaneresize")}}function m(b,c,e){var f=C(b);if(b.is(".fixed-top"))return p(f,e);if(b.is(".fixed-bottom"))return n(f,e);if(b.is(".horizontal-percent"))return q(f,
e);if(b.is(".fixed-left"))return h(f,c);if(b.is(".fixed-right"))return v(f,c);if(b.is(".vertical-percent"))return y(f,c)}function p(c,e){var h=z(c.first),f=c.splitPane.offsetHeight-z(c.last)-c.divider.offsetHeight,n=c.divider.offsetTop-e;return function(e){e.preventDefault&&e.preventDefault();e=n+t(e);w(c,Math.min(Math.max(h,e),f)+"px");b(c.splitPane).trigger("splitpaneresize")}}function n(c,e){var h=z(c.last),f=c.splitPane.offsetHeight-z(c.first)-c.divider.offsetHeight,n=c.last.offsetHeight+e;return function(e){e.preventDefault&&
e.preventDefault();e=Math.min(Math.max(h,n-t(e)),f);B(c,e+"px");b(c.splitPane).trigger("splitpaneresize")}}function q(c,e){var h=c.splitPane.offsetHeight,f=z(c.last),n=h-z(c.first)-c.divider.offsetHeight,g=c.last.offsetHeight+e;return function(e){e.preventDefault&&e.preventDefault();e=Math.min(Math.max(f,g-t(e)),n);B(c,e/h*100+"%");b(c.splitPane).trigger("splitpaneresize")}}function h(c,e){var h=u(c.first),f=c.splitPane.offsetWidth-u(c.last)-c.divider.offsetWidth,n=c.divider.offsetLeft-e;return function(e){e.preventDefault&&
e.preventDefault();e=n+r(e);A(c,Math.min(Math.max(h,e),f)+"px");b(c.splitPane).trigger("splitpaneresize")}}function v(c,e){var h=u(c.last),f=c.splitPane.offsetWidth-u(c.first)-c.divider.offsetWidth,n=c.last.offsetWidth+e;return function(e){e.preventDefault&&e.preventDefault();e=Math.min(Math.max(h,n-r(e)),f);D(c,e+"px");b(c.splitPane).trigger("splitpaneresize")}}function y(c,e){var h=c.splitPane.offsetWidth,f=u(c.last),n=h-u(c.first)-c.divider.offsetWidth,g=c.last.offsetWidth+e;return function(e){e.preventDefault&&
e.preventDefault();e=Math.min(Math.max(f,g-r(e)),n);D(c,e/h*100+"%");b(c.splitPane).trigger("splitpaneresize")}}function C(b){return{splitPane:b[0],first:b.children(".split-pane-component:first")[0],divider:b.children(".split-pane-divider")[0],last:b.children(".split-pane-component:last")[0]}}function r(b){if(void 0!==b.pageX)return b.pageX;if(void 0!==b.originalEvent.pageX)return b.originalEvent.pageX;if(b.originalEvent.touches)return b.originalEvent.touches[0].pageX}function t(b){if(void 0!==b.pageY)return b.pageY;
if(void 0!==b.originalEvent.pageY)return b.originalEvent.pageY;if(b.originalEvent.touches)return b.originalEvent.touches[0].pageY}function z(c){return parseInt(b(c).css("min-height"),10)||0}function u(c){return parseInt(b(c).css("min-width"),10)||0}function w(b,c){b.first.style.height=c;b.divider.style.top=c;b.last.style.top=c}function B(b,c){b.first.style.bottom=c;b.divider.style.bottom=c;b.last.style.height=c}function A(b,c){b.first.style.width=c;b.divider.style.left=c;b.last.style.left=c}function D(b,
c){b.first.style.right=c;b.divider.style.right=c;b.last.style.width=c}var F={init:function(){var h=this;h.each(e);h.children(".split-pane-divider").html('<div class="split-pane-divider-inner"></div>');h.children(".split-pane-divider").on("touchstart mousedown",c);setTimeout(function(){h.each(g);b(window).trigger("resize")},100)},firstComponentSize:function(c){this.each(function(){var e=b(this),f=C(e);e.is(".fixed-top")?p(f,f.divider.offsetTop)({pageY:c}):e.is(".fixed-bottom")?(c=f.splitPane.offsetHeight-
f.divider.offsetHeight-c,n(f,-f.last.offsetHeight)({pageY:-c})):e.is(".horizontal-percent")?(c=f.splitPane.offsetHeight-f.divider.offsetHeight-c,q(f,-f.last.offsetHeight)({pageY:-c})):e.is(".fixed-left")?h(f,f.divider.offsetLeft)({pageX:c}):e.is(".fixed-right")?(c=f.splitPane.offsetWidth-f.divider.offsetWidth-c,v(f,-f.last.offsetWidth)({pageX:-c})):e.is(".vertical-percent")&&(c=f.splitPane.offsetWidth-f.divider.offsetWidth-c,y(f,-f.last.offsetWidth)({pageX:-c}))})},lastComponentSize:function(c){this.each(function(){var e=
b(this),f=C(e);e.is(".fixed-top")?(c=f.splitPane.offsetHeight-f.divider.offsetHeight-c,p(f,f.divider.offsetTop)({pageY:c})):e.is(".fixed-bottom")?n(f,-f.last.offsetHeight)({pageY:-c}):e.is(".horizontal-percent")?q(f,-f.last.offsetHeight)({pageY:-c}):e.is(".fixed-left")?(c=f.splitPane.offsetWidth-f.divider.offsetWidth-c,h(f,f.divider.offsetLeft)({pageX:c})):e.is(".fixed-right")?v(f,-f.last.offsetWidth)({pageX:-c}):e.is(".vertical-percent")&&y(f,-f.last.offsetWidth)({pageX:-c})})}};b.fn.splitPane=function(c){F[c||
"init"].apply(this,b.grep(arguments,function(b,c){return 0<c}))}})(jQuery);(function(){function b(){if(q){requestAnimFrame(b);for(var c=0,e=n.length;c<e;c++)n[c].update()}}function e(e,g){if(e.nodeName&&!1!==/^(ul|ol)$/i.test(e.nodeName))f(e)&&c(e);else return!1;var h=p?new m(e):new k(e);g&&g.live&&(h.syncInterval=setInterval(function(){h.sync.call(h)},500));h.sync();n.push(h);1===n.length&&(q=!0,b())}function c(b){for(var c=0;c<n.length;c++){var e=n[c];e.element==b&&(e.destroy(),n.splice(c,1),c--)}0===n.length&&(q=!1)}function f(b){for(var c=0,e=n.length;c<e;c++)if(n[c].element==
b)return!0;return!1}function g(b,c,e){var h,f;if("string"===typeof b)for(b=document.querySelectorAll(b),h=0,f=b.length;h<f;h++)c.call(null,b[h],e);else if("object"===typeof b&&"number"===typeof b.length)for(h=0,f=b.length;h<f;h++)c.call(null,b[h],e);else if(b.nodeName)c.call(null,b,e);else throw"Stroll target was of unexpected type.";}function k(b){this.element=b}function m(b){this.element=b;this.element.style.overflow="hidden";this.top={value:0,natural:0};this.touch={value:0,offset:0,start:0,previous:0,
lastMove:Date.now(),accellerateTimeout:-1,isAccellerating:!1,isActive:!1};this.velocity=0}var p=!!("ontouchstart"in window),n=[],q=!1;k.prototype.sync=function(){this.items=Array.prototype.slice.apply(this.element.children);this.listHeight=this.element.offsetHeight;for(var b=0,c=this.items.length;b<c;b++){var e=this.items[b];e._offsetHeight=e.offsetHeight;e._offsetTop=e.offsetTop;e._offsetBottom=e._offsetTop+e._offsetHeight;e._state=""}this.update(!0)};k.prototype.update=function(b){var c=this.element.pageYOffset||
this.element.scrollTop,e=c+this.listHeight;if(c!==this.lastTop||b){this.lastTop=c;b=0;for(var h=this.items.length;b<h;b++){var f=this.items[b];f._offsetBottom<c?"past"!==f._state&&(f._state="past",f.classList.add("past"),f.classList.remove("future")):f._offsetTop>e?"future"!==f._state&&(f._state="future",f.classList.add("future"),f.classList.remove("past")):f._state&&("past"===f._state&&f.classList.remove("past"),"future"===f._state&&f.classList.remove("future"),f._state="")}}};k.prototype.destroy=
function(){clearInterval(this.syncInterval);for(var b=0,c=this.items.length;b<c;b++){var e=this.items[b];e.classList.remove("past");e.classList.remove("future")}};m.prototype=new k;m.prototype.sync=function(){this.items=Array.prototype.slice.apply(this.element.children);this.listHeight=this.element.offsetHeight;for(var b,c=0,e=this.items.length;c<e;c++)b=this.items[c],b._offsetHeight=b.offsetHeight,b._offsetTop=b.offsetTop,b._offsetBottom=b._offsetTop+b._offsetHeight,b._state="",b.style.opacity=1;
this.top.natural=this.element.scrollTop;this.top.value=this.top.natural;this.top.max=b._offsetBottom-this.listHeight;this.update(!0);this.bind()};m.prototype.bind=function(){var b=this;this.touchStartDelegate=function(c){b.onTouchStart(c)};this.touchMoveDelegate=function(c){b.onTouchMove(c)};this.touchEndDelegate=function(c){b.onTouchEnd(c)};this.element.addEventListener("touchstart",this.touchStartDelegate,!1);this.element.addEventListener("touchmove",this.touchMoveDelegate,!1);this.element.addEventListener("touchend",
this.touchEndDelegate,!1)};m.prototype.onTouchStart=function(b){b.preventDefault();if(1===b.touches.length)if(this.touch.isActive=!0,this.touch.start=b.touches[0].clientY,this.touch.previous=this.touch.start,this.touch.value=this.touch.start,this.touch.offset=0,this.velocity){this.touch.isAccellerating=!0;var c=this;this.touch.accellerateTimeout=setTimeout(function(){c.touch.isAccellerating=!1;c.velocity=0},500)}else this.velocity=0};m.prototype.onTouchMove=function(b){if(1===b.touches.length){var c=
this.touch.value;this.touch.value=b.touches[0].clientY;this.touch.lastMove=Date.now();b=this.touch.value>this.touch.previous&&0>this.velocity||this.touch.value<this.touch.previous&&0<this.velocity;this.touch.isAccellerating&&b?(clearInterval(this.touch.accellerateTimeout),this.velocity+=(this.touch.previous-this.touch.value)/10):(this.velocity=0,this.touch.isAccellerating=!1,this.touch.offset=Math.round(this.touch.start-this.touch.value));this.touch.previous=c}};m.prototype.onTouchEnd=function(b){var c=
this.touch.start-this.touch.value;this.touch.isAccellerating||(this.velocity=(this.touch.start-this.touch.value)/10);if(200<Date.now()-this.touch.lastMove||5>Math.abs(this.touch.previous-this.touch.value))this.velocity=0;this.top.value+=this.touch.offset;this.touch.offset=0;this.touch.start=0;this.touch.value=0;this.touch.isActive=!1;this.touch.isAccellerating=!1;clearInterval(this.touch.accellerateTimeout);(4<Math.abs(this.velocity)||10<Math.abs(c))&&b.preventDefault()};m.prototype.update=function(b){var c=
this.top.value+this.velocity+this.touch.offset;if(this.velocity||this.touch.offset)this.element.scrollTop=c,c=Math.max(0,Math.min(this.element.scrollTop,this.top.max)),this.top.value=c-this.touch.offset;if(!this.touch.isActive||this.touch.isAccellerating)this.velocity*=.95;.15>Math.abs(this.velocity)&&(this.velocity=0);if(c!==this.top.natural||b){this.top.natural=c;this.top.value=c-this.touch.offset;b=c+this.listHeight;for(var e=0,f=this.items.length;e<f;e++){var h=this.items[e];h._offsetBottom<c?
0>=this.velocity&&"past"!==h._state&&(h.classList.add("past"),h._state="past"):h._offsetTop>b?0<=this.velocity&&"future"!==h._state&&(h.classList.add("future"),h._state="future"):h._state&&("past"===h._state&&h.classList.remove("past"),"future"===h._state&&h.classList.remove("future"),h._state="")}}};m.prototype.destroy=function(){k.prototype.destroy.apply(this);this.element.removeEventListener("touchstart",this.touchStartDelegate,!1);this.element.removeEventListener("touchmove",this.touchMoveDelegate,
!1);this.element.removeEventListener("touchend",this.touchEndDelegate,!1)};window.stroll={bind:function(b,c){document.body.classList&&g(b,e,c)},unbind:function(b){document.body.classList&&g(b,c)}};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){window.setTimeout(b,1E3/60)}}()})();!function(b,e){"function"==typeof define&&define.amd?define(["jquery"],function(b){return e(b)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(this,function(b){function e(b){this.$container;this.constraints=null;this.__$tooltip;this.__init(b)}function c(c,e){var f=!0;return b.each(c,function(b,h){return void 0===e[b]||c[b]!==e[b]?(f=!1,!1):void 0}),f}function f(c){var e=c.attr("id");return(e=e?m.window.document.getElementById(e):null)?e===c[0]:b.contains(m.window.document.body,
c[0])}var g={animation:"fade",animationDuration:350,content:null,contentAsHTML:!1,contentCloning:!1,debug:!0,delay:300,delayTouch:[300,500],functionInit:null,functionBefore:null,functionReady:null,functionAfter:null,functionFormat:null,IEmin:6,interactive:!1,multiple:!1,parent:"body",plugins:["sideTip"],repositionOnScroll:!1,restoration:"none",selfDestruction:!0,theme:[],timer:0,trackerInterval:500,trackOrigin:!1,trackTooltip:!1,trigger:"hover",triggerClose:{click:!1,mouseleave:!1,originClick:!1,
scroll:!1,tap:!1,touchleave:!1},triggerOpen:{click:!1,mouseenter:!1,tap:!1,touchstart:!1},updateAnimation:"rotate",zIndex:9999999},k="undefined"!=typeof window?window:null,m={hasTouchCapability:!(!k||!("ontouchstart"in k||k.DocumentTouch&&k.document instanceof k.DocumentTouch||k.navigator.maxTouchPoints)),hasTransitions:function(){if(!k)return!1;var b=(k.document.body||k.document.documentElement).style,c="transition",e=["Moz","Webkit","Khtml","O","ms"];if("string"==typeof b[c])return!0;for(var c=
c.charAt(0).toUpperCase()+c.substr(1),f=0;f<e.length;f++)if("string"==typeof b[e[f]+c])return!0;return!1}(),IE:!1,semVer:"4.1.6",window:k},p=function(){this.__$emitterPrivate=b({});this.__$emitterPublic=b({});this.__instancesLatestArr=[];this.__plugins={};this._env=m};p.prototype={__bridge:function(c,e,f){if(!e[f]){var h=function(){};h.prototype=c;var n=new h;n.__init&&n.__init(e);b.each(c,function(b,c){0!=b.indexOf("__")&&(e[b]?g.debug&&console.log("The "+b+" method of the "+f+" plugin conflicts with another plugin or native methods"):
(e[b]=function(){return n[b].apply(n,Array.prototype.slice.apply(arguments))},e[b].bridged=n))});e[f]=n}return this},__setWindow:function(b){return m.window=b,this},_getRuler:function(b){return new e(b)},_off:function(){return this.__$emitterPrivate.off.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),this},_on:function(){return this.__$emitterPrivate.on.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),this},_one:function(){return this.__$emitterPrivate.one.apply(this.__$emitterPrivate,
Array.prototype.slice.apply(arguments)),this},_plugin:function(c){if("string"==typeof c){var e=null;return 0<c.indexOf(".")?e=this.__plugins[c]:b.each(this.__plugins,function(b,f){return f.name.substring(f.name.length-c.length-1)=="."+c?(e=f,!1):void 0}),e}if(0>c.name.indexOf("."))throw Error("Plugins must be namespaced");return this.__plugins[c.name]=c,c.core&&this.__bridge(c.core,this,c.name),this},_trigger:function(){var b=Array.prototype.slice.apply(arguments);return"string"==typeof b[0]&&(b[0]=
{type:b[0]}),this.__$emitterPrivate.trigger.apply(this.__$emitterPrivate,b),this.__$emitterPublic.trigger.apply(this.__$emitterPublic,b),this},instances:function(c){var e=[];return b(c||".tooltipstered").each(function(){var c=b(this),f=c.data("tooltipster-ns");f&&b.each(f,function(b,f){e.push(c.data(f))})}),e},instancesLatest:function(){return this.__instancesLatestArr},off:function(){return this.__$emitterPublic.off.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this},on:function(){return this.__$emitterPublic.on.apply(this.__$emitterPublic,
Array.prototype.slice.apply(arguments)),this},one:function(){return this.__$emitterPublic.one.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this},origins:function(c){return b((c?c+" ":"")+".tooltipstered").toArray()},setDefaults:function(c){return b.extend(g,c),this},triggerHandler:function(){return this.__$emitterPublic.triggerHandler.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this}};b.tooltipster=new p;b.Tooltipster=function(c,e){this.__callbacks={close:[],
open:[]};this.__closingTime;this.__Content;this.__contentBcr;this.__destroying=this.__destroyed=!1;this.__$emitterPrivate=b({});this.__$emitterPublic=b({});this.__enabled=!0;this.__garbageCollector;this.__Geometry;this.__lastPosition;this.__namespace="tooltipster-"+Math.round(1E6*Math.random());this.__options;this.__$originParents;this.__pointerIsOverOrigin=!1;this.__previousThemes=[];this.__state="closed";this.__timeouts={close:[],open:null};this.__touchEvents=[];this.__tracker=null;this._$origin;
this._$tooltip;this.__init(c,e)};b.Tooltipster.prototype={__init:function(c,e){var f=this;if(f._$origin=b(c),f.__options=b.extend(!0,{},g,e),f.__optionsFormat(),!m.IE||m.IE>=f.__options.IEmin){var n=null;if(void 0===f._$origin.data("tooltipster-initialTitle")&&(n=f._$origin.attr("title"),void 0===n&&(n=null),f._$origin.data("tooltipster-initialTitle",n)),null!==f.__options.content)f.__contentSet(f.__options.content);else{var q,k=f._$origin.attr("data-tooltip-content");k&&(q=b(k));q&&q[0]?f.__contentSet(q.first()):
f.__contentSet(n)}f._$origin.removeAttr("title").addClass("tooltipstered");f.__prepareOrigin();f.__prepareGC();b.each(f.__options.plugins,function(b,c){f._plug(c)});m.hasTouchCapability&&b("body").on("touchmove."+f.__namespace+"-triggerOpen",function(b){f._touchRecordEvent(b)});f._on("created",function(){f.__prepareTooltip()})._on("repositioned",function(b){f.__lastPosition=b.position})}else f.__options.disabled=!0},__contentInsert:function(){var b=this._$tooltip.find(".tooltipster-content"),c=this.__Content;
return this._trigger({type:"format",content:this.__Content,format:function(b){c=b}}),this.__options.functionFormat&&(c=this.__options.functionFormat.call(this,this,{origin:this._$origin[0]},this.__Content)),"string"!=typeof c||this.__options.contentAsHTML?b.empty().append(c):b.text(c),this},__contentSet:function(c){return c instanceof b&&this.__options.contentCloning&&(c=c.clone(!0)),this.__Content=c,this._trigger({type:"updated",content:c}),this},__destroyError:function(){throw Error("This tooltip has been destroyed and cannot execute your method call.");
},__geometry:function(){var c=this._$origin,e=this._$origin.is("area");if(e)var f=this._$origin.parent().attr("name"),c=b('img[usemap="#'+f+'"]');var g=c[0].getBoundingClientRect(),k=b(m.window.document),p=b(m.window),f=c,r={available:{document:null,window:null},document:{size:{height:k.height(),width:k.width()}},window:{scroll:{left:m.window.scrollX||m.window.document.documentElement.scrollLeft,top:m.window.scrollY||m.window.document.documentElement.scrollTop},size:{height:p.height(),width:p.width()}},
origin:{fixedLineage:!1,offset:{},size:{height:g.bottom-g.top,width:g.right-g.left},usemapImage:e?c[0]:null,windowOffset:{bottom:g.bottom,left:g.left,right:g.right,top:g.top}}};if(e){var e=this._$origin.attr("shape"),t=this._$origin.attr("coords");if(t&&(t=t.split(","),b.map(t,function(b,c){t[c]=parseInt(b)})),"default"!=e)switch(e){case "circle":e=t[0];c=t[1];g=t[2];r.origin.size.height=2*g;r.origin.size.width=r.origin.size.height;r.origin.windowOffset.left+=e-g;r.origin.windowOffset.top+=c-g;break;
case "rect":e=t[0];c=t[1];g=t[2];r.origin.size.height=t[3]-c;r.origin.size.width=g-e;r.origin.windowOffset.left+=e;r.origin.windowOffset.top+=c;break;case "poly":for(var k=g=c=e=0,p="even",z=0;z<t.length;z++){var u=t[z];"even"==p?(u>g&&(g=u,0===z&&(e=g)),e>u&&(e=u),p="odd"):(u>k&&(k=u,1==z&&(c=k)),c>u&&(c=u),p="even")}r.origin.size.height=k-c;r.origin.size.width=g-e;r.origin.windowOffset.left+=e;r.origin.windowOffset.top+=c}}this._trigger({type:"geometry",edit:function(b){r.origin.size.height=b.height;
r.origin.windowOffset.left=b.left;r.origin.windowOffset.top=b.top;r.origin.size.width=b.width},geometry:{height:r.origin.size.height,left:r.origin.windowOffset.left,top:r.origin.windowOffset.top,width:r.origin.size.width}});r.origin.windowOffset.right=r.origin.windowOffset.left+r.origin.size.width;r.origin.windowOffset.bottom=r.origin.windowOffset.top+r.origin.size.height;r.origin.offset.left=r.origin.windowOffset.left+r.window.scroll.left;r.origin.offset.top=r.origin.windowOffset.top+r.window.scroll.top;
r.origin.offset.bottom=r.origin.offset.top+r.origin.size.height;r.origin.offset.right=r.origin.offset.left+r.origin.size.width;r.available.document={bottom:{height:r.document.size.height-r.origin.offset.bottom,width:r.document.size.width},left:{height:r.document.size.height,width:r.origin.offset.left},right:{height:r.document.size.height,width:r.document.size.width-r.origin.offset.right},top:{height:r.origin.offset.top,width:r.document.size.width}};for(r.available.window={bottom:{height:Math.max(r.window.size.height-
Math.max(r.origin.windowOffset.bottom,0),0),width:r.window.size.width},left:{height:r.window.size.height,width:Math.max(r.origin.windowOffset.left,0)},right:{height:r.window.size.height,width:Math.max(r.window.size.width-Math.max(r.origin.windowOffset.right,0),0)},top:{height:Math.max(r.origin.windowOffset.top,0),width:r.window.size.width}};"html"!=f[0].tagName.toLowerCase();){if("fixed"==f.css("position")){r.origin.fixedLineage=!0;break}f=f.parent()}return r},__optionsFormat:function(){return"number"==
typeof this.__options.animationDuration&&(this.__options.animationDuration=[this.__options.animationDuration,this.__options.animationDuration]),"number"==typeof this.__options.delay&&(this.__options.delay=[this.__options.delay,this.__options.delay]),"number"==typeof this.__options.delayTouch&&(this.__options.delayTouch=[this.__options.delayTouch,this.__options.delayTouch]),"string"==typeof this.__options.theme&&(this.__options.theme=[this.__options.theme]),"string"==typeof this.__options.parent&&
(this.__options.parent=b(this.__options.parent)),"hover"==this.__options.trigger?(this.__options.triggerOpen={mouseenter:!0,touchstart:!0},this.__options.triggerClose={mouseleave:!0,originClick:!0,touchleave:!0}):"click"==this.__options.trigger&&(this.__options.triggerOpen={click:!0,tap:!0},this.__options.triggerClose={click:!0,tap:!0}),this._trigger("options"),this},__prepareGC:function(){var c=this;return c.__options.selfDestruction?c.__garbageCollector=setInterval(function(){var e=(new Date).getTime();
c.__touchEvents=b.grep(c.__touchEvents,function(b,c){return 6E4<e-b.time});f(c._$origin)||c.destroy()},2E4):clearInterval(c.__garbageCollector),c},__prepareOrigin:function(){var b=this;if(b._$origin.off("."+b.__namespace+"-triggerOpen"),m.hasTouchCapability&&b._$origin.on("touchstart."+b.__namespace+"-triggerOpen touchend."+b.__namespace+"-triggerOpen touchcancel."+b.__namespace+"-triggerOpen",function(c){b._touchRecordEvent(c)}),b.__options.triggerOpen.click||b.__options.triggerOpen.tap&&m.hasTouchCapability){var c=
"";b.__options.triggerOpen.click&&(c+="click."+b.__namespace+"-triggerOpen ");b.__options.triggerOpen.tap&&m.hasTouchCapability&&(c+="touchend."+b.__namespace+"-triggerOpen");b._$origin.on(c,function(c){b._touchIsMeaningfulEvent(c)&&b._open(c)})}if(b.__options.triggerOpen.mouseenter||b.__options.triggerOpen.touchstart&&m.hasTouchCapability)c="",b.__options.triggerOpen.mouseenter&&(c+="mouseenter."+b.__namespace+"-triggerOpen "),b.__options.triggerOpen.touchstart&&m.hasTouchCapability&&(c+="touchstart."+
b.__namespace+"-triggerOpen"),b._$origin.on(c,function(c){!b._touchIsTouchEvent(c)&&b._touchIsEmulatedEvent(c)||(b.__pointerIsOverOrigin=!0,b._openShortly(c))});if(b.__options.triggerClose.mouseleave||b.__options.triggerClose.touchleave&&m.hasTouchCapability)c="",b.__options.triggerClose.mouseleave&&(c+="mouseleave."+b.__namespace+"-triggerOpen "),b.__options.triggerClose.touchleave&&m.hasTouchCapability&&(c+="touchend."+b.__namespace+"-triggerOpen touchcancel."+b.__namespace+"-triggerOpen"),b._$origin.on(c,
function(c){b._touchIsMeaningfulEvent(c)&&(b.__pointerIsOverOrigin=!1)});return b},__prepareTooltip:function(){var c=this,e=c.__options.interactive?"auto":"";return c._$tooltip.attr("id",c.__namespace).css({"pointer-events":e,zIndex:c.__options.zIndex}),b.each(c.__previousThemes,function(b,e){c._$tooltip.removeClass(e)}),b.each(c.__options.theme,function(b,e){c._$tooltip.addClass(e)}),c.__previousThemes=b.merge([],c.__options.theme),c},__scrollHandler:function(c){if(this.__options.triggerClose.scroll)this._close(c);
else{if(c.target===m.window.document)this.__Geometry.origin.fixedLineage||this.__options.repositionOnScroll&&this.reposition(c);else{var e=this.__geometry(),f=!1;("fixed"!=this._$origin.css("position")&&this.__$originParents.each(function(c,h){var g=b(h),n=g.css("overflow-x"),q=g.css("overflow-y");if("visible"!=n||"visible"!=q){var k=h.getBoundingClientRect();if("visible"!=n&&(e.origin.windowOffset.left<k.left||e.origin.windowOffset.right>k.right)||"visible"!=q&&(e.origin.windowOffset.top<k.top||
e.origin.windowOffset.bottom>k.bottom))return f=!0,!1}return"fixed"==g.css("position")?!1:void 0}),f)?this._$tooltip.css("visibility","hidden"):(this._$tooltip.css("visibility","visible"),this.__options.repositionOnScroll)?this.reposition(c):this._$tooltip.css({left:this.__lastPosition.coord.left+(e.origin.offset.left-this.__Geometry.origin.offset.left),top:this.__lastPosition.coord.top+(e.origin.offset.top-this.__Geometry.origin.offset.top)})}this._trigger({type:"scroll",event:c})}return this},__stateSet:function(b){return this.__state=
b,this._trigger({type:"state",state:b}),this},__timeoutsClear:function(){return clearTimeout(this.__timeouts.open),this.__timeouts.open=null,b.each(this.__timeouts.close,function(b,c){clearTimeout(c)}),this.__timeouts.close=[],this},__trackerStart:function(){var b=this,e=b._$tooltip.find(".tooltipster-content");return b.__options.trackTooltip&&(b.__contentBcr=e[0].getBoundingClientRect()),b.__tracker=setInterval(function(){if(f(b._$origin)&&f(b._$tooltip)){if(b.__options.trackOrigin){var h=b.__geometry(),
g=!1;c(h.origin.size,b.__Geometry.origin.size)&&(b.__Geometry.origin.fixedLineage?c(h.origin.windowOffset,b.__Geometry.origin.windowOffset)&&(g=!0):c(h.origin.offset,b.__Geometry.origin.offset)&&(g=!0));g||(b.__options.triggerClose.mouseleave?b._close():b.reposition())}b.__options.trackTooltip&&(h=e[0].getBoundingClientRect(),h.height===b.__contentBcr.height&&h.width===b.__contentBcr.width||(b.reposition(),b.__contentBcr=h))}else b._close()},b.__options.trackerInterval),b},_close:function(c,e){var f=
this,g=!0;if(f._trigger({type:"close",event:c,stop:function(){g=!1}}),g||f.__destroying){e&&f.__callbacks.close.push(e);f.__callbacks.open=[];f.__timeoutsClear();var n=function(){b.each(f.__callbacks.close,function(b,e){e.call(f,f,{event:c,origin:f._$origin[0]})});f.__callbacks.close=[]};if("closed"!=f.__state){var k=!0,q=(new Date).getTime()+f.__options.animationDuration[1];if("disappearing"==f.__state&&q>f.__closingTime&&(k=!1),k)f.__closingTime=q,"disappearing"!=f.__state&&f.__stateSet("disappearing"),
k=function(){clearInterval(f.__tracker);f._trigger({type:"closing",event:c});f._$tooltip.off("."+f.__namespace+"-triggerClose").removeClass("tooltipster-dying");b(m.window).off("."+f.__namespace+"-triggerClose");f.__$originParents.each(function(c,e){b(e).off("scroll."+f.__namespace+"-triggerClose")});f.__$originParents=null;b("body").off("."+f.__namespace+"-triggerClose");f._$origin.off("."+f.__namespace+"-triggerClose");f._off("dismissable");f.__stateSet("closed");f._trigger({type:"after",event:c});
f.__options.functionAfter&&f.__options.functionAfter.call(f,f,{event:c,origin:f._$origin[0]});n()},m.hasTransitions?(f._$tooltip.css({"-moz-animation-duration":f.__options.animationDuration[1]+"ms","-ms-animation-duration":f.__options.animationDuration[1]+"ms","-o-animation-duration":f.__options.animationDuration[1]+"ms","-webkit-animation-duration":f.__options.animationDuration[1]+"ms","animation-duration":f.__options.animationDuration[1]+"ms","transition-duration":f.__options.animationDuration[1]+
"ms"}),f._$tooltip.clearQueue().removeClass("tooltipster-show").addClass("tooltipster-dying"),0<f.__options.animationDuration[1]&&f._$tooltip.delay(f.__options.animationDuration[1]),f._$tooltip.queue(k)):f._$tooltip.stop().fadeOut(f.__options.animationDuration[1],k)}else n()}return f},_off:function(){return this.__$emitterPrivate.off.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),this},_on:function(){return this.__$emitterPrivate.on.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),
this},_one:function(){return this.__$emitterPrivate.one.apply(this.__$emitterPrivate,Array.prototype.slice.apply(arguments)),this},_open:function(c,e){var h=this;if(!h.__destroying&&f(h._$origin)&&h.__enabled){var g=!0;if("closed"==h.__state&&(h._trigger({type:"before",event:c,stop:function(){g=!1}}),g&&h.__options.functionBefore&&(g=h.__options.functionBefore.call(h,h,{event:c,origin:h._$origin[0]}))),!1!==g&&null!==h.__Content){e&&h.__callbacks.open.push(e);h.__callbacks.close=[];h.__timeoutsClear();
var n,k=function(){"stable"!=h.__state&&h.__stateSet("stable");b.each(h.__callbacks.open,function(b,c){c.call(h,h,{origin:h._$origin[0],tooltip:h._$tooltip[0]})});h.__callbacks.open=[]};if("closed"!==h.__state)n=0,"disappearing"===h.__state?(h.__stateSet("appearing"),m.hasTransitions?(h._$tooltip.clearQueue().removeClass("tooltipster-dying").addClass("tooltipster-show"),0<h.__options.animationDuration[0]&&h._$tooltip.delay(h.__options.animationDuration[0]),h._$tooltip.queue(k)):h._$tooltip.stop().fadeIn(k)):
"stable"==h.__state&&k();else{if(h.__stateSet("appearing"),n=h.__options.animationDuration[0],h.__contentInsert(),h.reposition(c,!0),m.hasTransitions?(h._$tooltip.addClass("tooltipster-"+h.__options.animation).addClass("tooltipster-initial").css({"-moz-animation-duration":h.__options.animationDuration[0]+"ms","-ms-animation-duration":h.__options.animationDuration[0]+"ms","-o-animation-duration":h.__options.animationDuration[0]+"ms","-webkit-animation-duration":h.__options.animationDuration[0]+"ms",
"animation-duration":h.__options.animationDuration[0]+"ms","transition-duration":h.__options.animationDuration[0]+"ms"}),setTimeout(function(){"closed"!=h.__state&&(h._$tooltip.addClass("tooltipster-show").removeClass("tooltipster-initial"),0<h.__options.animationDuration[0]&&h._$tooltip.delay(h.__options.animationDuration[0]),h._$tooltip.queue(k))},0)):h._$tooltip.css("display","none").fadeIn(h.__options.animationDuration[0],k),h.__trackerStart(),b(m.window).on("resize."+h.__namespace+"-triggerClose",
function(c){var e=b(document.activeElement);(e.is("input")||e.is("textarea"))&&b.contains(h._$tooltip[0],e[0])||h.reposition(c)}).on("scroll."+h.__namespace+"-triggerClose",function(b){h.__scrollHandler(b)}),h.__$originParents=h._$origin.parents(),h.__$originParents.each(function(c,e){b(e).on("scroll."+h.__namespace+"-triggerClose",function(b){h.__scrollHandler(b)})}),h.__options.triggerClose.mouseleave||h.__options.triggerClose.touchleave&&m.hasTouchCapability){h._on("dismissable",function(b){b.dismissable?
b.delay?(u=setTimeout(function(){h._close(b.event)},b.delay),h.__timeouts.close.push(u)):h._close(b):clearTimeout(u)});var q=h._$origin,p="",z="",u=null;h.__options.interactive&&(q=q.add(h._$tooltip));h.__options.triggerClose.mouseleave&&(p+="mouseenter."+h.__namespace+"-triggerClose ",z+="mouseleave."+h.__namespace+"-triggerClose ");h.__options.triggerClose.touchleave&&m.hasTouchCapability&&(p+="touchstart."+h.__namespace+"-triggerClose",z+="touchend."+h.__namespace+"-triggerClose touchcancel."+
h.__namespace+"-triggerClose");q.on(z,function(b){!h._touchIsTouchEvent(b)&&h._touchIsEmulatedEvent(b)||h._trigger({delay:("mouseleave"==b.type?h.__options.delay:h.__options.delayTouch)[1],dismissable:!0,event:b,type:"dismissable"})}).on(p,function(b){!h._touchIsTouchEvent(b)&&h._touchIsEmulatedEvent(b)||h._trigger({dismissable:!1,event:b,type:"dismissable"})})}h.__options.triggerClose.originClick&&h._$origin.on("click."+h.__namespace+"-triggerClose",function(b){h._touchIsTouchEvent(b)||h._touchIsEmulatedEvent(b)||
h._close(b)});(h.__options.triggerClose.click||h.__options.triggerClose.tap&&m.hasTouchCapability)&&setTimeout(function(){if("closed"!=h.__state){var c="";h.__options.triggerClose.click&&(c+="click."+h.__namespace+"-triggerClose ");h.__options.triggerClose.tap&&m.hasTouchCapability&&(c+="touchend."+h.__namespace+"-triggerClose");b("body").on(c,function(c){h._touchIsMeaningfulEvent(c)&&(h._touchRecordEvent(c),h.__options.interactive&&b.contains(h._$tooltip[0],c.target)||h._close(c))});h.__options.triggerClose.tap&&
m.hasTouchCapability&&b("body").on("touchstart."+h.__namespace+"-triggerClose",function(b){h._touchRecordEvent(b)})}},0);h._trigger("ready");h.__options.functionReady&&h.__options.functionReady.call(h,h,{origin:h._$origin[0],tooltip:h._$tooltip[0]})}0<h.__options.timer&&(u=setTimeout(function(){h._close()},h.__options.timer+n),h.__timeouts.close.push(u))}}return h},_openShortly:function(b){var c=this,e=!0;if("stable"!=c.__state&&"appearing"!=c.__state&&!c.__timeouts.open&&(c._trigger({type:"start",
event:b,stop:function(){e=!1}}),e)){var f=0==b.type.indexOf("touch")?c.__options.delayTouch:c.__options.delay;f[0]?c.__timeouts.open=setTimeout(function(){c.__timeouts.open=null;c.__pointerIsOverOrigin&&c._touchIsMeaningfulEvent(b)?(c._trigger("startend"),c._open(b)):c._trigger("startcancel")},f[0]):(c._trigger("startend"),c._open(b))}return c},_optionsExtract:function(c,e){var f=this,g=b.extend(!0,{},e),n=f.__options[c];return n||(n={},b.each(e,function(b,c){var e=f.__options[b];void 0!==e&&(n[b]=
e)})),b.each(g,function(c,e){void 0!==n[c]&&("object"!=typeof e||e instanceof Array||null==e||"object"!=typeof n[c]||n[c]instanceof Array||null==n[c]?g[c]=n[c]:b.extend(g[c],n[c]))}),g},_plug:function(c){var e=b.tooltipster._plugin(c);if(!e)throw Error('The "'+c+'" plugin is not defined');return e.instance&&b.tooltipster.__bridge(e.instance,this,e.name),this},_touchIsEmulatedEvent:function(b){for(var c=!1,e=(new Date).getTime(),f=this.__touchEvents.length-1;0<=f;f--){var g=this.__touchEvents[f];if(!(500>
e-g.time))break;g.target===b.target&&(c=!0)}return c},_touchIsMeaningfulEvent:function(b){return this._touchIsTouchEvent(b)&&!this._touchSwiped(b.target)||!this._touchIsTouchEvent(b)&&!this._touchIsEmulatedEvent(b)},_touchIsTouchEvent:function(b){return 0==b.type.indexOf("touch")},_touchRecordEvent:function(b){return this._touchIsTouchEvent(b)&&(b.time=(new Date).getTime(),this.__touchEvents.push(b)),this},_touchSwiped:function(b){for(var c=!1,e=this.__touchEvents.length-1;0<=e;e--){var f=this.__touchEvents[e];
if("touchmove"==f.type){c=!0;break}if("touchstart"==f.type&&b===f.target)break}return c},_trigger:function(){var c=Array.prototype.slice.apply(arguments);return"string"==typeof c[0]&&(c[0]={type:c[0]}),c[0].instance=this,c[0].origin=this._$origin?this._$origin[0]:null,c[0].tooltip=this._$tooltip?this._$tooltip[0]:null,this.__$emitterPrivate.trigger.apply(this.__$emitterPrivate,c),b.tooltipster._trigger.apply(b.tooltipster,c),this.__$emitterPublic.trigger.apply(this.__$emitterPublic,c),this},_unplug:function(c){var e=
this;if(e[c]){var f=b.tooltipster._plugin(c);f.instance&&b.each(f.instance,function(b,f){e[b]&&e[b].bridged===e[c]&&delete e[b]});e[c].__destroy&&e[c].__destroy();delete e[c]}return e},close:function(b){return this.__destroyed?this.__destroyError():this._close(null,b),this},content:function(b){var c=this;if(void 0===b)return c.__Content;if(c.__destroyed)c.__destroyError();else if(c.__contentSet(b),null!==c.__Content){if("closed"!==c.__state&&(c.__contentInsert(),c.reposition(),c.__options.updateAnimation))if(m.hasTransitions){var e=
c.__options.updateAnimation;c._$tooltip.addClass("tooltipster-update-"+e);setTimeout(function(){"closed"!=c.__state&&c._$tooltip.removeClass("tooltipster-update-"+e)},1E3)}else c._$tooltip.fadeTo(200,.5,function(){"closed"!=c.__state&&c._$tooltip.fadeTo(200,1)})}else c._close();return c},destroy:function(){var c=this;return c.__destroyed?c.__destroyError():c.__destroying||(c.__destroying=!0,c._close(null,function(){c._trigger("destroy");c.__destroying=!1;c.__destroyed=!0;c._$origin.removeData(c.__namespace).off("."+
c.__namespace+"-triggerOpen");b("body").off("."+c.__namespace+"-triggerOpen");var e=c._$origin.data("tooltipster-ns");e&&(1===e.length?(e=null,"previous"==c.__options.restoration?e=c._$origin.data("tooltipster-initialTitle"):"current"==c.__options.restoration&&(e="string"==typeof c.__Content?c.__Content:b("<div></div>").append(c.__Content).html()),e&&c._$origin.attr("title",e),c._$origin.removeClass("tooltipstered"),c._$origin.removeData("tooltipster-ns").removeData("tooltipster-initialTitle")):(e=
b.grep(e,function(b,e){return b!==c.__namespace}),c._$origin.data("tooltipster-ns",e)));c._trigger("destroyed");c._off();c.off();c.__Content=null;c.__$emitterPrivate=null;c.__$emitterPublic=null;c.__options.parent=null;c._$origin=null;c._$tooltip=null;b.tooltipster.__instancesLatestArr=b.grep(b.tooltipster.__instancesLatestArr,function(b,e){return c!==b});clearInterval(c.__garbageCollector)})),c},disable:function(){return this.__destroyed?(this.__destroyError(),this):(this._close(),this.__enabled=
!1,this)},elementOrigin:function(){return this.__destroyed?void this.__destroyError():this._$origin[0]},elementTooltip:function(){return this._$tooltip?this._$tooltip[0]:null},enable:function(){return this.__enabled=!0,this},hide:function(b){return this.close(b)},instance:function(){return this},off:function(){return this.__destroyed||this.__$emitterPublic.off.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this},on:function(){return this.__destroyed?this.__destroyError():this.__$emitterPublic.on.apply(this.__$emitterPublic,
Array.prototype.slice.apply(arguments)),this},one:function(){return this.__destroyed?this.__destroyError():this.__$emitterPublic.one.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this},open:function(b){return this.__destroyed||this.__destroying?this.__destroyError():this._open(null,b),this},option:function(c,e){return void 0===e?this.__options[c]:(this.__destroyed?this.__destroyError():(this.__options[c]=e,this.__optionsFormat(),0<=b.inArray(c,["trigger","triggerClose","triggerOpen"])&&
this.__prepareOrigin(),"selfDestruction"===c&&this.__prepareGC()),this)},reposition:function(b,c){return this.__destroyed?this.__destroyError():"closed"!=this.__state&&f(this._$origin)&&(c||f(this._$tooltip))&&(c||this._$tooltip.detach(),this.__Geometry=this.__geometry(),this._trigger({type:"reposition",event:b,helper:{geo:this.__Geometry}})),this},show:function(b){return this.open(b)},status:function(){return{destroyed:this.__destroyed,destroying:this.__destroying,enabled:this.__enabled,open:"closed"!==
this.__state,state:this.__state}},triggerHandler:function(){return this.__destroyed?this.__destroyError():this.__$emitterPublic.triggerHandler.apply(this.__$emitterPublic,Array.prototype.slice.apply(arguments)),this}};b.fn.tooltipster=function(){var c=Array.prototype.slice.apply(arguments);if(0===this.length)return this;if("string"==typeof c[0]){var e="#*$~&";return this.each(function(){var f=b(this).data("tooltipster-ns"),f=f?b(this).data(f[0]):null;if(!f)throw Error("You called Tooltipster's \""+
c[0]+'" method on an uninitialized element');if("function"!=typeof f[c[0]])throw Error('Unknown method "'+c[0]+'"');1<this.length&&"content"==c[0]&&(c[1]instanceof b||"object"==typeof c[1]&&null!=c[1]&&c[1].tagName)&&!f.__options.contentCloning&&f.__options.debug&&console.log("You are using a single HTML element as content for several tooltips. You probably want to set the contentCloning option to TRUE.");var h=f[c[0]](c[1],c[2]);return h!==f||"instance"===c[0]?(e=h,!1):void 0}),"#*$~&"!==e?e:this}b.tooltipster.__instancesLatestArr=
[];var f=c[0]&&void 0!==c[0].multiple,k=f&&c[0].multiple||!f&&g.multiple,f=(f=c[0]&&void 0!==c[0].content)&&c[0].content||!f&&g.content,m=c[0]&&void 0!==c[0].contentCloning,m=m&&c[0].contentCloning||!m&&g.contentCloning,p=c[0]&&void 0!==c[0].debug,r=p&&c[0].debug||!p&&g.debug;return 1<this.length&&(f instanceof b||"object"==typeof f&&null!=f&&f.tagName)&&!m&&r&&console.log("You are using a single HTML element as content for several tooltips. You probably want to set the contentCloning option to TRUE."),
this.each(function(){var e=!1,f=b(this),h=f.data("tooltipster-ns"),g=null;h?k?e=!0:r&&(console.log("Tooltipster: one or more tooltips are already attached to the element below. Ignoring."),console.log(this)):e=!0;e&&(g=new b.Tooltipster(this,c[0]),h||(h=[]),h.push(g.__namespace),f.data("tooltipster-ns",h),f.data(g.__namespace,g),g.__options.functionInit&&g.__options.functionInit.call(g,g,{origin:this}),g._trigger("init"));b.tooltipster.__instancesLatestArr.push(g)}),this};e.prototype={__init:function(c){this.__$tooltip=
c;this.__$tooltip.css({left:0,overflow:"hidden",position:"absolute",top:0}).find(".tooltipster-content").css("overflow","auto");this.$container=b('<div class="tooltipster-ruler"></div>').append(this.__$tooltip).appendTo("body")},__forceRedraw:function(){var b=this.__$tooltip.parent();this.__$tooltip.detach();this.__$tooltip.appendTo(b)},constrain:function(b,c){return this.constraints={width:b,height:c},this.__$tooltip.css({display:"block",height:"",overflow:"auto",width:b}),this},destroy:function(){this.__$tooltip.detach().find(".tooltipster-content").css({display:"",
overflow:""});this.$container.remove()},free:function(){return this.constraints=null,this.__$tooltip.css({display:"",height:"",overflow:"visible",width:""}),this},measure:function(){this.__forceRedraw();var b=this.__$tooltip[0].getBoundingClientRect(),c={size:{height:b.height||b.bottom,width:b.width||b.right}};if(this.constraints){var e=this.__$tooltip.find(".tooltipster-content"),f=this.__$tooltip.outerHeight(),g=e[0].getBoundingClientRect(),b=b.width<=this.constraints.width&&g.width>=e[0].scrollWidth-
1;c.fits=f<=this.constraints.height&&b}return m.IE&&11>=m.IE&&c.size.width!==m.window.document.documentElement.clientWidth&&(c.size.width=Math.ceil(c.size.width)+1),c}};p=navigator.userAgent.toLowerCase();-1!=p.indexOf("msie")?m.IE=parseInt(p.split("msie")[1]):-1!==p.toLowerCase().indexOf("trident")&&-1!==p.indexOf(" rv:11")?m.IE=11:-1!=p.toLowerCase().indexOf("edge/")&&(m.IE=parseInt(p.toLowerCase().split("edge/")[1]));return b.tooltipster._plugin({name:"tooltipster.sideTip",instance:{__defaults:function(){return{arrow:!0,
distance:6,functionPosition:null,maxWidth:null,minIntersection:16,minWidth:0,position:null,side:"top",viewportAware:!0}},__init:function(b){var c=this;c.__instance=b;c.__namespace="tooltipster-sideTip-"+Math.round(1E6*Math.random());c.__previousState="closed";c.__options;c.__optionsFormat();c.__instance._on("state."+c.__namespace,function(b){"closed"==b.state?c.__close():"appearing"==b.state&&"closed"==c.__previousState&&c.__create();c.__previousState=b.state});c.__instance._on("options."+c.__namespace,
function(){c.__optionsFormat()});c.__instance._on("reposition."+c.__namespace,function(b){c.__reposition(b.event,b.helper)})},__close:function(){this.__instance.content()instanceof b&&this.__instance.content().detach();this.__instance._$tooltip.remove();this.__instance._$tooltip=null},__create:function(){var c=b('<div class="tooltipster-base tooltipster-sidetip"><div class="tooltipster-box"><div class="tooltipster-content"></div></div><div class="tooltipster-arrow"><div class="tooltipster-arrow-uncropped"><div class="tooltipster-arrow-border"></div><div class="tooltipster-arrow-background"></div></div></div></div>');
this.__options.arrow||c.find(".tooltipster-box").css("margin",0).end().find(".tooltipster-arrow").hide();this.__options.minWidth&&c.css("min-width",this.__options.minWidth+"px");this.__options.maxWidth&&c.css("max-width",this.__options.maxWidth+"px");this.__instance._$tooltip=c;this.__instance._trigger("created")},__destroy:function(){this.__instance._off("."+self.__namespace)},__optionsFormat:function(){if(this.__options=this.__instance._optionsExtract("tooltipster.sideTip",this.__defaults()),this.__options.position&&
(this.__options.side=this.__options.position),"object"!=typeof this.__options.distance&&(this.__options.distance=[this.__options.distance]),4>this.__options.distance.length&&(void 0===this.__options.distance[1]&&(this.__options.distance[1]=this.__options.distance[0]),void 0===this.__options.distance[2]&&(this.__options.distance[2]=this.__options.distance[0]),void 0===this.__options.distance[3]&&(this.__options.distance[3]=this.__options.distance[1]),this.__options.distance={top:this.__options.distance[0],
right:this.__options.distance[1],bottom:this.__options.distance[2],left:this.__options.distance[3]}),"string"==typeof this.__options.side)this.__options.side=[this.__options.side,{top:"bottom",right:"left",bottom:"top",left:"right"}[this.__options.side]],"left"==this.__options.side[0]||"right"==this.__options.side[0]?this.__options.side.push("top","bottom"):this.__options.side.push("right","left");6===b.tooltipster._env.IE&&!0!==this.__options.arrow&&(this.__options.arrow=!1)},__reposition:function(c,
e){var f,g=this,k=g.__targetFind(e),n=[];g.__instance._$tooltip.detach();var m=g.__instance._$tooltip.clone(),p=b.tooltipster._getRuler(m),q=!1,u=g.__instance.option("animation");switch(u&&m.removeClass("tooltipster-"+u),b.each(["window","document"],function(f,h){var r=null;if(g.__instance._trigger({container:h,helper:e,satisfied:q,takeTest:function(b){r=b},results:n,type:"positionTest"}),1==r||0!=r&&0==q&&("window"!=h||g.__options.viewportAware))for(f=0;f<g.__options.side.length;f++){var t={horizontal:0,
vertical:0},A=g.__options.side[f];"top"==A||"bottom"==A?t.vertical=g.__options.distance[A]:t.horizontal=g.__options.distance[A];g.__sideChange(m,A);b.each(["natural","constrained"],function(b,f){if(r=null,g.__instance._trigger({container:h,event:c,helper:e,mode:f,results:n,satisfied:q,side:A,takeTest:function(b){r=b},type:"positionTest"}),1==r||0!=r&&0==q){var m={container:h,distance:t,fits:null,mode:f,outerSize:null,side:A,size:null,target:k[A],whole:null},v=("natural"==f?p.free():p.constrain(e.geo.available[h][A].width-
t.horizontal,e.geo.available[h][A].height-t.vertical)).measure();if(m.size=v.size,m.outerSize={height:v.size.height+t.vertical,width:v.size.width+t.horizontal},"natural"==f?e.geo.available[h][A].width>=m.outerSize.width&&e.geo.available[h][A].height>=m.outerSize.height?m.fits=!0:m.fits=!1:m.fits=v.fits,"window"==h&&(m.fits?"top"==A||"bottom"==A?m.whole=e.geo.origin.windowOffset.right>=g.__options.minIntersection&&e.geo.window.size.width-e.geo.origin.windowOffset.left>=g.__options.minIntersection:
m.whole=e.geo.origin.windowOffset.bottom>=g.__options.minIntersection&&e.geo.window.size.height-e.geo.origin.windowOffset.top>=g.__options.minIntersection:m.whole=!1),n.push(m),m.whole)q=!0;else if("natural"==m.mode&&(m.fits||m.size.width<=e.geo.available[h][A].width))return!1}})}}),g.__instance._trigger({edit:function(b){n=b},event:c,helper:e,results:n,type:"positionTested"}),n.sort(function(b,c){if(b.whole&&!c.whole)return-1;if(!b.whole&&c.whole)return 1;if(b.whole&&c.whole){var e=g.__options.side.indexOf(b.side),
f=g.__options.side.indexOf(c.side);return f>e?-1:e>f?1:"natural"==b.mode?-1:1}return b.fits&&!c.fits?-1:!b.fits&&c.fits?1:b.fits&&c.fits?(e=g.__options.side.indexOf(b.side),f=g.__options.side.indexOf(c.side),f>e?-1:e>f?1:"natural"==b.mode?-1:1):"document"==b.container&&"bottom"==b.side&&"natural"==b.mode?-1:1}),f=n[0],f.coord={},f.side){case "left":case "right":f.coord.top=Math.floor(f.target-f.size.height/2);break;case "bottom":case "top":f.coord.left=Math.floor(f.target-f.size.width/2)}switch(f.side){case "left":f.coord.left=
e.geo.origin.windowOffset.left-f.outerSize.width;break;case "right":f.coord.left=e.geo.origin.windowOffset.right+f.distance.horizontal;break;case "top":f.coord.top=e.geo.origin.windowOffset.top-f.outerSize.height;break;case "bottom":f.coord.top=e.geo.origin.windowOffset.bottom+f.distance.vertical}"window"==f.container?"top"==f.side||"bottom"==f.side?0>f.coord.left?0<=e.geo.origin.windowOffset.right-this.__options.minIntersection?f.coord.left=0:f.coord.left=e.geo.origin.windowOffset.right-this.__options.minIntersection-
1:f.coord.left>e.geo.window.size.width-f.size.width&&(e.geo.origin.windowOffset.left+this.__options.minIntersection<=e.geo.window.size.width?f.coord.left=e.geo.window.size.width-f.size.width:f.coord.left=e.geo.origin.windowOffset.left+this.__options.minIntersection+1-f.size.width):0>f.coord.top?0<=e.geo.origin.windowOffset.bottom-this.__options.minIntersection?f.coord.top=0:f.coord.top=e.geo.origin.windowOffset.bottom-this.__options.minIntersection-1:f.coord.top>e.geo.window.size.height-f.size.height&&
(e.geo.origin.windowOffset.top+this.__options.minIntersection<=e.geo.window.size.height?f.coord.top=e.geo.window.size.height-f.size.height:f.coord.top=e.geo.origin.windowOffset.top+this.__options.minIntersection+1-f.size.height):(f.coord.left>e.geo.window.size.width-f.size.width&&(f.coord.left=e.geo.window.size.width-f.size.width),0>f.coord.left&&(f.coord.left=0));g.__sideChange(m,f.side);e.tooltipClone=m[0];e.tooltipParent=g.__instance.option("parent").parent[0];e.mode=f.mode;e.whole=f.whole;e.origin=
g.__instance._$origin[0];e.tooltip=g.__instance._$tooltip[0];delete f.container;delete f.fits;delete f.mode;delete f.outerSize;delete f.whole;f.distance=f.distance.horizontal||f.distance.vertical;u=b.extend(!0,{},f);(g.__instance._trigger({edit:function(b){f=b},event:c,helper:e,position:u,type:"position"}),g.__options.functionPosition)&&(u=g.__options.functionPosition.call(g,g.__instance,e,u))&&(f=u);p.destroy();var w,B;"top"==f.side||"bottom"==f.side?(w={prop:"left",val:f.target-f.coord.left},B=
f.size.width-this.__options.minIntersection):(w={prop:"top",val:f.target-f.coord.top},B=f.size.height-this.__options.minIntersection);w.val<this.__options.minIntersection?w.val=this.__options.minIntersection:w.val>B&&(w.val=B);B=e.geo.origin.fixedLineage?e.geo.origin.windowOffset:{left:e.geo.origin.windowOffset.left+e.geo.window.scroll.left,top:e.geo.origin.windowOffset.top+e.geo.window.scroll.top};f.coord={left:B.left+(f.coord.left-e.geo.origin.windowOffset.left),top:B.top+(f.coord.top-e.geo.origin.windowOffset.top)};
g.__sideChange(g.__instance._$tooltip,f.side);e.geo.origin.fixedLineage?g.__instance._$tooltip.css("position","fixed"):g.__instance._$tooltip.css("position","");g.__instance._$tooltip.css({left:f.coord.left,top:f.coord.top,height:f.size.height,width:f.size.width}).find(".tooltipster-arrow").css({left:"",top:""}).css(w.prop,w.val);g.__instance._$tooltip.appendTo(g.__instance.option("parent"));g.__instance._trigger({type:"repositioned",event:c,position:f})},__sideChange:function(b,c){b.removeClass("tooltipster-bottom").removeClass("tooltipster-left").removeClass("tooltipster-right").removeClass("tooltipster-top").addClass("tooltipster-"+
c)},__targetFind:function(b){var c={},e=this.__instance._$origin[0].getClientRects();1<e.length&&1==this.__instance._$origin.css("opacity")&&(this.__instance._$origin.css("opacity",.99),e=this.__instance._$origin[0].getClientRects(),this.__instance._$origin.css("opacity",1));2>e.length?(c.top=Math.floor(b.geo.origin.windowOffset.left+b.geo.origin.size.width/2),c.bottom=c.top,c.left=Math.floor(b.geo.origin.windowOffset.top+b.geo.origin.size.height/2),c.right=c.left):(b=e[0],c.top=Math.floor(b.left+
(b.right-b.left)/2),b=2<e.length?e[Math.ceil(e.length/2)-1]:e[0],c.right=Math.floor(b.top+(b.bottom-b.top)/2),b=e[e.length-1],c.bottom=Math.floor(b.left+(b.right-b.left)/2),b=2<e.length?e[Math.ceil((e.length+1)/2)-1]:e[e.length-1],c.left=Math.floor(b.top+(b.bottom-b.top)/2));return c}}}),b});void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});
var TWEEN=TWEEN||function(){var b=[];return{REVISION:"14",getAll:function(){return b},removeAll:function(){b=[]},add:function(e){b.push(e)},remove:function(e){e=b.indexOf(e);-1!==e&&b.splice(e,1)},update:function(e){if(0===b.length)return!1;var c=0;for(e=void 0!==e?e:"undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();c<b.length;)b[c].update(e)?c++:b.splice(c,1);return!0}}}();
TWEEN.Tween=function(b){var e={},c={},f={},g=1E3,k=0,m=!1,p=!1,n=0,q=null,h=TWEEN.Easing.Linear.None,v=TWEEN.Interpolation.Linear,y=[],C=null,r=!1,t=null,z=null,u=null,w;for(w in b)e[w]=parseFloat(b[w],10);this.to=function(b,e){void 0!==e&&(g=e);c=b;return this};this.start=function(g){TWEEN.add(this);p=!0;r=!1;q=void 0!==g?g:"undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();q+=n;for(var h in c){if(c[h]instanceof Array){if(0===
c[h].length)continue;c[h]=[b[h]].concat(c[h])}e[h]=b[h];!1===e[h]instanceof Array&&(e[h]*=1);f[h]=e[h]||0}return this};this.stop=function(){if(!p)return this;TWEEN.remove(this);p=!1;null!==u&&u.call(b);this.stopChainedTweens();return this};this.stopChainedTweens=function(){for(var b=0,c=y.length;b<c;b++)y[b].stop()};this.delay=function(b){n=b;return this};this.repeat=function(b){k=b;return this};this.yoyo=function(b){m=b;return this};this.easing=function(b){h=b;return this};this.interpolation=function(b){v=
b;return this};this.chain=function(){y=arguments;return this};this.onStart=function(b){C=b;return this};this.onUpdate=function(b){t=b;return this};this.onComplete=function(b){z=b;return this};this.onStop=function(b){u=b;return this};this.update=function(p){var u;if(p<q)return!0;!1===r&&(null!==C&&C.call(b),r=!0);var w=(p-q)/g,w=1<w?1:w,B=h(w);for(u in c){var G=e[u]||0,E=c[u];E instanceof Array?b[u]=v(E,B):("string"===typeof E&&(E=G+parseFloat(E,10)),"number"===typeof E&&(b[u]=G+(E-G)*B))}null!==t&&
t.call(b,B);if(1==w)if(0<k){isFinite(k)&&k--;for(u in f)"string"===typeof c[u]&&(f[u]+=parseFloat(c[u],10)),m&&(w=f[u],f[u]=c[u],c[u]=w),e[u]=f[u];q=p+n}else{null!==z&&z.call(b);u=0;for(w=y.length;u<w;u++)y[u].start(p);return!1}return!0}};
TWEEN.Easing={Linear:{None:function(b){return b}},Quadratic:{In:function(b){return b*b},Out:function(b){return b*(2-b)},InOut:function(b){return 1>(b*=2)?.5*b*b:-.5*(--b*(b-2)-1)}},Cubic:{In:function(b){return b*b*b},Out:function(b){return--b*b*b+1},InOut:function(b){return 1>(b*=2)?.5*b*b*b:.5*((b-=2)*b*b+2)}},Quartic:{In:function(b){return b*b*b*b},Out:function(b){return 1- --b*b*b*b},InOut:function(b){return 1>(b*=2)?.5*b*b*b*b:-.5*((b-=2)*b*b*b-2)}},Quintic:{In:function(b){return b*b*b*b*b},Out:function(b){return--b*
b*b*b*b+1},InOut:function(b){return 1>(b*=2)?.5*b*b*b*b*b:.5*((b-=2)*b*b*b*b+2)}},Sinusoidal:{In:function(b){return 1-Math.cos(b*Math.PI/2)},Out:function(b){return Math.sin(b*Math.PI/2)},InOut:function(b){return.5*(1-Math.cos(Math.PI*b))}},Exponential:{In:function(b){return 0===b?0:Math.pow(1024,b-1)},Out:function(b){return 1===b?1:1-Math.pow(2,-10*b)},InOut:function(b){return 0===b?0:1===b?1:1>(b*=2)?.5*Math.pow(1024,b-1):.5*(-Math.pow(2,-10*(b-1))+2)}},Circular:{In:function(b){return 1-Math.sqrt(1-
b*b)},Out:function(b){return Math.sqrt(1- --b*b)},InOut:function(b){return 1>(b*=2)?-.5*(Math.sqrt(1-b*b)-1):.5*(Math.sqrt(1-(b-=2)*b)+1)}},Elastic:{In:function(b){var e,c=.1;if(0===b)return 0;if(1===b)return 1;!c||1>c?(c=1,e=.1):e=.4*Math.asin(1/c)/(2*Math.PI);return-(c*Math.pow(2,10*--b)*Math.sin(2*(b-e)*Math.PI/.4))},Out:function(b){var e,c=.1;if(0===b)return 0;if(1===b)return 1;!c||1>c?(c=1,e=.1):e=.4*Math.asin(1/c)/(2*Math.PI);return c*Math.pow(2,-10*b)*Math.sin(2*(b-e)*Math.PI/.4)+1},InOut:function(b){var e,
c=.1;if(0===b)return 0;if(1===b)return 1;!c||1>c?(c=1,e=.1):e=.4*Math.asin(1/c)/(2*Math.PI);return 1>(b*=2)?-.5*c*Math.pow(2,10*--b)*Math.sin(2*(b-e)*Math.PI/.4):.5*c*Math.pow(2,-10*--b)*Math.sin(2*(b-e)*Math.PI/.4)+1}},Back:{In:function(b){return b*b*(2.70158*b-1.70158)},Out:function(b){return--b*b*(2.70158*b+1.70158)+1},InOut:function(b){return 1>(b*=2)?.5*b*b*(3.5949095*b-2.5949095):.5*((b-=2)*b*(3.5949095*b+2.5949095)+2)}},Bounce:{In:function(b){return 1-TWEEN.Easing.Bounce.Out(1-b)},Out:function(b){return b<
1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+.9375:7.5625*(b-=2.625/2.75)*b+.984375},InOut:function(b){return.5>b?.5*TWEEN.Easing.Bounce.In(2*b):.5*TWEEN.Easing.Bounce.Out(2*b-1)+.5}}};
TWEEN.Interpolation={Linear:function(b,e){var c=b.length-1,f=c*e,g=Math.floor(f),k=TWEEN.Interpolation.Utils.Linear;return 0>e?k(b[0],b[1],f):1<e?k(b[c],b[c-1],c-f):k(b[g],b[g+1>c?c:g+1],f-g)},Bezier:function(b,e){var c=0,f=b.length-1,g=Math.pow,k=TWEEN.Interpolation.Utils.Bernstein,m;for(m=0;m<=f;m++)c+=g(1-e,f-m)*g(e,m)*b[m]*k(f,m);return c},CatmullRom:function(b,e){var c=b.length-1,f=c*e,g=Math.floor(f),k=TWEEN.Interpolation.Utils.CatmullRom;return b[0]===b[c]?(0>e&&(g=Math.floor(f=c*(1+e))),k(b[(g-
1+c)%c],b[g],b[(g+1)%c],b[(g+2)%c],f-g)):0>e?b[0]-(k(b[0],b[0],b[1],b[1],-f)-b[0]):1<e?b[c]-(k(b[c],b[c],b[c-1],b[c-1],f-c)-b[c]):k(b[g?g-1:0],b[g],b[c<g+1?c:g+1],b[c<g+2?c:g+2],f-g)},Utils:{Linear:function(b,e,c){return(e-b)*c+b},Bernstein:function(b,e){var c=TWEEN.Interpolation.Utils.Factorial;return c(b)/c(e)/c(b-e)},Factorial:function(){var b=[1];return function(e){var c=1,f;if(b[e])return b[e];for(f=e;1<f;f--)c*=f;return b[e]=c}}(),CatmullRom:function(b,e,c,f,g){b=.5*(c-b);f=.5*(f-e);var k=g*
g;return(2*e-2*c+b+f)*g*k+(-3*e+3*c-2*b-f)*k+b*g+e}}};eval(function(b,e,c,f,g,k){g=function(b){return b};if(!"".replace(/^/,String)){for(;c--;)k[c]=f[c]||c;f=[function(b){return k[b]}];g=function(){return"\\w+"};c=1}for(;c--;)f[c]&&(b=b.replace(new RegExp("\\b"+g(c)+"\\b","g"),f[c]));return b}('9 8={"7":6,"5":"4 3 2","1":"0"};',10,10,"Desktop form_factor browser web generic complete_device_name false is_mobile WURFL var".split(" "),0,{}));engineGUI=window.engineGUI||{};
$(document).ready(function(){var b=45*Math.PI/180,e=$("#WebGLInteractiveMenu").width()/2,c="Move Horizontaly;Info;Duplicate;Resize;Textures;Rotate;Remove;Object Notes".split(";"),f="enableTransformControls('translate')   enableTransformControls('scale') toggleTextureSelect() enableTransformControls('rotate') scene3DObjectSelectRemove() camera3DNoteAdd()".split(" "),g=$("<div class='rect'></div>").hide().appendTo("body"),k=$(".rect").width()/2;g.remove();for(g=0;8>g;g++){var m=g+1;$("#WebGLInteractiveMenu").append('<div class="rect tooltip-top" title="'+
c[g]+'" id="icn'+m+'" onclick="'+f[g]+'"></div>');var p=e*Math.cos(b*g-Math.PI/2)+e-k,n=e*Math.sin(-b*g+Math.PI/2)+e-k;$("#icn"+m).css({"background-image":'url("images/hicn'+m+'.png")',"-webkit-animation-delay":"2s","animation-delay":"2s"});$("#icn"+m).animate({left:p,bottom:n},"slow")}$("#icn1").addClass("active");$(".rect").click(function(b){b.preventDefault();$(".active").removeClass("active");$(this).addClass("active");$(this).attr("id").substr(3)});$(".tooltip-share-menu").tooltipster({interactive:!0,
content:$('<a href="#" onclick="" class="hi-icon icon-html tooltip" title="Embed 3D Scene in Your Website" style="color:white"></a><br/><a href="#" class="hi-icon icon-print" style="color:white"></a><br/><a href="#" class="hi-icon icon-email" style="color:white"></a>')});$(".tooltip-save-menu").tooltipster({interactive:!0,content:$('<a href="#openLogin" onclick="engineGUI.save(true);" class="hi-icon icon-earth" style="color:white"></a><br/><a href="#openSaving" onclick="engineGUI.save(false);" class="hi-icon icon-usb" style="color:white"></a>')});
$(".tooltip-open-menu").tooltipster({interactive:!0,content:$('<a href="#openLogin" onclick="engineGUI.save(true);" class="hi-icon icon-earth" style="color:white"></a><br/><a href="#openSaving" onclick="fileSelect(\'opendesign\')" class="hi-icon icon-usb" style="color:white"></a>')});$(".tooltip-tools-menu").tooltipster({interactive:!0,content:$('<a href="#" onclick="makeScreenshot()" class="hi-icon icon-screenshot" style="color:white"></a><br/><a href="#" onclick="screenfull.request(document.documentElement)" class="hi-icon icon-expand" style="color:white"></a>')});
$(".tooltip").tooltipster({animation:"fade",delay:200,theme:"tooltipster-default",touchDevices:!1,trigger:"hover",position:"bottom",contentAsHTML:!0});$("#menu2DTools").tooltipster({theme:"tooltipster-light",trigger:"custom",touchDevices:!0,interactive:!0,contentAsHTML:!0,content:""});$("#WebGLSelectMenu").tooltipster({theme:"tooltipster-light",trigger:"custom",touchDevices:!0,delay:0,interactive:!0,position:"top",contentAsHTML:!0,content:""});$(".tooltip-right").tooltipster({animation:"fade",delay:200,
theme:"tooltipster-default",touchDevices:!1,trigger:"hover",position:"right"});$(".tooltip-top").tooltipster({animation:"fade",delay:200,theme:"tooltipster-default",touchDevices:!1,trigger:"hover",position:"top",contentAsHTML:!0});$(".cssmenu ul ul li:odd").addClass("odd");$(".cssmenu ul ul li:even").addClass("even");$(".cssmenu > ul > li > a").click(function(b){menuItemClick(this)});$("#menuTop p").click(function(){$(this).hide().after('<input type="text" class="editP" value="'+$(this).html()+'" size="10" />');
$(".editP").focus()});$(".editP").bind("blur",function(){$(this).hide().prev("#menuTop p").html($(this).val()).show()});stroll.bind(".cssmenu ul");$("#pxs_container").parallaxSlider()});function sceneMapBox(){}
engineGUI.open=function(b){var e=new JSZip;document.body.appendChild(spinner);document.getElementById("start").getElementsByClassName("close")[0].setAttribute("href","#close");$.ajax("scenes/"+SCENEFILE,{contentType:"application/zip",beforeSend:function(b){b.overrideMimeType("text/plain; charset=x-user-defined")},success:function(c){try{2==b?(engine3D.buildPanorama(skyFloorMesh,"0000",75,75,75,"",null),engine3D.setLights(),scene3D.remove(skyMesh),scene3D.remove(weatherSkyCloudsMesh),scene3D.remove(weatherSkyRainbowMesh),
scene3D.remove(scene3DHouseGroundContainer),scene3D.add(skyFloorMesh),scene3D.add(scene3DFloorGroundContainer)):3==b&&engine2D.show(),setTimeout(function(){camera3DAnimate(0,20,0,1500)},500),setTimeout(function(){engine3D["new"]();engine2D["new"]();e.loadAsync(c).then(function(c){c.file("options.json").async("string").then(function(b){b=JSON.parse(b);settings=b.settings;for(var c=0;c<b.floor.length;c++)scene3DFloorFurnitureContainer[c].name=b.floor[c].name});engine2D.open(c);engine3D.open(c);setTimeout(function(){document.body.removeChild(spinner);
1==b?engine3D.showHouse():2==b?engine3D.showFloor():3==b&&engine2D.show();setTimeout(function(){scene3DAnimateRotate=settings.autorotate},4E3)},1E3)})},2E3)}catch(f){alertify.alert("Failed to open Scene "+f)}}})};
engineGUI.save=function(b){setTimeout(function(){var e=new JSZip;e.file("scene3DTerrain.json",JSON.stringify(engine3D.collectArrayFromContainer(scene3DHouseGroundContainer)));var c={};c.settings=settings;c.floors=[];for(var f=0;f<scene3DFloorFurnitureContainer.length;f++)c.floors.push(JSON.stringify('"name":"'+scene3DFloorFurnitureContainer[f].name+'"'));e.file("options.json",JSON.stringify(c));e.file("scene3DRoofContainer.json",JSON.stringify(engine3D.collectArrayFromContainer(scene3DRoofContainer)));
e.file("scene3DHouseContainer.json",JSON.stringify(engine3D.collectArrayFromContainer(scene3DHouseContainer)));for(var c=[],g=[],f=0;f<scene2DWallMesh.length;f++)c.push(engine3D.collectArrayFromContainer(scene3DFloorFurnitureContainer[f])),g.push(engine2D.collectArrayFromContainer(f));e.file("scene3DFloorContainer.json",JSON.stringify(c));e.file("scene2DFloorContainer.json",JSON.stringify(g));try{e.file("house.jpg",imageBase64("imgHouse"),{base64:!0})}catch(k){}b||(e.file("readme.txt","Saved by WebGL HousePlanner."),
e.folder("obj"),e.folder("obj/Textures"));e=e.generate({type:"blob"});b?""===SESSION?window.location="#openLogin":(f=new FormData,f.append("file",e),$.ajax("php/objects.php?upload=scene",{type:"POST",contentType:"application/octet-stream",processData:!1,data:f,success:function(b,c){"error"!=b.status&&alert("ok")},error:function(){alert("not so ok")}}),window.location="#close"):(saveAs(e,"scene.zip"),window.location="#close")},4E3)};
function getCookie(b){b=("; "+document.cookie).split("; "+b+"=");if(2==b.length)return b.pop().split(";").shift()}function createCookie(b,e,c){if(c){var f=new Date;f.setTime(f.getTime()+864E5*c);c="; expires="+f.toGMTString()}else c="";document.cookie=b+"="+e+c+"; path=/"};engine3D=window.engine3D||{};engine2D=window.engine2D||{};engine3D.freeMemory=function(){if(scene3D instanceof THREE.Scene){for(;0<scene3D.children.length;){var b=scene3D.children[scene3D.children.length-1];b.geometry&&b.geometry.dispose();b.material&&(b.material.map&&b.material.map.dispose(),b.material.dispose());scene3D.remove(b)}scene3DObjectUnselect()}if(camera3DQuad[0]instanceof THREE.OrthographicCamera)for(i=0;4>i;i++)camera3DQuad[i]=null,rendererQuad[i]=null};
engine2D.freeMemory=function(){for(var b=paper.project.activeLayer.children,e=0;e<b.length;e++)b[e].remove()};engineGUI=window.engineGUI||{};engineGUI.initMenu=function(b,e){e="database"==RUNMODE?"php/objects.php?menu="+e.split("/").shift():"objects/"+e;$.ajax(e,{dataType:"json",success:function(c){var e=$("#"+b+" .scroll");e.empty();$.each(c.menu,function(){e.append(getMenuItem(this))});$("#"+b+" .cssmenu > ul > li > a").click(function(b){menuItemClick(this)})},error:function(b,f,g){alertify.alert("Menu ("+e+") Loading Error")}});correctMenuHeight();$("#"+b).show()};
engineGUI.menuSelect=function(b,e,c){if(null===b)for(b=0;6>=b;b++)$("#"+e+b).css("color","black");else engineGUI.menuSelect(null,e,c),$("#"+e+b).css("color",c)};
function showRightObjectMenu(b){b="database"==RUNMODE?"php/objects.php?objects="+b:"objects/"+b+"/index.json";var e=$("#menuRightObjects .scroll");$("#menuRight3DHouse").hide();$("#menuRight3DFloor").hide();$("#menuRight3DRoof").hide();$("#menuRight2D").hide();$("#menuRightObjects").show();$.ajax(b,{dataType:"json",success:function(b){e.empty();try{$.each(b.menu,function(){0<Object.keys(b.menu).length?getMenuObjectItem(e,this):e.append("<li><span style='margin-let:auto;text-align:center;padding:20px'>No Objects In This Category</span></li>")})}catch(f){e.append("<li><span style='margin-let:auto;text-align:center;padding:20px'>No Objects In This Category</span></li>")}}})}
function showRightCatalogMenu(){"house"==SCENE?$("#menuRight3DHouse").show():"floor"==SCENE&&$("#menuRight3DFloor").show();$("#menuRightObjects").hide();$("#menuRightObjects .scroll").empty()}function toggleSideMenus(b){toggleRight("menuRight",b);"house"==SCENE?toggleLeft("menuLeft3DHouse",b):"floor"==SCENE&&toggleLeft("menuLeft3DFloor",b)}
function toggleRight(b,e){var c=document.getElementById(b),f=document.getElementById("arrow-right");c.getAttribute("class");0<=f.src.indexOf("images/arrowleft.png")||e?(c.style.display="block",c.setAttribute("class","show-right"),engineGUI.menuDelay(f,"images/arrowright.png",400)):e||(c.setAttribute("class","hide-right"),engineGUI.menuDelay(f,"images/arrowleft.png",400))}
function toggleLeft(b,e){var c=document.getElementById(b),f=document.getElementById("arrow-left");c.getAttribute("class");0<=f.src.indexOf("images/arrowright.png")||e?(c.style.display="block",c.setAttribute("class",b+"-show-left"),engineGUI.menuDelay(f,"images/arrowleft.png",400)):e||(c.setAttribute("class","hide-left"),engineGUI.menuDelay(f,"images/arrowright.png",400))}engineGUI.menuDelay=function(b,e,c){window.setTimeout(function(){b.setAttribute("src",e)},c)};
function menuItemClick(b){$(".cssmenu > ul > li").removeClass("active");$(b).closest("li").addClass("active");var e=$(b).next();e.is("ul")&&e.is(":visible")&&($(b).closest("li").removeClass("active"),e.slideUp("normal"));e.is("ul")&&!e.is(":visible")&&($(".cssmenu ul ul:visible").slideUp("normal"),e.slideDown("normal"));return 0==$(b).closest("li").find("ul").children().length?!0:!1}
function getMenuItem(b,e){var c="<li";b.sub?c+=" class='has-sub'":e&&(c+=" class='last-child'");var f="<a",f=null!=b.link?f+(" href=\"javascript:showRightObjectMenu('"+b.link+"');\""):f+' href="#"',f=f+(">"+b.name+"</a>"),c=$(c+">").append(f);if(b.sub){var g=$("<ul>");$.each(b.sub,function(c){c==b.sub.length-1?g.append(getMenuItem(this,!0)):g.append(getMenuItem(this,!1))});c.append(g)}return c}
function getMenuObjectItem(b,e){var c=$("<img>",{id:e.name,src:"images/loader.gif",href:"#","data-src":e.image,"data-src-retina":e.image.slice(0,-4)+"@2x."+e.image.split(".").pop(),style:"opacity: 0;transition: opacity .3s ease-in;height:100%"}),f=$("<a>",{href:"javascript:insertSceneObject('"+e.file+"')"}).append(c),f=$("<li style='border:1px solid #aaa;text-align:center'>").append($("<div style='background-color:#fff;height:120px'>").append(f).append("<span class='objectItemInfo' style='height:40px'>"));
b.append(f);$(c).unveil(200,function(){$(this).load(function(){this.style.opacity=1})})}
function correctMenuHeight(){var b=window.innerHeight-250,e;if("house"==SCENE)$("#menuRight3DHouse .cssmenu").height(),e=$("#menuRight2D .cssmenu");else if("floor"==SCENE)$("#menuRight3DFloor .cssmenu").height(),e=$("#menuRight2D .cssmenu");else if("roof"==SCENE)$("#menuRight3DRoof .cssmenu").height(),e=$("#menuRight2D .cssmenu");else if("2d"==SCENE)$("#menuRight2D .cssmenu").height(),e=$("#menuRight2D .cssmenu");else return;$("#menuRightObjects .scroll").css("height",b);e.height()<b?e.css("height",
"100%"):e.css("height",b)}function selectMeasurement(){REALSIZERATIO=1.8311874==REALSIZERATIO?1:1.8311874};(function(b){b.fn.parallaxSlider=function(k){var m=b.extend({},b.fn.parallaxSlider.defaults,k);return this.each(function(){var k=b(this),n=b.meta?b.extend({},m,k.data()):m,q=b(".pxs_slider",k),h=q.children(),v=h.length,y=b(".pxs_next",k),C=b(".pxs_prev",k),r=b(".pxs_bg1",k),t=b(".pxs_bg2",k),z=b(".pxs_bg3",k),u=0,w=b(".pxs_thumbnails",k),B=w.children(),A,D=b(".pxs_loading",k),F=b(".pxs_slider_wrapper",k),G=0;F.find("img").each(function(){var k=b(this);b("<img/>").on("load",function(){++G;if(G==2*
v){D.hide();F.show();var k=q.find("img:first").width();g(q,h,v,r,t,z,k,y,C);w.css({width:k+"px","margin-left":-k/2+"px"});var m=k/(v+1);B.each(function(c){var e=b(this);c=m*(c+1)-e.width()/2;e.css("left",c+"px");n.thumbRotation&&(c=Math.floor(41*Math.random())-20,e.css({"-moz-transform":"rotate("+c+"deg)","-webkit-transform":"rotate("+c+"deg)",transform:"rotate("+c+"deg)"}));e.bind("mouseenter",function(){b(this).stop().animate({top:"-10px"},100)}).bind("mouseleave",function(){b(this).stop().animate({top:"0px"},
100)})});f(B.eq(0));y.bind("click",function(){++u;if(u>=v)if(n.circular)u=0;else return--u,!1;f(B.eq(u));c(u,q,z,t,r,n.speed,n.easing,n.easingBg)});C.bind("click",function(){--u;if(0>u)if(n.circular)u=v-1;else return++u,!1;f(B.eq(u));c(u,q,z,t,r,n.speed,n.easing,n.easingBg)});B.bind("click",function(){var e=b(this);f(e);n.auto&&clearInterval(A);u=e.index();c(u,q,z,t,r,n.speed,n.easing,n.easingBg)});0!=n.auto&&(n.circular=!0,A=setInterval(function(){y.trigger("click")},n.auto));b(window).resize(function(){e=
b(window).width();g(q,h,v,r,t,z,k,y,C);c(u,q,z,t,r,1,n.easing,n.easingBg)})}}).attr("src",k.attr("src"))})})};var e=b(window).width(),c=function(b,c,f,g,q,h,v,y){b=parseInt(-e*b);c.stop().animate({left:b+"px"},h,v);f.stop().animate({left:b/2+"px"},h,y);g.stop().animate({left:b/4+"px"},h,y);q.stop().animate({left:b/8+"px"},h,y)},f=function(b){b.siblings().removeClass("selected");b.addClass("selected")},g=function(b,c,f,g,q,h,v,y,C){f*=e;b.width(f+"px");c.width(e+"px");g.width(f+"px");q.width(f+"px");
h.width(f+"px");y.css("right","20px");C.css("left","20px")};b.fn.parallaxSlider.defaults={auto:0,speed:1E3,easing:"jswing",easingBg:"jswing",circular:!0,thumbRotation:!0}})(jQuery);$(document).ready(function(){$("#search-box").keyup(function(b){if(38==b.keyCode)$("#search_suggestion_holder").is(":visible")&&($(".selected").is(":visible")?(b=$("#search_suggestion_holder li").index($("#search_suggestion_holder li.selected")),$("#search_suggestion_holder li.selected").removeClass("selected"),b--,$("#search_suggestion_holder li:eq("+b+")").addClass("selected")):$("#search_suggestion_holder li").last().addClass("selected"));else if(40==b.keyCode)$("#search_suggestion_holder").is(":visible")&&
($(".selected").is(":visible")?(b=$("#search_suggestion_holder li").index($("#search_suggestion_holder li.selected")),$("#search_suggestion_holder li.selected").removeClass("selected"),b++,$("#search_suggestion_holder li:eq("+b+")").addClass("selected")):$("#search_suggestion_holder li").first().addClass("selected"));else if(13==b.keyCode)$(".selected").is(":visible")&&(b=$(".selected").text(),$("#search-box").val(b),$("#search_suggestion_holder").hide());else{var e=$(this).val();$("#search-close").hide();
$("#loader").show();setTimeout(function(){$.ajax({url:"php/search.php",data:"keyword="+e,success:function(b){$("#search_suggestion_holder").html(b);$("#search_suggestion_holder").show();$("#loader").hide();$("#search-close").show()}})},400)}});$("#search_suggestion_holder").on("click","li",function(){$("#search_suggestion_holder").hide()})});var engine3D=window.engine3D||{},engine2D=window.engine2D||{},scene3D,scene3DCube,scene3DPanorama,scene2D,canvas2D,scene2DAdvanced,physics3D,dpr,renderer,rendererCube,rendererPanorama,rendererQuad=[4],camera3DQuad=[4],camera3DQuadGrid,scene3DRoofContainer,scene3DHouseContainer,_scene3DHouseGroundContainer,scene3DHouseGroundContainer,scene3DHouseFXContainer,scene3DFloorGroundContainer,scene3DPanoramaContainer,scene3DCutawayPlaneMesh,scene3DLevelGroundContainer,scene3DLevelWallContainer,scene3DFloorFurnitureContainer=
[],scene3DFloorMeasurementsContainer=[],scene3DFloorWallContainer=[],scene3DFloorDoorContainer=[],scene3DFloorWindowContainer=[],scene3DFloorShapeContainer=[],scene3DFloorShapeTextures=[],scene3DCeilingShapeContainer=[],scene3DCeilingShapeTextures=[],scene2DFloorShape=[],scene2DFloorDraftPlanImage=[],scene3DPivotPoint,scene3DCubeMesh,sceneAmbientLight,sceneDirectionalLight,sceneSpotLight,controls3D,camera3D,camera3DPositionCache,camera3DPivotCache,camera3DCube,camera3DPanorama,groundGrid,groundMesh,
skyMesh,skyFloorMesh,weatherSkyGeometry,weatherSkyMaterial,weatherSkyCloudsMesh,weatherSkyRainbowMesh,SESSION="",RADIAN=Math.PI/180,SCENE="house",SCENEFILE="scene1.zip",TOOL3D="view",TOOL3DINTERACTIVE="",TOOL3DLANDSCAPE="rotate",TOOL3DFLOOR="measure",TOOL2D="vector",WEATHER="sunny",DAY="day",FLOOR=1,REALSIZERATIO=1,SelectedObject=null,SelectedNote=null,SelectedPicture=null,SelectedWall=null,leftButtonDown=!1,rightButtonDown=!1,clickTime,clickMenuTime,doubleClickTime,zoom2Dimg,zoom2Dheight=80,zoom2Dwidth=
241,zoom2DCTX=null,zoom2DSlider=null,zoom2D=1,scene2DDrawLineGeometry=[],scene2DDrawLine,scene2DWallMesh=[],scene2DWallGroup=[],scene2DWallPointGroup=[],scene2DWindowGroup=[],scene2DDoorGroup=[],scene2DLabelGroup=[],scene2DFloorMesh=[],scene2DDoorMesh=[],scene2DWindowMesh=[],scene2DInteriorMesh=[],scene2DExteriorMesh=[],scene2DWallDimentions=[],scene3DWallInteriorTextureDefault,scene3DWallExteriorTextureDefault,scene3DWallInteriorTextures=[],scene3DWallExteriorTextures=[],scene2DWallRegularMaterial,
scene2DWallRegularMaterialSelect,scene2DWallBearingMaterial,scene2DWallBearingMaterialSelect,physics3DContainer,animation=[],scene3DAnimateRotate=!1,requestAnimationID,spinner=document.createElement("div"),settings={sunlight:!1,clouds:!0,rainbow:!0,panorama_day:"2056",panorama_night:"2057",autorotate:!1},mouse,touch,target,clock,textureLoader,projector,vector,geometry,material,texture,mesh,terrain3D,terrain3DMaterial,fileReader,getScreenshotData=!1,FXAAPass,SSAOPass,effectComposer,depthMaterial,depthRenderTarget,
depthScale=1,FXAAProcessing={enabled:!0},SSAOProcessing={enabled:!1,renderMode:0};engine3D.showCube=!1;engine3D.fontLoader;
